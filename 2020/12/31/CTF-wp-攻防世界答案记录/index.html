<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>CTF答案记录 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="攻防世界 misc初级this is flag提交flag{th1s_!s_a_d4m0_4la9}即可 pdf做法1：pdf转word后看到答案 在线转换地址https:&#x2F;&#x2F;app.xunjiepdf.com&#x2F;pdf2word&#x2F; 做法2：chrome打开pdf，直接ctrl+f搜索flag give_you_flag正常打开gif，发现最后有一个二维码 用ps打开gif，找到那一帧，找到对应二维">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF答案记录">
<meta property="og:url" content="http://example.com/2020/12/31/CTF-wp-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E7%AD%94%E6%A1%88%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="攻防世界 misc初级this is flag提交flag{th1s_!s_a_d4m0_4la9}即可 pdf做法1：pdf转word后看到答案 在线转换地址https:&#x2F;&#x2F;app.xunjiepdf.com&#x2F;pdf2word&#x2F; 做法2：chrome打开pdf，直接ctrl+f搜索flag give_you_flag正常打开gif，发现最后有一个二维码 用ps打开gif，找到那一帧，找到对应二维">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-12-31T06:40:57.000Z">
<meta property="article:modified_time" content="2021-03-01T00:39:39.055Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-CTF-wp-攻防世界答案记录" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/31/CTF-wp-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E7%AD%94%E6%A1%88%E8%AE%B0%E5%BD%95/" class="article-date">
  <time class="dt-published" datetime="2020-12-31T06:40:57.000Z" itemprop="datePublished">2020-12-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      CTF答案记录
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="攻防世界-misc初级"><a href="#攻防世界-misc初级" class="headerlink" title="攻防世界 misc初级"></a>攻防世界 misc初级</h1><h2 id="this-is-flag"><a href="#this-is-flag" class="headerlink" title="this is flag"></a>this is flag</h2><p>提交flag{th1s_!s_a_d4m0_4la9}即可</p>
<h2 id="pdf"><a href="#pdf" class="headerlink" title="pdf"></a>pdf</h2><p>做法1：pdf转word后看到答案</p>
<p>在线转换地址<a target="_blank" rel="noopener" href="https://app.xunjiepdf.com/pdf2word/">https://app.xunjiepdf.com/pdf2word/</a></p>
<p>做法2：chrome打开pdf，直接ctrl+f搜索flag</p>
<h2 id="give-you-flag"><a href="#give-you-flag" class="headerlink" title="give_you_flag"></a>give_you_flag</h2><p>正常打开gif，发现最后有一个二维码</p>
<p>用ps打开gif，找到那一帧，找到对应二维码</p>
<p>二维码需要四个角中三个角添加定位方块，用ps添加定位方块后，随便一个二维码扫描工具得到flag</p>
<h2 id="坚持60s"><a href="#坚持60s" class="headerlink" title="坚持60s"></a>坚持60s</h2><p>得到jar文件，可以用压缩包软件打开文件还原出工程</p>
<p>使用idea打开工程，在爆炸文件下得到明文flag{RGFqaURhbGlfSmlud2FuQ2hpamk=}</p>
<p>提交后显示flag错误，使用base64对flag中内容解码得到但</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;DajiDali_JinwanChiji&#125;</span><br></pre></td></tr></table></figure>
<h2 id="gif"><a href="#gif" class="headerlink" title="gif"></a>gif</h2><p>得到104张黑白图片</p>
<p>使用python读取文件，白为0黑为1，得到一个字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">white &#x3D; open(&quot;.&#x2F;0.jpg&quot;,&quot;rb&quot;).read()</span><br><span class="line">black &#x3D; open(&quot;.&#x2F;1.jpg&quot;,&quot;rb&quot;).read()</span><br><span class="line"></span><br><span class="line">flag_dic &#x3D; &quot;&quot;</span><br><span class="line">for i in range(104):</span><br><span class="line">	with open(&quot;.&#x2F;%d.jpg&quot;%i,&quot;rb&quot;) as f:</span><br><span class="line">		if f.read() &#x3D;&#x3D; white:</span><br><span class="line">			flag_dic +&#x3D; &quot;0&quot;</span><br><span class="line">		else:</span><br><span class="line">			flag_dic +&#x3D; &quot;1&quot;</span><br><span class="line">print(flag_dic)</span><br><span class="line"></span><br><span class="line">01100110011011000110000101100111011110110100011001110101010011100101111101100111011010010100011001111101</span><br></pre></td></tr></table></figure>
<p>使用在线的二进制转字符串工具得到答案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;FuN_giF&#125;</span><br></pre></td></tr></table></figure>
<h2 id="掀桌子"><a href="#掀桌子" class="headerlink" title="掀桌子"></a>掀桌子</h2><p>最大字符不超过f，判断为十六进制</p>
<p>将两个连续数字设为一个字节，代表一个符号。所有字节大于128，而ASCII码表均小于128，故均减去128</p>
<p>得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">str &#x3D; &quot;c8e9aca0c6f2e5f3e8c4efe7a1a0d4e8e5a0e6ece1e7a0e9f3baa0e8eafae3f9e4eafae2eae4e3eaebfaebe3f5e7e9f3e4e3e8eaf9eaf3e2e4e6f2&quot;</span><br><span class="line">count &#x3D; 0</span><br><span class="line">tempstr &#x3D; &quot;&quot;</span><br><span class="line">ans &#x3D; &quot;&quot;</span><br><span class="line">for s in str:</span><br><span class="line">	tempstr +&#x3D; s</span><br><span class="line">	if len(tempstr) &#x3D;&#x3D; 2:</span><br><span class="line">		ans +&#x3D; chr(int(tempstr, 16) - 128)</span><br><span class="line">		# print(int(tempstr, 16))</span><br><span class="line">		tempstr &#x3D; &quot;&quot;</span><br><span class="line">print(ans)</span><br><span class="line"></span><br><span class="line">Hi, FreshDog! The flag is: hjzcydjzbjdcjkzkcugisdchjyjsbdfr</span><br></pre></td></tr></table></figure>
<h2 id="如来十三掌"><a href="#如来十三掌" class="headerlink" title="如来十三掌"></a>如来十三掌</h2><p>使用与佛论禅论坛，<a target="_blank" rel="noopener" href="http://keyfc.net/bbs/tools/tudoucode.aspx%EF%BC%8C%E5%AF%B9%E6%96%87%E5%AD%97%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%AF%86%E5%BE%97%E5%88%B0">http://keyfc.net/bbs/tools/tudoucode.aspx，对文字进行解密得到</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MzkuM3gvMUAwnzuvn3cgozMlMTuvqzAenJchMUAeqzWenzEmLJW9</span><br></pre></td></tr></table></figure>
<p>根据题目提示，使用ROT13编码进行解密</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3tiZHNjamhia3ptbmZyZGhidmNraWpuZHNrdmJramRzYWJ9</span><br></pre></td></tr></table></figure>
<p>再使用base64进行编码，得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bdscjhbkzmnfrdhbvckijndskvbkjdsab&#125;</span><br></pre></td></tr></table></figure>
<h2 id="stegano"><a href="#stegano" class="headerlink" title="stegano"></a>stegano</h2><p>工具：福昕pdf编辑器</p>
<p>思路：从pdf文件中找到字符，再进行加解密</p>
<p>去除无用信息后，选中“编辑对象”，框选一大片区域，发现字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BABA BBB BA BBA ABA AB B AAB ABAA AB B AA BBB BA AAA BBAABB AABA ABAA AB BBA BBBAAA ABBBB BA AAAB ABBBB AAAAA ABBBB BAAA ABAA AAABB BB AAABB AAAAA AAAAA AAAAB BBA AAABB</span><br></pre></td></tr></table></figure>
<p>类似于培根密码，但培根密码为5位一组，不符合。此字符串中只有AB两种字符，类似于二进制，联想摩斯密码，解密后得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1nv151bl3m3554g3&#125;</span><br></pre></td></tr></table></figure>
<h3 id="培根密码"><a href="#培根密码" class="headerlink" title="培根密码"></a>培根密码</h3><p>采用a和b两种字符表示的字符串，5位字符一组</p>
<h3 id="摩斯密码"><a href="#摩斯密码" class="headerlink" title="摩斯密码"></a>摩斯密码</h3><h2 id="simpleRAR"><a href="#simpleRAR" class="headerlink" title="simpleRAR"></a>simpleRAR</h2><p>工具：winhex，stegsolve（图片隐写工具），photoshop</p>
<p>首先下载得到一个rar文件，打开后提示“secure.png”文件头损坏。</p>
<p>尝试使用winrar直接修复，结果是把secure.png直接删除。尝试失败。</p>
<p>上网查阅rar块构成后，将“Cflag is not here?”后十六进制的7A更改为74。成功解压得到secure.png</p>
<p>根据题目提示，将png放入photoshop中。photoshop提示非png文件。</p>
<p>使用winhex打开secure.png，头部标识</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">474946</span><br></pre></td></tr></table></figure>
<p>表示这是一个gif文件。更改后缀名后放入photoshop中，得到两个图层。</p>
<p>分别将两个图层的空白图片放入stegsolve，得到二维码。放入photoshop合成二维码并补充三个角，扫码后得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;yanji4n_bu_we1shi&#125;</span><br></pre></td></tr></table></figure>
<h3 id="rar头部构成"><a href="#rar头部构成" class="headerlink" title="rar头部构成"></a>rar头部构成</h3><p>每个数据块结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HEAD_CRC：校验码，2字节</span><br><span class="line">HEAD_TYPE：块类型，1字节</span><br><span class="line">HEAD_FLAGS：块标记，2字节</span><br><span class="line">最后两字节：块大小</span><br></pre></td></tr></table></figure>
<p>整个RAR文件数据块构成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">标记块：HEAD_TYPE&#x3D;0x72</span><br><span class="line">压缩文件头：HEAD_TYPE&#x3D;0x74</span><br><span class="line">文件头：HEAD_TYPE&#x3D;0x74</span><br></pre></td></tr></table></figure>
<h2 id="base64stego"><a href="#base64stego" class="headerlink" title="base64stego"></a>base64stego</h2><p>工具：winhex</p>
<p>知识点：zip伪加密，base64隐写</p>
<p>首先要用winhex，修改zip的压缩源文件数据区全局加密处的字节</p>
<p>得到一个文件stego.txt。结合题目提示，对其进行base64解码，并未得到期望的结果。</p>
<p>查阅wp可知考察base64隐写。base64隐写不等于base64解码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import msvcrt</span><br><span class="line">import time</span><br><span class="line">b64chars &#x3D; &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&#39;</span><br><span class="line">with open(&#39;stego.txt&#39;, &#39;rb&#39;) as f:</span><br><span class="line">    bin_str &#x3D; &#39;&#39;</span><br><span class="line">    for line in f.readlines():</span><br><span class="line">        # 去除头尾的换行符</span><br><span class="line">        stegb64 &#x3D; str(line, &quot;utf-8&quot;).strip(&quot;\n&quot;)</span><br><span class="line">        # 基于base64解码又编码，达到去除隐写的符号的目的</span><br><span class="line">        row64 &#x3D; str(base64.b64encode(base64.b64decode(stegb64)),&quot;utf-8&quot;)</span><br><span class="line">        # 基于base64的隐写，都在最后一个字符上体现。因此算一下两个字符串最后一个字符的差值</span><br><span class="line">        offset &#x3D; abs(b64chars.index(stegb64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1]) - b64chars.index(row64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1]))</span><br><span class="line">        print(offset)</span><br><span class="line">        #print(stegb64.replace(&#39;&#x3D;&#39;,&#39;&#39;))</span><br><span class="line">        #print(stegb64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1])</span><br><span class="line">        #print(b64chars.index(stegb64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1]))</span><br><span class="line">        #print(b64chars.index(row64.replace(&#39;&#x3D;&#39;,&#39;&#39;)[-1]))</span><br><span class="line">        # 等号的数量*2等于最后返回字符串的长度</span><br><span class="line">        equalnum &#x3D; stegb64.count(&#39;&#x3D;&#39;)</span><br><span class="line">        if equalnum:</span><br><span class="line">            bin_str +&#x3D; bin(offset)[2:].zfill(equalnum * 2)</span><br><span class="line">        print(bin(offset))</span><br><span class="line">        print(bin(offset)[2:])</span><br><span class="line">        # 右对齐后，在头部填充0</span><br><span class="line">        print(bin(offset)[2:].zfill(equalnum * 2))</span><br><span class="line">        # 8个bit转换为一个字符</span><br><span class="line">        print(&#39;&#39;.join([chr(int(bin_str[i:i+8],2)) for i in range(0, len(bin_str), 8)]))</span><br><span class="line">        # time.sleep(3)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="zip的伪加密"><a href="#zip的伪加密" class="headerlink" title="zip的伪加密"></a>zip的伪加密</h3><p>zip由三个部分组成：压缩源文件数据区+压缩源文件目录区+压缩源文件目录结束标志，根据三个区域的不同，区分zip是非加密、伪加密还是加密的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">压缩源文件数据区： </span><br><span class="line">50 4B 03 04：这是头文件标记（0x04034b50） </span><br><span class="line">14 00：解压文件所需 pkware 版本 </span><br><span class="line">00 00：全局方式位标记（有无加密） 头文件标记后2bytes</span><br><span class="line">08 00：压缩方式 </span><br><span class="line">5A 7E：最后修改文件时间 </span><br><span class="line">F7 46：最后修改文件日期 </span><br><span class="line">16 B5 80 14：CRC-32校验（1480B516） </span><br><span class="line">19 00 00 00：压缩后尺寸（25） </span><br><span class="line">17 00 00 00：未压缩尺寸（23） </span><br><span class="line">07 00：文件名长度 </span><br><span class="line">00 00：扩展记录长度 </span><br><span class="line">6B65792E7478740BCECC750E71ABCE48CDC9C95728CECC2DC849AD284DAD0500 </span><br><span class="line">压缩源文件目录区： </span><br><span class="line"></span><br><span class="line">50 4B 01 02：目录中文件文件头标记(0x02014b50) </span><br><span class="line"></span><br><span class="line">3F 00：压缩使用的 pkware 版本</span><br><span class="line"></span><br><span class="line">14 00：解压文件所需 pkware 版本 </span><br><span class="line">00 00：全局方式位标记（有无加密，伪加密的关键） 目录文件标记后4bytes</span><br><span class="line">08 00：压缩方式 </span><br><span class="line">5A 7E：最后修改文件时间 </span><br><span class="line">F7 46：最后修改文件日期 </span><br><span class="line">16 B5 80 14：CRC-32校验（1480B516） </span><br><span class="line">19 00 00 00：压缩后尺寸（25） </span><br><span class="line">17 00 00 00：未压缩尺寸（23） </span><br><span class="line">07 00：文件名长度 </span><br><span class="line">24 00：扩展字段长度 </span><br><span class="line">00 00：文件注释长度 </span><br><span class="line">00 00：磁盘开始号 </span><br><span class="line">00 00：内部文件属性 </span><br><span class="line">20 00 00 00：外部文件属性 </span><br><span class="line"></span><br><span class="line">00 00 00 00：局部头部偏移量</span><br><span class="line"></span><br><span class="line">6B65792E7478740A00200000000000010018006558F04A1CC5D001BDEBDD3B1CC5D001BDEBDD3B1CC5D001 </span><br><span class="line">压缩源文件目录结束标志： </span><br><span class="line">50 4B 05 06：目录结束标记 </span><br><span class="line">00 00：当前磁盘编号 </span><br><span class="line">00 00：目录区开始磁盘编号 </span><br><span class="line">01 00：本磁盘上纪录总数 </span><br><span class="line">01 00：目录区中纪录总数 </span><br><span class="line">59 00 00 00：目录区尺寸大小 </span><br><span class="line"></span><br><span class="line">3E 00 00 00：目录区对第一张磁盘的偏移量</span><br><span class="line"></span><br><span class="line">00 00：ZIP 文件注释长度</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">无加密</span><br><span class="line">压缩源文件数据区的全局加密应当为00 00  （504B0304两个bytes之后）</span><br><span class="line">且压缩源文件目录区的全局方式位标记应当为00 00（504B0304四个bytes之后）</span><br><span class="line"></span><br><span class="line">假加密</span><br><span class="line">压缩源文件数据区的全局加密应当为00 00 </span><br><span class="line">且压缩源文件目录区的全局方式位标记应当为09 00</span><br><span class="line"></span><br><span class="line">真加密</span><br><span class="line">压缩源文件数据区的全局加密应当为09 00 </span><br><span class="line">且压缩源文件目录区的全局方式位标记应当为09 00 </span><br></pre></td></tr></table></figure>
<h3 id="base64编码"><a href="#base64编码" class="headerlink" title="base64编码"></a>base64编码</h3><p>原本一个字符使用8bit表示，使用base64编码后改为用6bit表示，不能除尽的部分补0</p>
<h3 id="base64解码"><a href="#base64解码" class="headerlink" title="base64解码"></a>base64解码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">检查base64编码后面有几个等于号</span><br><span class="line">把字符串按照base64表转换成4*6的倍数位数二进制</span><br><span class="line">删除等于号的个数*8的bit</span><br><span class="line">按照6个bit一组转成字符</span><br></pre></td></tr></table></figure>
<h3 id="base64隐写"><a href="#base64隐写" class="headerlink" title="base64隐写"></a>base64隐写</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">基于base64解码时尾部存在一定数量的bit不会被转义的情况，可以在此处植入想要隐写的字符</span><br></pre></td></tr></table></figure>
<h2 id="ext3"><a href="#ext3" class="headerlink" title="ext3"></a>ext3</h2><p>这题没看题解自己做的，感动哭了</p>
<p>首先根据提示，这是一个linux系统光盘文件。放入centos中，使用file命令查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">file f1fc23f5c743425d9e0073887c846d23</span><br><span class="line"></span><br><span class="line">Linux rev 1.0 ext3 filesystem data, UUID&#x3D;cf6d7bff-c377-403f-84ae-956ce3c99aaa (needs journal recovery)</span><br></pre></td></tr></table></figure>
<p>网上查阅如何使用ext3文件系统数据，使用mount命令挂载。注意要在root用户权限下使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mount -o loop f1fc23f5c743425d9e0073887c846d23 &#x2F;mnt</span><br><span class="line"># -o loop提供了一个虚拟磁盘，&#x2F;mnt是挂载的目录</span><br></pre></td></tr></table></figure>
<p>进入/mnt，随便搜搜flag相关字，发现在flag.txt</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;O7avZhikgKgbF&#x2F;flag.txt</span><br></pre></td></tr></table></figure>
<p>查看flag.txt中的内容，根据字符串其后的等号判断为base64。解码后得到答案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;sajbcibzskjjcnbhsbvcjbjszcszbkzj&#125;</span><br></pre></td></tr></table></figure>
<p>网上还有一种用winhex的做法</p>
<h2 id="功夫再高也怕菜刀"><a href="#功夫再高也怕菜刀" class="headerlink" title="功夫再高也怕菜刀"></a>功夫再高也怕菜刀</h2><p>工具：kali的foremost，winhex，wireshark</p>
<p>双击pcapng文件，通过搜索关键字“flag.txt”可知，传输了flag.txt文件</p>
<p>通过kali下的foremost分离出传输flag.txt的压缩包。</p>
<p>通过winhex，发现压缩包是真实加密的，无法通过更改十六进制字符直接获取flag.txt</p>
<p>再次打开pcapng文件，大量的分析tcp流，查找可能相关的的文件。发现6666.jpg文件，还原出6666.jpg文件。</p>
<p>jpg文件头是FFD8FF，文件尾是FFD9。将包含头尾的16进制字符串复制到winhex中，输出一个jpg文件。打开jpg文件，得到压缩包的解压密码</p>
<p>最后得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3OpWdJ-JP6FzK-koCMAK-VkfWBq-75Un2z&#125;</span><br></pre></td></tr></table></figure>
<h3 id="各类文件的标志头"><a href="#各类文件的标志头" class="headerlink" title="各类文件的标志头"></a>各类文件的标志头</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jpg：FFD8FF</span><br><span class="line">png：89504E47</span><br><span class="line">gif：47494638</span><br></pre></td></tr></table></figure>


<h1 id="攻防世界-web-初级"><a href="#攻防世界-web-初级" class="headerlink" title="攻防世界 web 初级"></a>攻防世界 web 初级</h1><h2 id="view-souce"><a href="#view-souce" class="headerlink" title="view_souce"></a>view_souce</h2><p>按F12，看到注释源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;ffd40408d5b1b8c2dad9aab623dd93ef&#125;</span><br></pre></td></tr></table></figure>
<h2 id="robots"><a href="#robots" class="headerlink" title="robots"></a>robots</h2><p>先用御剑或者dirsearch扫描一下给出的网站</p>
<p>得到目录下存在robots.txt文件</p>
<p>访问该文件，网页展示内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: </span><br><span class="line">Disallow: f1ag_1s_h3re.php</span><br></pre></td></tr></table></figure>
<p>访问f1ag_1s_h3re.php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;57752958f46d76651078942ee34b88ba&#125;</span><br></pre></td></tr></table></figure>
<h2 id="backup"><a href="#backup" class="headerlink" title="backup"></a>backup</h2><p>同理，用御剑扫一下后台，存在index.php.bak文件</p>
<p>访问这个文件，自动下载文件</p>
<p>使用sublime text打开文件，得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cyberpeace&#123;855A1C4B3401294CB6604CCC98BDE334&#125;</span><br></pre></td></tr></table></figure>
<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p>所需工具：firefox</p>
<p>可选工具：burp，wireshark</p>
<p>先打开网页，根据题目提示，在firefox按F12查看cookie</p>
<p>根据提示访问cookie.php</p>
<p>根据提示查看http response，得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;5c1980e2f03a088816f306f7680d5458&#125;</span><br></pre></td></tr></table></figure>
<h2 id="disabled-button"><a href="#disabled-button" class="headerlink" title="disabled_button"></a>disabled_button</h2><p>工具：firefox</p>
<p>打开网页，显示按钮不能按</p>
<p>使用firefox，按F12检查网页源码，把button处的disabled去掉，即可提交</p>
<p>提交后得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;a8efb264c88f7cba483ed431888a1d32&#125;</span><br></pre></td></tr></table></figure>
<h2 id="weak-auth"><a href="#weak-auth" class="headerlink" title="weak_auth"></a>weak_auth</h2><p>目的：爆破弱密码</p>
<p>工具：burp</p>
<p>proxy拦截提交的请求，将请求send to intruder，在intruder的position中更改数据包，使得提交的指定字段为变量，在intruder的payload中载入字典，点击attack</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;4b4dda09ed661c8976f965b0681de325&#125;</span><br></pre></td></tr></table></figure>
<h2 id="command-execution"><a href="#command-execution" class="headerlink" title="command execution"></a>command execution</h2><p>输入localhost，看到请求为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target:&quot;127.0.0.1&quot;</span><br></pre></td></tr></table></figure>
<p>尝试注入语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; select database(); #</span><br></pre></td></tr></table></figure>
<p>得到请求为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target:&quot;+select+database();+#</span><br></pre></td></tr></table></figure>
<p>说明不能注入</p>
<p>参考writeup，直接在命令行执行的ping，可以执行其他语句。又flag一般放在txt中，输入下列语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1 &amp;&amp; find &#x2F; -name &quot;*.txt&quot; | grep flag</span><br></pre></td></tr></table></figure>
<p>看到/home/flag.txt</p>
<p>查看文件内容得到flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;168a646a5815f5b2f0e42e56812943d5&#125;</span><br></pre></td></tr></table></figure>
<h2 id="simple-php"><a href="#simple-php" class="headerlink" title="simple_php"></a>simple_php</h2><p>需要知识点：php的弱类型比较</p>
<p>需要工具：直接在浏览器提交就行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">写法1：?a&#x3D;&#39;0&#39;&amp;b&#x3D;1235a # 使a为字符串，b为非数字的一种变量</span><br><span class="line">写法2：?a&#x3D;0a&amp;b&#x3D;12345%00 # %00表示阶段，可以使b不为数字或数字字符串</span><br></pre></td></tr></table></figure>


<h3 id="php的弱类型比较"><a href="#php的弱类型比较" class="headerlink" title="php的弱类型比较"></a>php的弱类型比较</h3><p>php有两种判断相等的方法，==，===</p>
<p>==会将两边值进行强制类型转换后在判断</p>
<p>===同时判断类型和值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if(&quot;admin&quot;&#x3D;&#x3D;0) &#x2F;&#x2F;true</span><br><span class="line">if(&quot;1admin&quot;&#x3D;&#x3D;1)&#x2F;&#x2F;true</span><br><span class="line">if(&quot;admin1&quot;&#x3D;&#x3D;1)&#x2F;&#x2F;false</span><br><span class="line">if(&quot;0e12324&quot;&#x3D;&#x3D;&quot;0e1324&quot;)&#x2F;&#x2F;true，当做科学技术法，都是0</span><br></pre></td></tr></table></figure>
<p>get_post</p>
<p>工具：firefox的hackbar插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;f5206ff77800e22928b4d81206e083e5&#125;</span><br></pre></td></tr></table></figure>
<h3 id="xff-referer"><a href="#xff-referer" class="headerlink" title="xff_referer"></a>xff_referer</h3><p>工具：burpsuite</p>
<p>在burp的proxy里，把包拦下来，按照提示加入这两条就行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: 123.123.123.123</span><br><span class="line">Referer: https:&#x2F;&#x2F;www.google.com</span><br></pre></td></tr></table></figure>
<p>得到答案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;2db9b3a38c581792bea6f015e6bdfdc8&#125;</span><br></pre></td></tr></table></figure>
<h3 id="XFF和Referer"><a href="#XFF和Referer" class="headerlink" title="XFF和Referer"></a>XFF和Referer</h3><p>X-Forwarded-For：浏览器访问服务器时，使用的IP</p>
<p>Referer：浏览器告诉服务器，自己从哪个IP跳转来的</p>
<p>web_shell</p>
<p>考察：php一句话木马，php执行shell命令</p>
<p>工具：中国蚁剑，中国菜刀，hackbar</p>
<p>做法1：中国蚁剑or中国菜刀</p>
<p>菜刀可以绕过认证部分，直接拿到webshell权限，之后查找flag即可</p>
<p>做法2：hackbar</p>
<p>在post data中写入 以下语句</p>
<p>首先查找当前目录文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&#x3D;system(&quot;ls&quot;)</span><br></pre></td></tr></table></figure>
<p>写入以下任意一句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shell&#x3D;passthru(&quot;cat flag.txt&quot;);</span><br><span class="line">shell&#x3D;system(&quot;cat flag.txt&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="php执行shell命令"><a href="#php执行shell命令" class="headerlink" title="php执行shell命令"></a>php执行shell命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string system ( string $command [, int &amp;$return_var ] )</span><br><span class="line">string exec ( string $command [, array &amp;$output [, int &amp;$return_var ]] )</span><br><span class="line">void passthru ( string $command [, int &amp;$return_var ] )</span><br></pre></td></tr></table></figure>
<h3 id="simple-js"><a href="#simple-js" class="headerlink" title="simple_js"></a>simple_js</h3><p>考察：js阅读，转码</p>
<p>阅读js源码，发现dechiffre不管输入什么，都会根据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">70,65,85,88,32,80,65,83,83,87,79,82,68,32,72,65,72,65</span><br></pre></td></tr></table></figure>
<p>返回一个值。ASCII码范围为0~127，猜测这几个值为字符的ASCII码表示</p>
<p>代码里有一段十六进制的长字符串，猜测为答案</p>
<p>先把长字符串转换为十进制，再转换为字符，得到答案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cyberpeace&#123;786OsErtk12&#125;</span><br></pre></td></tr></table></figure>


<h1 id="攻防世界-crypto初级"><a href="#攻防世界-crypto初级" class="headerlink" title="攻防世界 crypto初级"></a>攻防世界 crypto初级</h1><h2 id="Caesar"><a href="#Caesar" class="headerlink" title="Caesar"></a>Caesar</h2><p>考察：凯撒密码</p>
<p>根据题目提示，将得到字符串进行凯撒密码的解密即可</p>
<p>提供的字符串为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oknqdbqmoq&#123;kag_tmhq_xqmdzqp_omqemd_qzodkbfuaz&#125;</span><br></pre></td></tr></table></figure>
<p>oknqdbqmoq部分解密后应该就是cyberspace，利用这一点算出加解密时需要的步数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;you_have_learned_caesar_encryption&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Morse"><a href="#Morse" class="headerlink" title="Morse"></a>Morse</h2><p>考察：摩斯密码</p>
<p>根据题目提示，将01字符串转换为摩斯密码。其中1为-，0为.，空格为/</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&#x2F;---&#x2F;.-.&#x2F;...&#x2F;.&#x2F;-.-.&#x2F;---&#x2F;-..&#x2F;.&#x2F;..&#x2F;...&#x2F;...&#x2F;---&#x2F;..&#x2F;-.&#x2F;-&#x2F;.&#x2F;.-.&#x2F;.&#x2F;...&#x2F;-&#x2F;..&#x2F;-.&#x2F;--.</span><br></pre></td></tr></table></figure>
<p>使用在线转换器得到答案。注意若答案为大写，需要转换为小写后提交。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;morsecodeissointeresting&#125;</span><br></pre></td></tr></table></figure>
<h2 id="幂数加密"><a href="#幂数加密" class="headerlink" title="幂数加密"></a>幂数加密</h2><p>考察：云影密码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;WELLDOWN&#125;</span><br></pre></td></tr></table></figure>
<h3 id="云影密码"><a href="#云影密码" class="headerlink" title="云影密码"></a>云影密码</h3><p>只有84210五种数字的字符串，以0位分隔符，数字相加后转换为对应的大写英文字母。如8421=15=O</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ccehgyaefnpeoobe&#123;lcirg&#125;epriec_ora_g</span><br></pre></td></tr></table></figure>
<h2 id="Railfence"><a href="#Railfence" class="headerlink" title="Railfence"></a>Railfence</h2><p>考察：Railfence-cipher</p>
<p>根据题目提示，可能是栅栏密码。尝试后并未得出有效答案</p>
<p>根据wp，为一种变形的栅栏密码Railfence-ciper</p>
<p>代码写起来挺啰嗦的，找一个在线的解码器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ccehgyaefnpeoobe&#123;lcirg&#125;epriec_ora_g</span><br><span class="line">cyberpeace&#123;railfence_cipher_gogogo&#125;</span><br></pre></td></tr></table></figure>
<h2 id="不仅仅是Morse"><a href="#不仅仅是Morse" class="headerlink" title="不仅仅是Morse"></a>不仅仅是Morse</h2><p>考察：Morse，培根密码</p>
<p>打开附件，得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--&#x2F;.-&#x2F;-.--&#x2F;..--.-&#x2F;-...&#x2F;.&#x2F;..--.-&#x2F;....&#x2F;.-&#x2F;...-&#x2F;.&#x2F;..--.-&#x2F;.-&#x2F;-.&#x2F;---&#x2F;-&#x2F;....&#x2F;.&#x2F;.-.&#x2F;..--.-&#x2F;-..&#x2F;.&#x2F;-.-.&#x2F;---&#x2F;-..&#x2F;.&#x2F;....&#x2F;....&#x2F;....&#x2F;....&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-&#x2F;-...&#x2F;.-&#x2F;.-&#x2F;-...&#x2F;-...&#x2F;.-</span><br></pre></td></tr></table></figure>
<p>使用在线摩根密码<a target="_blank" rel="noopener" href="http://moersima.00cha.net/%E8%A7%A3%E5%AF%86%E5%90%8E%EF%BC%8C%E5%BE%97%E5%88%B0">http://moersima.00cha.net/解密后，得到</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">may be have another decodehhhhaaaaabaabbbaabbaaaaaaaabaababaaaaaaabbabaaabbaaabbaabaaaababaabaaabbabaaabaaabaababbaabbbabaaabababbaaabbabaaabaabaabaaaabbabbaabbaabaabaaabaabaabaababaabbabaaaabbabaabba</span><br></pre></td></tr></table></figure>
<p>abab的可能为培根密码，<a target="_blank" rel="noopener" href="http://rumkin.com/tools/cipher/baconian.php">http://rumkin.com/tools/cipher/baconian.php</a></p>
<p>解密后得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ATTACKANDDEFENCEWORLDISINTERESTING</span><br></pre></td></tr></table></figure>
<p>根据题目提示修改相应格式后提交flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cyberpeace&#123;attackanddefenceworldisinteresting&#125;</span><br></pre></td></tr></table></figure>
<h2 id="混合编码"><a href="#混合编码" class="headerlink" title="混合编码"></a>混合编码</h2><p>考察：ASCII码，base64编码</p>
<p><strong>第一步</strong></p>
<p>打开文件，发现以==结尾，为base64编码，解码后得到字符串</p>
<p><strong>第二步</strong></p>
<p>没小于128的，猜测是ASCII码，写个python转换一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str &#x3D; &quot;76;&amp;#122;&amp;#69;&amp;#120;&amp;#79;&amp;#83;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#69;&amp;#118;&amp;#77;&amp;#84;&amp;#65;&amp;#52;&amp;#76;&amp;#122;&amp;#107;&amp;#53;&amp;#76;&amp;#122;&amp;#69;&amp;#120;&amp;#77;&amp;#83;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#107;&amp;#118;&amp;#77;&amp;#84;&amp;#65;&amp;#120;&amp;#76;&amp;#122;&amp;#69;&amp;#120;&amp;#78;&amp;#105;&amp;#56;&amp;#120;&amp;#77;&amp;#84;&amp;#69;&amp;#118;&amp;#79;&amp;#84;&amp;#99;&amp;#118;&amp;#77;&amp;#84;&amp;#69;&amp;#50;&amp;#76;&amp;#122;&amp;#69;&amp;#120;&amp;#78;&amp;#105;&amp;#56;&amp;#53;&amp;#78;&amp;#121;&amp;#56;&amp;#53;&amp;#79;&amp;#83;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#99;&amp;#118;&amp;#79;&amp;#84;&amp;#99;&amp;#118;&amp;#77;&amp;#84;&amp;#69;&amp;#119;&amp;#76;&amp;#122;&amp;#69;&amp;#119;&amp;#77;&amp;#67;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#65;&amp;#118;&amp;#77;&amp;#84;&amp;#65;&amp;#120;&amp;#76;&amp;#122;&amp;#69;&amp;#119;&amp;#77;&amp;#105;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#69;&amp;#118;&amp;#77;&amp;#84;&amp;#69;&amp;#119;&amp;#76;&amp;#122;&amp;#107;&amp;#53;&amp;#76;&amp;#122;&amp;#69;&amp;#119;&amp;#77;&amp;#83;&amp;#56;&amp;#120;&amp;#77;&amp;#84;&amp;#107;&amp;#118;&amp;#77;&amp;#84;&amp;#69;&amp;#120;&amp;#76;&amp;#122;&amp;#69;&amp;#120;&amp;#78;&amp;#67;&amp;#56;&amp;#120;&amp;#77;&amp;#68;&amp;#103;&amp;#118;&amp;#77;&amp;#84;&amp;#65;&amp;#119&quot;</span><br><span class="line">str &#x3D; str.split(&quot;;&amp;#&quot;);</span><br><span class="line">text &#x3D; &quot;&quot;</span><br><span class="line">for s in str:</span><br><span class="line">	text +&#x3D; chr(int(s))</span><br><span class="line">print(text)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LzExOS8xMDEvMTA4Lzk5LzExMS8xMDkvMTAxLzExNi8xMTEvOTcvMTE2LzExNi85Ny85OS8xMDcvOTcvMTEwLzEwMC8xMDAvMTAxLzEwMi8xMDEvMTEwLzk5LzEwMS8xMTkvMTExLzExNC8xMDgvMTAw</span><br></pre></td></tr></table></figure>
<p><strong>第三步</strong></p>
<p>将其进行base64解码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">119&#x2F;101&#x2F;108&#x2F;99&#x2F;111&#x2F;109&#x2F;101&#x2F;116&#x2F;111&#x2F;97&#x2F;116&#x2F;116&#x2F;97&#x2F;99&#x2F;107&#x2F;97&#x2F;110&#x2F;100&#x2F;100&#x2F;101&#x2F;102&#x2F;101&#x2F;110&#x2F;99&#x2F;101&#x2F;119&#x2F;111&#x2F;114&#x2F;108&#x2F;100</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>最后一步</strong></p>
<p>将其转换为ascill码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">welcometoattackanddefenceworld</span><br></pre></td></tr></table></figure>
<p>添加格式，即为flag</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/31/CTF-wp-%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E7%AD%94%E6%A1%88%E8%AE%B0%E5%BD%95/" data-id="ckkdrz0z70007ugus60u76cr9" data-title="CTF答案记录" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/01/12/hello-world/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Hello World
        
      </div>
    </a>
  
  
    <a href="/2020/12/23/%E5%9F%BA%E7%A1%80%E8%AF%BE-%E7%B2%BE%E9%80%9A%E9%BB%91%E5%AE%A2%E8%84%9A%E6%9C%AC%E7%AC%94%E8%AE%B0/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">精通黑客脚本笔记</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/" rel="tag">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dev/" rel="tag">dev</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80%E8%AF%BE/" rel="tag">基础课</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%91%98%E6%8A%84/" rel="tag">摘抄</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E5%AD%A6/" rel="tag">文学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%80%83%E8%AF%81/" rel="tag">考证</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%84%E5%88%92/" rel="tag">规划</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E5%AD%A6%E4%B9%A0/" rel="tag">论文学习</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ctf/" style="font-size: 20px;">ctf</a> <a href="/tags/dev/" style="font-size: 15px;">dev</a> <a href="/tags/wp/" style="font-size: 10px;">wp</a> <a href="/tags/%E5%9F%BA%E7%A1%80%E8%AF%BE/" style="font-size: 17.5px;">基础课</a> <a href="/tags/%E6%91%98%E6%8A%84/" style="font-size: 12.5px;">摘抄</a> <a href="/tags/%E6%96%87%E5%AD%A6/" style="font-size: 10px;">文学</a> <a href="/tags/%E8%80%83%E8%AF%81/" style="font-size: 10px;">考证</a> <a href="/tags/%E8%A7%84%E5%88%92/" style="font-size: 12.5px;">规划</a> <a href="/tags/%E8%AE%BA%E6%96%87%E5%AD%A6%E4%B9%A0/" style="font-size: 17.5px;">论文学习</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/30/%E6%91%98%E6%8A%84-Foundations-of-Cryptography/">摘抄-Foundations of Cryptography</a>
          </li>
        
          <li>
            <a href="/2021/03/30/%E6%91%98%E6%8A%84-%E8%BD%AC%E5%9E%8B%E4%B8%AD%E7%9A%84%E5%9C%B0%E6%96%B9%E6%94%BF%E5%BA%9C/">摘抄-转型中的地方政府</a>
          </li>
        
          <li>
            <a href="/2021/03/26/%E8%A7%84%E5%88%92-21%E5%B9%B4/">规划-21年</a>
          </li>
        
          <li>
            <a href="/2021/03/26/%E8%A7%84%E5%88%92-21-26%E5%B9%B4/">规划-21-26年</a>
          </li>
        
          <li>
            <a href="/2021/03/24/%E5%9F%BA%E7%A1%80%E8%AF%BE-%E6%B8%85%E5%8D%8EOS/">基础课-清华OS</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>